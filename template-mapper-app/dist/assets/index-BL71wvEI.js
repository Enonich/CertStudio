var hd=p=>{throw TypeError(p)};var ec=(p,t,e)=>t.has(p)||hd("Cannot "+e);var Sn=(p,t,e)=>(ec(p,t,"read from private field"),e?e.call(p):t.get(p)),Ls=(p,t,e)=>t.has(p)?hd("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(p):t.set(p,e),xr=(p,t,e,s)=>(ec(p,t,"write to private field"),s?s.call(p,e):t.set(p,e),e),Za=(p,t,e)=>(ec(p,t,"access private method"),e);var dd=(p,t,e,s)=>({set _(r){xr(p,t,r,e)},get _(){return Sn(p,t,s)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function e(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=e(r);fetch(r.href,o)}})();function $d(p){return p&&p.__esModule&&Object.prototype.hasOwnProperty.call(p,"default")?p.default:p}var nc={exports:{}},Er={},ic={exports:{}},Dt={};var fd;function Qp(){if(fd)return Dt;fd=1;var p=Symbol.for("react.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),v=Symbol.iterator;function y(M){return M===null||typeof M!="object"?null:(M=v&&M[v]||M["@@iterator"],typeof M=="function"?M:null)}var A={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,S={};function T(M,z,J){this.props=M,this.context=z,this.refs=S,this.updater=J||A}T.prototype.isReactComponent={},T.prototype.setState=function(M,z){if(typeof M!="object"&&typeof M!="function"&&M!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,M,z,"setState")},T.prototype.forceUpdate=function(M){this.updater.enqueueForceUpdate(this,M,"forceUpdate")};function C(){}C.prototype=T.prototype;function I(M,z,J){this.props=M,this.context=z,this.refs=S,this.updater=J||A}var O=I.prototype=new C;O.constructor=I,b(O,T.prototype),O.isPureReactComponent=!0;var j=Array.isArray,H=Object.prototype.hasOwnProperty,W={current:null},V={key:!0,ref:!0,__self:!0,__source:!0};function it(M,z,J){var vt,xt={},pt=null,dt=null;if(z!=null)for(vt in z.ref!==void 0&&(dt=z.ref),z.key!==void 0&&(pt=""+z.key),z)H.call(z,vt)&&!V.hasOwnProperty(vt)&&(xt[vt]=z[vt]);var Et=arguments.length-2;if(Et===1)xt.children=J;else if(1<Et){for(var Tt=Array(Et),fe=0;fe<Et;fe++)Tt[fe]=arguments[fe+2];xt.children=Tt}if(M&&M.defaultProps)for(vt in Et=M.defaultProps,Et)xt[vt]===void 0&&(xt[vt]=Et[vt]);return{$$typeof:p,type:M,key:pt,ref:dt,props:xt,_owner:W.current}}function X(M,z){return{$$typeof:p,type:M.type,key:z,ref:M.ref,props:M.props,_owner:M._owner}}function Ct(M){return typeof M=="object"&&M!==null&&M.$$typeof===p}function ft(M){var z={"=":"=0",":":"=2"};return"$"+M.replace(/[=:]/g,function(J){return z[J]})}var Nt=/\/+/g;function Mt(M,z){return typeof M=="object"&&M!==null&&M.key!=null?ft(""+M.key):z.toString(36)}function Lt(M,z,J,vt,xt){var pt=typeof M;(pt==="undefined"||pt==="boolean")&&(M=null);var dt=!1;if(M===null)dt=!0;else switch(pt){case"string":case"number":dt=!0;break;case"object":switch(M.$$typeof){case p:case t:dt=!0}}if(dt)return dt=M,xt=xt(dt),M=vt===""?"."+Mt(dt,0):vt,j(xt)?(J="",M!=null&&(J=M.replace(Nt,"$&/")+"/"),Lt(xt,z,J,"",function(fe){return fe})):xt!=null&&(Ct(xt)&&(xt=X(xt,J+(!xt.key||dt&&dt.key===xt.key?"":(""+xt.key).replace(Nt,"$&/")+"/")+M)),z.push(xt)),1;if(dt=0,vt=vt===""?".":vt+":",j(M))for(var Et=0;Et<M.length;Et++){pt=M[Et];var Tt=vt+Mt(pt,Et);dt+=Lt(pt,z,J,Tt,xt)}else if(Tt=y(M),typeof Tt=="function")for(M=Tt.call(M),Et=0;!(pt=M.next()).done;)pt=pt.value,Tt=vt+Mt(pt,Et++),dt+=Lt(pt,z,J,Tt,xt);else if(pt==="object")throw z=String(M),Error("Objects are not valid as a React child (found: "+(z==="[object Object]"?"object with keys {"+Object.keys(M).join(", ")+"}":z)+"). If you meant to render a collection of children, use an array instead.");return dt}function Ut(M,z,J){if(M==null)return M;var vt=[],xt=0;return Lt(M,vt,"","",function(pt){return z.call(J,pt,xt++)}),vt}function Z(M){if(M._status===-1){var z=M._result;z=z(),z.then(function(J){(M._status===0||M._status===-1)&&(M._status=1,M._result=J)},function(J){(M._status===0||M._status===-1)&&(M._status=2,M._result=J)}),M._status===-1&&(M._status=0,M._result=z)}if(M._status===1)return M._result.default;throw M._result}var q={current:null},Y={transition:null},nt={ReactCurrentDispatcher:q,ReactCurrentBatchConfig:Y,ReactCurrentOwner:W};function Q(){throw Error("act(...) is not supported in production builds of React.")}return Dt.Children={map:Ut,forEach:function(M,z,J){Ut(M,function(){z.apply(this,arguments)},J)},count:function(M){var z=0;return Ut(M,function(){z++}),z},toArray:function(M){return Ut(M,function(z){return z})||[]},only:function(M){if(!Ct(M))throw Error("React.Children.only expected to receive a single React element child.");return M}},Dt.Component=T,Dt.Fragment=e,Dt.Profiler=r,Dt.PureComponent=I,Dt.StrictMode=s,Dt.Suspense=h,Dt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=nt,Dt.act=Q,Dt.cloneElement=function(M,z,J){if(M==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+M+".");var vt=b({},M.props),xt=M.key,pt=M.ref,dt=M._owner;if(z!=null){if(z.ref!==void 0&&(pt=z.ref,dt=W.current),z.key!==void 0&&(xt=""+z.key),M.type&&M.type.defaultProps)var Et=M.type.defaultProps;for(Tt in z)H.call(z,Tt)&&!V.hasOwnProperty(Tt)&&(vt[Tt]=z[Tt]===void 0&&Et!==void 0?Et[Tt]:z[Tt])}var Tt=arguments.length-2;if(Tt===1)vt.children=J;else if(1<Tt){Et=Array(Tt);for(var fe=0;fe<Tt;fe++)Et[fe]=arguments[fe+2];vt.children=Et}return{$$typeof:p,type:M.type,key:xt,ref:pt,props:vt,_owner:dt}},Dt.createContext=function(M){return M={$$typeof:l,_currentValue:M,_currentValue2:M,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},M.Provider={$$typeof:o,_context:M},M.Consumer=M},Dt.createElement=it,Dt.createFactory=function(M){var z=it.bind(null,M);return z.type=M,z},Dt.createRef=function(){return{current:null}},Dt.forwardRef=function(M){return{$$typeof:c,render:M}},Dt.isValidElement=Ct,Dt.lazy=function(M){return{$$typeof:g,_payload:{_status:-1,_result:M},_init:Z}},Dt.memo=function(M,z){return{$$typeof:f,type:M,compare:z===void 0?null:z}},Dt.startTransition=function(M){var z=Y.transition;Y.transition={};try{M()}finally{Y.transition=z}},Dt.unstable_act=Q,Dt.useCallback=function(M,z){return q.current.useCallback(M,z)},Dt.useContext=function(M){return q.current.useContext(M)},Dt.useDebugValue=function(){},Dt.useDeferredValue=function(M){return q.current.useDeferredValue(M)},Dt.useEffect=function(M,z){return q.current.useEffect(M,z)},Dt.useId=function(){return q.current.useId()},Dt.useImperativeHandle=function(M,z,J){return q.current.useImperativeHandle(M,z,J)},Dt.useInsertionEffect=function(M,z){return q.current.useInsertionEffect(M,z)},Dt.useLayoutEffect=function(M,z){return q.current.useLayoutEffect(M,z)},Dt.useMemo=function(M,z){return q.current.useMemo(M,z)},Dt.useReducer=function(M,z,J){return q.current.useReducer(M,z,J)},Dt.useRef=function(M){return q.current.useRef(M)},Dt.useState=function(M){return q.current.useState(M)},Dt.useSyncExternalStore=function(M,z,J){return q.current.useSyncExternalStore(M,z,J)},Dt.useTransition=function(){return q.current.useTransition()},Dt.version="18.3.1",Dt}var pd;function Cc(){return pd||(pd=1,ic.exports=Qp()),ic.exports}var gd;function Zp(){if(gd)return Er;gd=1;var p=Cc(),t=Symbol.for("react.element"),e=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,r=p.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function l(c,h,f){var g,v={},y=null,A=null;f!==void 0&&(y=""+f),h.key!==void 0&&(y=""+h.key),h.ref!==void 0&&(A=h.ref);for(g in h)s.call(h,g)&&!o.hasOwnProperty(g)&&(v[g]=h[g]);if(c&&c.defaultProps)for(g in h=c.defaultProps,h)v[g]===void 0&&(v[g]=h[g]);return{$$typeof:t,type:c,key:y,ref:A,props:v,_owner:r.current}}return Er.Fragment=e,Er.jsx=l,Er.jsxs=l,Er}var md;function Jp(){return md||(md=1,nc.exports=Zp()),nc.exports}var E=Jp(),St=Cc();const tg=$d(St);var Ja={},sc={exports:{}},qe={},rc={exports:{}},ac={};var vd;function eg(){return vd||(vd=1,(function(p){function t(Y,nt){var Q=Y.length;Y.push(nt);t:for(;0<Q;){var M=Q-1>>>1,z=Y[M];if(0<r(z,nt))Y[M]=nt,Y[Q]=z,Q=M;else break t}}function e(Y){return Y.length===0?null:Y[0]}function s(Y){if(Y.length===0)return null;var nt=Y[0],Q=Y.pop();if(Q!==nt){Y[0]=Q;t:for(var M=0,z=Y.length,J=z>>>1;M<J;){var vt=2*(M+1)-1,xt=Y[vt],pt=vt+1,dt=Y[pt];if(0>r(xt,Q))pt<z&&0>r(dt,xt)?(Y[M]=dt,Y[pt]=Q,M=pt):(Y[M]=xt,Y[vt]=Q,M=vt);else if(pt<z&&0>r(dt,Q))Y[M]=dt,Y[pt]=Q,M=pt;else break t}}return nt}function r(Y,nt){var Q=Y.sortIndex-nt.sortIndex;return Q!==0?Q:Y.id-nt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;p.unstable_now=function(){return o.now()}}else{var l=Date,c=l.now();p.unstable_now=function(){return l.now()-c}}var h=[],f=[],g=1,v=null,y=3,A=!1,b=!1,S=!1,T=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function O(Y){for(var nt=e(f);nt!==null;){if(nt.callback===null)s(f);else if(nt.startTime<=Y)s(f),nt.sortIndex=nt.expirationTime,t(h,nt);else break;nt=e(f)}}function j(Y){if(S=!1,O(Y),!b)if(e(h)!==null)b=!0,Z(H);else{var nt=e(f);nt!==null&&q(j,nt.startTime-Y)}}function H(Y,nt){b=!1,S&&(S=!1,C(it),it=-1),A=!0;var Q=y;try{for(O(nt),v=e(h);v!==null&&(!(v.expirationTime>nt)||Y&&!ft());){var M=v.callback;if(typeof M=="function"){v.callback=null,y=v.priorityLevel;var z=M(v.expirationTime<=nt);nt=p.unstable_now(),typeof z=="function"?v.callback=z:v===e(h)&&s(h),O(nt)}else s(h);v=e(h)}if(v!==null)var J=!0;else{var vt=e(f);vt!==null&&q(j,vt.startTime-nt),J=!1}return J}finally{v=null,y=Q,A=!1}}var W=!1,V=null,it=-1,X=5,Ct=-1;function ft(){return!(p.unstable_now()-Ct<X)}function Nt(){if(V!==null){var Y=p.unstable_now();Ct=Y;var nt=!0;try{nt=V(!0,Y)}finally{nt?Mt():(W=!1,V=null)}}else W=!1}var Mt;if(typeof I=="function")Mt=function(){I(Nt)};else if(typeof MessageChannel<"u"){var Lt=new MessageChannel,Ut=Lt.port2;Lt.port1.onmessage=Nt,Mt=function(){Ut.postMessage(null)}}else Mt=function(){T(Nt,0)};function Z(Y){V=Y,W||(W=!0,Mt())}function q(Y,nt){it=T(function(){Y(p.unstable_now())},nt)}p.unstable_IdlePriority=5,p.unstable_ImmediatePriority=1,p.unstable_LowPriority=4,p.unstable_NormalPriority=3,p.unstable_Profiling=null,p.unstable_UserBlockingPriority=2,p.unstable_cancelCallback=function(Y){Y.callback=null},p.unstable_continueExecution=function(){b||A||(b=!0,Z(H))},p.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):X=0<Y?Math.floor(1e3/Y):5},p.unstable_getCurrentPriorityLevel=function(){return y},p.unstable_getFirstCallbackNode=function(){return e(h)},p.unstable_next=function(Y){switch(y){case 1:case 2:case 3:var nt=3;break;default:nt=y}var Q=y;y=nt;try{return Y()}finally{y=Q}},p.unstable_pauseExecution=function(){},p.unstable_requestPaint=function(){},p.unstable_runWithPriority=function(Y,nt){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var Q=y;y=Y;try{return nt()}finally{y=Q}},p.unstable_scheduleCallback=function(Y,nt,Q){var M=p.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?M+Q:M):Q=M,Y){case 1:var z=-1;break;case 2:z=250;break;case 5:z=1073741823;break;case 4:z=1e4;break;default:z=5e3}return z=Q+z,Y={id:g++,callback:nt,priorityLevel:Y,startTime:Q,expirationTime:z,sortIndex:-1},Q>M?(Y.sortIndex=Q,t(f,Y),e(h)===null&&Y===e(f)&&(S?(C(it),it=-1):S=!0,q(j,Q-M))):(Y.sortIndex=z,t(h,Y),b||A||(b=!0,Z(H))),Y},p.unstable_shouldYield=ft,p.unstable_wrapCallback=function(Y){var nt=y;return function(){var Q=y;y=nt;try{return Y.apply(this,arguments)}finally{y=Q}}}})(ac)),ac}var yd;function ng(){return yd||(yd=1,rc.exports=eg()),rc.exports}var wd;function ig(){if(wd)return qe;wd=1;var p=Cc(),t=ng();function e(n){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+n,a=1;a<arguments.length;a++)i+="&args[]="+encodeURIComponent(arguments[a]);return"Minified React error #"+n+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,r={};function o(n,i){l(n,i),l(n+"Capture",i)}function l(n,i){for(r[n]=i,n=0;n<i.length;n++)s.add(i[n])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),h=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,g={},v={};function y(n){return h.call(v,n)?!0:h.call(g,n)?!1:f.test(n)?v[n]=!0:(g[n]=!0,!1)}function A(n,i,a,u){if(a!==null&&a.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return u?!1:a!==null?!a.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function b(n,i,a,u){if(i===null||typeof i>"u"||A(n,i,a,u))return!0;if(u)return!1;if(a!==null)switch(a.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function S(n,i,a,u,d,m,w){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=u,this.attributeNamespace=d,this.mustUseProperty=a,this.propertyName=n,this.type=i,this.sanitizeURL=m,this.removeEmptyString=w}var T={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){T[n]=new S(n,0,!1,n,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var i=n[0];T[i]=new S(i,1,!1,n[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(n){T[n]=new S(n,2,!1,n.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){T[n]=new S(n,2,!1,n,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){T[n]=new S(n,3,!1,n.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(n){T[n]=new S(n,3,!0,n,null,!1,!1)}),["capture","download"].forEach(function(n){T[n]=new S(n,4,!1,n,null,!1,!1)}),["cols","rows","size","span"].forEach(function(n){T[n]=new S(n,6,!1,n,null,!1,!1)}),["rowSpan","start"].forEach(function(n){T[n]=new S(n,5,!1,n.toLowerCase(),null,!1,!1)});var C=/[\-:]([a-z])/g;function I(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var i=n.replace(C,I);T[i]=new S(i,1,!1,n,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var i=n.replace(C,I);T[i]=new S(i,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(n){var i=n.replace(C,I);T[i]=new S(i,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(n){T[n]=new S(n,1,!1,n.toLowerCase(),null,!1,!1)}),T.xlinkHref=new S("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(n){T[n]=new S(n,1,!1,n.toLowerCase(),null,!0,!0)});function O(n,i,a,u){var d=T.hasOwnProperty(i)?T[i]:null;(d!==null?d.type!==0:u||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(b(i,a,d,u)&&(a=null),u||d===null?y(i)&&(a===null?n.removeAttribute(i):n.setAttribute(i,""+a)):d.mustUseProperty?n[d.propertyName]=a===null?d.type===3?!1:"":a:(i=d.attributeName,u=d.attributeNamespace,a===null?n.removeAttribute(i):(d=d.type,a=d===3||d===4&&a===!0?"":""+a,u?n.setAttributeNS(u,i,a):n.setAttribute(i,a))))}var j=p.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,H=Symbol.for("react.element"),W=Symbol.for("react.portal"),V=Symbol.for("react.fragment"),it=Symbol.for("react.strict_mode"),X=Symbol.for("react.profiler"),Ct=Symbol.for("react.provider"),ft=Symbol.for("react.context"),Nt=Symbol.for("react.forward_ref"),Mt=Symbol.for("react.suspense"),Lt=Symbol.for("react.suspense_list"),Ut=Symbol.for("react.memo"),Z=Symbol.for("react.lazy"),q=Symbol.for("react.offscreen"),Y=Symbol.iterator;function nt(n){return n===null||typeof n!="object"?null:(n=Y&&n[Y]||n["@@iterator"],typeof n=="function"?n:null)}var Q=Object.assign,M;function z(n){if(M===void 0)try{throw Error()}catch(a){var i=a.stack.trim().match(/\n( *(at )?)/);M=i&&i[1]||""}return`
`+M+n}var J=!1;function vt(n,i){if(!n||J)return"";J=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(F){var u=F}Reflect.construct(n,[],i)}else{try{i.call()}catch(F){u=F}n.call(i.prototype)}else{try{throw Error()}catch(F){u=F}n()}}catch(F){if(F&&u&&typeof F.stack=="string"){for(var d=F.stack.split(`
`),m=u.stack.split(`
`),w=d.length-1,x=m.length-1;1<=w&&0<=x&&d[w]!==m[x];)x--;for(;1<=w&&0<=x;w--,x--)if(d[w]!==m[x]){if(w!==1||x!==1)do if(w--,x--,0>x||d[w]!==m[x]){var P=`
`+d[w].replace(" at new "," at ");return n.displayName&&P.includes("<anonymous>")&&(P=P.replace("<anonymous>",n.displayName)),P}while(1<=w&&0<=x);break}}}finally{J=!1,Error.prepareStackTrace=a}return(n=n?n.displayName||n.name:"")?z(n):""}function xt(n){switch(n.tag){case 5:return z(n.type);case 16:return z("Lazy");case 13:return z("Suspense");case 19:return z("SuspenseList");case 0:case 2:case 15:return n=vt(n.type,!1),n;case 11:return n=vt(n.type.render,!1),n;case 1:return n=vt(n.type,!0),n;default:return""}}function pt(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case V:return"Fragment";case W:return"Portal";case X:return"Profiler";case it:return"StrictMode";case Mt:return"Suspense";case Lt:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case ft:return(n.displayName||"Context")+".Consumer";case Ct:return(n._context.displayName||"Context")+".Provider";case Nt:var i=n.render;return n=n.displayName,n||(n=i.displayName||i.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case Ut:return i=n.displayName||null,i!==null?i:pt(n.type)||"Memo";case Z:i=n._payload,n=n._init;try{return pt(n(i))}catch{}}return null}function dt(n){var i=n.type;switch(n.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=i.render,n=n.displayName||n.name||"",i.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return pt(i);case 8:return i===it?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function Et(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Tt(n){var i=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function fe(n){var i=Tt(n)?"checked":"value",a=Object.getOwnPropertyDescriptor(n.constructor.prototype,i),u=""+n[i];if(!n.hasOwnProperty(i)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var d=a.get,m=a.set;return Object.defineProperty(n,i,{configurable:!0,get:function(){return d.call(this)},set:function(w){u=""+w,m.call(this,w)}}),Object.defineProperty(n,i,{enumerable:a.enumerable}),{getValue:function(){return u},setValue:function(w){u=""+w},stopTracking:function(){n._valueTracker=null,delete n[i]}}}}function Yt(n){n._valueTracker||(n._valueTracker=fe(n))}function Ze(n){if(!n)return!1;var i=n._valueTracker;if(!i)return!0;var a=i.getValue(),u="";return n&&(u=Tt(n)?n.checked?"true":"false":n.value),n=u,n!==a?(i.setValue(n),!0):!1}function Xt(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function xi(n,i){var a=i.checked;return Q({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:a??n._wrapperState.initialChecked})}function Hr(n,i){var a=i.defaultValue==null?"":i.defaultValue,u=i.checked!=null?i.checked:i.defaultChecked;a=Et(i.value!=null?i.value:a),n._wrapperState={initialChecked:u,initialValue:a,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function Hs(n,i){i=i.checked,i!=null&&O(n,"checked",i,!1)}function ts(n,i){Hs(n,i);var a=Et(i.value),u=i.type;if(a!=null)u==="number"?(a===0&&n.value===""||n.value!=a)&&(n.value=""+a):n.value!==""+a&&(n.value=""+a);else if(u==="submit"||u==="reset"){n.removeAttribute("value");return}i.hasOwnProperty("value")?Cn(n,i.type,a):i.hasOwnProperty("defaultValue")&&Cn(n,i.type,Et(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(n.defaultChecked=!!i.defaultChecked)}function jt(n,i,a){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var u=i.type;if(!(u!=="submit"&&u!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+n._wrapperState.initialValue,a||i===n.value||(n.value=i),n.defaultValue=i}a=n.name,a!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,a!==""&&(n.name=a)}function Cn(n,i,a){(i!=="number"||Xt(n.ownerDocument)!==n)&&(a==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+a&&(n.defaultValue=""+a))}var Ei=Array.isArray;function Ee(n,i,a,u){if(n=n.options,i){i={};for(var d=0;d<a.length;d++)i["$"+a[d]]=!0;for(a=0;a<n.length;a++)d=i.hasOwnProperty("$"+n[a].value),n[a].selected!==d&&(n[a].selected=d),d&&u&&(n[a].defaultSelected=!0)}else{for(a=""+Et(a),i=null,d=0;d<n.length;d++){if(n[d].value===a){n[d].selected=!0,u&&(n[d].defaultSelected=!0);return}i!==null||n[d].disabled||(i=n[d])}i!==null&&(i.selected=!0)}}function es(n,i){if(i.dangerouslySetInnerHTML!=null)throw Error(e(91));return Q({},i,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function Ci(n,i){var a=i.value;if(a==null){if(a=i.children,i=i.defaultValue,a!=null){if(i!=null)throw Error(e(92));if(Ei(a)){if(1<a.length)throw Error(e(93));a=a[0]}i=a}i==null&&(i=""),a=i}n._wrapperState={initialValue:Et(a)}}function ki(n,i){var a=Et(i.value),u=Et(i.defaultValue);a!=null&&(a=""+a,a!==n.value&&(n.value=a),i.defaultValue==null&&n.defaultValue!==a&&(n.defaultValue=a)),u!=null&&(n.defaultValue=""+u)}function Ti(n){var i=n.textContent;i===n._wrapperState.initialValue&&i!==""&&i!==null&&(n.value=i)}function Pi(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Yn(n,i){return n==null||n==="http://www.w3.org/1999/xhtml"?Pi(i):n==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var In,Ce=(function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,a,u,d){MSApp.execUnsafeLocalFunction(function(){return n(i,a,u,d)})}:n})(function(n,i){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=i;else{for(In=In||document.createElement("div"),In.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=In.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;i.firstChild;)n.appendChild(i.firstChild)}});function on(n,i){if(i){var a=n.firstChild;if(a&&a===n.lastChild&&a.nodeType===3){a.nodeValue=i;return}}n.textContent=i}var Ri={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},rt=["Webkit","ms","Moz","O"];Object.keys(Ri).forEach(function(n){rt.forEach(function(i){i=i+n.charAt(0).toUpperCase()+n.substring(1),Ri[i]=Ri[n]})});function ns(n,i,a){return i==null||typeof i=="boolean"||i===""?"":a||typeof i!="number"||i===0||Ri.hasOwnProperty(n)&&Ri[n]?(""+i).trim():i+"px"}function Br(n,i){n=n.style;for(var a in i)if(i.hasOwnProperty(a)){var u=a.indexOf("--")===0,d=ns(a,i[a],u);a==="float"&&(a="cssFloat"),u?n.setProperty(a,d):n[a]=d}}var bo=Q({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Bs(n,i){if(i){if(bo[n]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(e(137,n));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(e(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(e(61))}if(i.style!=null&&typeof i.style!="object")throw Error(e(62))}}function ln(n,i){if(n.indexOf("-")===-1)return typeof i.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Fn=null;function Mi(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Li=null,Kn=null,Qn=null;function le(n){if(n=cr(n)){if(typeof Li!="function")throw Error(e(280));var i=n.stateNode;i&&(i=fa(i),Li(n.stateNode,n.type,i))}}function is(n){Kn?Qn?Qn.push(n):Qn=[n]:Kn=n}function Us(){if(Kn){var n=Kn,i=Qn;if(Qn=Kn=null,le(n),i)for(n=0;n<i.length;n++)le(i[n])}}function Ur(n,i){return n(i)}function $s(){}var Vs=!1;function Zn(n,i,a){if(Vs)return n(i,a);Vs=!0;try{return Ur(n,i,a)}finally{Vs=!1,(Kn!==null||Qn!==null)&&($s(),Us())}}function Ni(n,i){var a=n.stateNode;if(a===null)return null;var u=fa(a);if(u===null)return null;a=u[i];t:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(n=n.type,u=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!u;break t;default:n=!1}if(n)return null;if(a&&typeof a!="function")throw Error(e(231,i,typeof a));return a}var Gs=!1;if(c)try{var Ue={};Object.defineProperty(Ue,"passive",{get:function(){Gs=!0}}),window.addEventListener("test",Ue,Ue),window.removeEventListener("test",Ue,Ue)}catch{Gs=!1}function ss(n,i,a,u,d,m,w,x,P){var F=Array.prototype.slice.call(arguments,3);try{i.apply(a,F)}catch($){this.onError($)}}var Dn=!1,Ii=null,On=!1,rs=null,$r={onError:function(n){Dn=!0,Ii=n}};function _o(n,i,a,u,d,m,w,x,P){Dn=!1,Ii=null,ss.apply($r,arguments)}function Vr(n,i,a,u,d,m,w,x,P){if(_o.apply(this,arguments),Dn){if(Dn){var F=Ii;Dn=!1,Ii=null}else throw Error(e(198));On||(On=!0,rs=F)}}function ce(n){var i=n,a=n;if(n.alternate)for(;i.return;)i=i.return;else{n=i;do i=n,(i.flags&4098)!==0&&(a=i.return),n=i.return;while(n)}return i.tag===3?a:null}function Gr(n){if(n.tag===13){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function Wr(n){if(ce(n)!==n)throw Error(e(188))}function So(n){var i=n.alternate;if(!i){if(i=ce(n),i===null)throw Error(e(188));return i!==n?null:n}for(var a=n,u=i;;){var d=a.return;if(d===null)break;var m=d.alternate;if(m===null){if(u=d.return,u!==null){a=u;continue}break}if(d.child===m.child){for(m=d.child;m;){if(m===a)return Wr(d),n;if(m===u)return Wr(d),i;m=m.sibling}throw Error(e(188))}if(a.return!==u.return)a=d,u=m;else{for(var w=!1,x=d.child;x;){if(x===a){w=!0,a=d,u=m;break}if(x===u){w=!0,u=d,a=m;break}x=x.sibling}if(!w){for(x=m.child;x;){if(x===a){w=!0,a=m,u=d;break}if(x===u){w=!0,u=m,a=d;break}x=x.sibling}if(!w)throw Error(e(189))}}if(a.alternate!==u)throw Error(e(190))}if(a.tag!==3)throw Error(e(188));return a.stateNode.current===a?n:i}function Xr(n){return n=So(n),n!==null?qr(n):null}function qr(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var i=qr(n);if(i!==null)return i;n=n.sibling}return null}var Yr=t.unstable_scheduleCallback,Kr=t.unstable_cancelCallback,xo=t.unstable_shouldYield,_=t.unstable_requestPaint,k=t.unstable_now,D=t.unstable_getCurrentPriorityLevel,B=t.unstable_ImmediatePriority,tt=t.unstable_UserBlockingPriority,kt=t.unstable_NormalPriority,te=t.unstable_LowPriority,It=t.unstable_IdlePriority,ct=null,yt=null;function Ht(n){if(yt&&typeof yt.onCommitFiberRoot=="function")try{yt.onCommitFiberRoot(ct,n,void 0,(n.current.flags&128)===128)}catch{}}var Vt=Math.clz32?Math.clz32:se,Ft=Math.log,Kt=Math.LN2;function se(n){return n>>>=0,n===0?32:31-(Ft(n)/Kt|0)|0}var Qt=64,be=4194304;function Je(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function jn(n,i){var a=n.pendingLanes;if(a===0)return 0;var u=0,d=n.suspendedLanes,m=n.pingedLanes,w=a&268435455;if(w!==0){var x=w&~d;x!==0?u=Je(x):(m&=w,m!==0&&(u=Je(m)))}else w=a&~d,w!==0?u=Je(w):m!==0&&(u=Je(m));if(u===0)return 0;if(i!==0&&i!==u&&(i&d)===0&&(d=u&-u,m=i&-i,d>=m||d===16&&(m&4194240)!==0))return i;if((u&4)!==0&&(u|=a&16),i=n.entangledLanes,i!==0)for(n=n.entanglements,i&=u;0<i;)a=31-Vt(i),d=1<<a,u|=n[a],i&=~d;return u}function as(n,i){switch(n){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function De(n,i){for(var a=n.suspendedLanes,u=n.pingedLanes,d=n.expirationTimes,m=n.pendingLanes;0<m;){var w=31-Vt(m),x=1<<w,P=d[w];P===-1?((x&a)===0||(x&u)!==0)&&(d[w]=as(x,i)):P<=i&&(n.expiredLanes|=x),m&=~x}}function os(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function Ws(){var n=Qt;return Qt<<=1,(Qt&4194240)===0&&(Qt=64),n}function ls(n){for(var i=[],a=0;31>a;a++)i.push(n);return i}function Jn(n,i,a){n.pendingLanes|=i,i!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,i=31-Vt(i),n[i]=a}function Qr(n,i){var a=n.pendingLanes&~i;n.pendingLanes=i,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=i,n.mutableReadLanes&=i,n.entangledLanes&=i,i=n.entanglements;var u=n.eventTimes;for(n=n.expirationTimes;0<a;){var d=31-Vt(a),m=1<<d;i[d]=0,u[d]=-1,n[d]=-1,a&=~m}}function cs(n,i){var a=n.entangledLanes|=i;for(n=n.entanglements;a;){var u=31-Vt(a),d=1<<u;d&i|n[u]&i&&(n[u]|=i),a&=~d}}var Gt=0;function $c(n){return n&=-n,1<n?4<n?(n&268435455)!==0?16:536870912:4:1}var Vc,Eo,Gc,Wc,Xc,Co=!1,Zr=[],ti=null,ei=null,ni=null,Xs=new Map,qs=new Map,ii=[],wf="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function qc(n,i){switch(n){case"focusin":case"focusout":ti=null;break;case"dragenter":case"dragleave":ei=null;break;case"mouseover":case"mouseout":ni=null;break;case"pointerover":case"pointerout":Xs.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":qs.delete(i.pointerId)}}function Ys(n,i,a,u,d,m){return n===null||n.nativeEvent!==m?(n={blockedOn:i,domEventName:a,eventSystemFlags:u,nativeEvent:m,targetContainers:[d]},i!==null&&(i=cr(i),i!==null&&Eo(i)),n):(n.eventSystemFlags|=u,i=n.targetContainers,d!==null&&i.indexOf(d)===-1&&i.push(d),n)}function Af(n,i,a,u,d){switch(i){case"focusin":return ti=Ys(ti,n,i,a,u,d),!0;case"dragenter":return ei=Ys(ei,n,i,a,u,d),!0;case"mouseover":return ni=Ys(ni,n,i,a,u,d),!0;case"pointerover":var m=d.pointerId;return Xs.set(m,Ys(Xs.get(m)||null,n,i,a,u,d)),!0;case"gotpointercapture":return m=d.pointerId,qs.set(m,Ys(qs.get(m)||null,n,i,a,u,d)),!0}return!1}function Yc(n){var i=Fi(n.target);if(i!==null){var a=ce(i);if(a!==null){if(i=a.tag,i===13){if(i=Gr(a),i!==null){n.blockedOn=i,Xc(n.priority,function(){Gc(a)});return}}else if(i===3&&a.stateNode.current.memoizedState.isDehydrated){n.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Jr(n){if(n.blockedOn!==null)return!1;for(var i=n.targetContainers;0<i.length;){var a=To(n.domEventName,n.eventSystemFlags,i[0],n.nativeEvent);if(a===null){a=n.nativeEvent;var u=new a.constructor(a.type,a);Fn=u,a.target.dispatchEvent(u),Fn=null}else return i=cr(a),i!==null&&Eo(i),n.blockedOn=a,!1;i.shift()}return!0}function Kc(n,i,a){Jr(n)&&a.delete(i)}function bf(){Co=!1,ti!==null&&Jr(ti)&&(ti=null),ei!==null&&Jr(ei)&&(ei=null),ni!==null&&Jr(ni)&&(ni=null),Xs.forEach(Kc),qs.forEach(Kc)}function Ks(n,i){n.blockedOn===i&&(n.blockedOn=null,Co||(Co=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,bf)))}function Qs(n){function i(d){return Ks(d,n)}if(0<Zr.length){Ks(Zr[0],n);for(var a=1;a<Zr.length;a++){var u=Zr[a];u.blockedOn===n&&(u.blockedOn=null)}}for(ti!==null&&Ks(ti,n),ei!==null&&Ks(ei,n),ni!==null&&Ks(ni,n),Xs.forEach(i),qs.forEach(i),a=0;a<ii.length;a++)u=ii[a],u.blockedOn===n&&(u.blockedOn=null);for(;0<ii.length&&(a=ii[0],a.blockedOn===null);)Yc(a),a.blockedOn===null&&ii.shift()}var us=j.ReactCurrentBatchConfig,ta=!0;function _f(n,i,a,u){var d=Gt,m=us.transition;us.transition=null;try{Gt=1,ko(n,i,a,u)}finally{Gt=d,us.transition=m}}function Sf(n,i,a,u){var d=Gt,m=us.transition;us.transition=null;try{Gt=4,ko(n,i,a,u)}finally{Gt=d,us.transition=m}}function ko(n,i,a,u){if(ta){var d=To(n,i,a,u);if(d===null)Go(n,i,u,ea,a),qc(n,u);else if(Af(d,n,i,a,u))u.stopPropagation();else if(qc(n,u),i&4&&-1<wf.indexOf(n)){for(;d!==null;){var m=cr(d);if(m!==null&&Vc(m),m=To(n,i,a,u),m===null&&Go(n,i,u,ea,a),m===d)break;d=m}d!==null&&u.stopPropagation()}else Go(n,i,u,null,a)}}var ea=null;function To(n,i,a,u){if(ea=null,n=Mi(u),n=Fi(n),n!==null)if(i=ce(n),i===null)n=null;else if(a=i.tag,a===13){if(n=Gr(i),n!==null)return n;n=null}else if(a===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;n=null}else i!==n&&(n=null);return ea=n,null}function Qc(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(D()){case B:return 1;case tt:return 4;case kt:case te:return 16;case It:return 536870912;default:return 16}default:return 16}}var si=null,Po=null,na=null;function Zc(){if(na)return na;var n,i=Po,a=i.length,u,d="value"in si?si.value:si.textContent,m=d.length;for(n=0;n<a&&i[n]===d[n];n++);var w=a-n;for(u=1;u<=w&&i[a-u]===d[m-u];u++);return na=d.slice(n,1<u?1-u:void 0)}function ia(n){var i=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&i===13&&(n=13)):n=i,n===10&&(n=13),32<=n||n===13?n:0}function sa(){return!0}function Jc(){return!1}function tn(n){function i(a,u,d,m,w){this._reactName=a,this._targetInst=d,this.type=u,this.nativeEvent=m,this.target=w,this.currentTarget=null;for(var x in n)n.hasOwnProperty(x)&&(a=n[x],this[x]=a?a(m):m[x]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?sa:Jc,this.isPropagationStopped=Jc,this}return Q(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=sa)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=sa)},persist:function(){},isPersistent:sa}),i}var hs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ro=tn(hs),Zs=Q({},hs,{view:0,detail:0}),xf=tn(Zs),Mo,Lo,Js,ra=Q({},Zs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Io,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Js&&(Js&&n.type==="mousemove"?(Mo=n.screenX-Js.screenX,Lo=n.screenY-Js.screenY):Lo=Mo=0,Js=n),Mo)},movementY:function(n){return"movementY"in n?n.movementY:Lo}}),tu=tn(ra),Ef=Q({},ra,{dataTransfer:0}),Cf=tn(Ef),kf=Q({},Zs,{relatedTarget:0}),No=tn(kf),Tf=Q({},hs,{animationName:0,elapsedTime:0,pseudoElement:0}),Pf=tn(Tf),Rf=Q({},hs,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Mf=tn(Rf),Lf=Q({},hs,{data:0}),eu=tn(Lf),Nf={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},If={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ff={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Df(n){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(n):(n=Ff[n])?!!i[n]:!1}function Io(){return Df}var Of=Q({},Zs,{key:function(n){if(n.key){var i=Nf[n.key]||n.key;if(i!=="Unidentified")return i}return n.type==="keypress"?(n=ia(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?If[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Io,charCode:function(n){return n.type==="keypress"?ia(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?ia(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),jf=tn(Of),zf=Q({},ra,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),nu=tn(zf),Hf=Q({},Zs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Io}),Bf=tn(Hf),Uf=Q({},hs,{propertyName:0,elapsedTime:0,pseudoElement:0}),$f=tn(Uf),Vf=Q({},ra,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Gf=tn(Vf),Wf=[9,13,27,32],Fo=c&&"CompositionEvent"in window,tr=null;c&&"documentMode"in document&&(tr=document.documentMode);var Xf=c&&"TextEvent"in window&&!tr,iu=c&&(!Fo||tr&&8<tr&&11>=tr),su=" ",ru=!1;function au(n,i){switch(n){case"keyup":return Wf.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ou(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var ds=!1;function qf(n,i){switch(n){case"compositionend":return ou(i);case"keypress":return i.which!==32?null:(ru=!0,su);case"textInput":return n=i.data,n===su&&ru?null:n;default:return null}}function Yf(n,i){if(ds)return n==="compositionend"||!Fo&&au(n,i)?(n=Zc(),na=Po=si=null,ds=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return iu&&i.locale!=="ko"?null:i.data;default:return null}}var Kf={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function lu(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i==="input"?!!Kf[n.type]:i==="textarea"}function cu(n,i,a,u){is(u),i=ua(i,"onChange"),0<i.length&&(a=new Ro("onChange","change",null,a,u),n.push({event:a,listeners:i}))}var er=null,nr=null;function Qf(n){ku(n,0)}function aa(n){var i=vs(n);if(Ze(i))return n}function Zf(n,i){if(n==="change")return i}var uu=!1;if(c){var Do;if(c){var Oo="oninput"in document;if(!Oo){var hu=document.createElement("div");hu.setAttribute("oninput","return;"),Oo=typeof hu.oninput=="function"}Do=Oo}else Do=!1;uu=Do&&(!document.documentMode||9<document.documentMode)}function du(){er&&(er.detachEvent("onpropertychange",fu),nr=er=null)}function fu(n){if(n.propertyName==="value"&&aa(nr)){var i=[];cu(i,nr,n,Mi(n)),Zn(Qf,i)}}function Jf(n,i,a){n==="focusin"?(du(),er=i,nr=a,er.attachEvent("onpropertychange",fu)):n==="focusout"&&du()}function tp(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return aa(nr)}function ep(n,i){if(n==="click")return aa(i)}function np(n,i){if(n==="input"||n==="change")return aa(i)}function ip(n,i){return n===i&&(n!==0||1/n===1/i)||n!==n&&i!==i}var vn=typeof Object.is=="function"?Object.is:ip;function ir(n,i){if(vn(n,i))return!0;if(typeof n!="object"||n===null||typeof i!="object"||i===null)return!1;var a=Object.keys(n),u=Object.keys(i);if(a.length!==u.length)return!1;for(u=0;u<a.length;u++){var d=a[u];if(!h.call(i,d)||!vn(n[d],i[d]))return!1}return!0}function pu(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function gu(n,i){var a=pu(n);n=0;for(var u;a;){if(a.nodeType===3){if(u=n+a.textContent.length,n<=i&&u>=i)return{node:a,offset:i-n};n=u}t:{for(;a;){if(a.nextSibling){a=a.nextSibling;break t}a=a.parentNode}a=void 0}a=pu(a)}}function mu(n,i){return n&&i?n===i?!0:n&&n.nodeType===3?!1:i&&i.nodeType===3?mu(n,i.parentNode):"contains"in n?n.contains(i):n.compareDocumentPosition?!!(n.compareDocumentPosition(i)&16):!1:!1}function vu(){for(var n=window,i=Xt();i instanceof n.HTMLIFrameElement;){try{var a=typeof i.contentWindow.location.href=="string"}catch{a=!1}if(a)n=i.contentWindow;else break;i=Xt(n.document)}return i}function jo(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i&&(i==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||i==="textarea"||n.contentEditable==="true")}function sp(n){var i=vu(),a=n.focusedElem,u=n.selectionRange;if(i!==a&&a&&a.ownerDocument&&mu(a.ownerDocument.documentElement,a)){if(u!==null&&jo(a)){if(i=u.start,n=u.end,n===void 0&&(n=i),"selectionStart"in a)a.selectionStart=i,a.selectionEnd=Math.min(n,a.value.length);else if(n=(i=a.ownerDocument||document)&&i.defaultView||window,n.getSelection){n=n.getSelection();var d=a.textContent.length,m=Math.min(u.start,d);u=u.end===void 0?m:Math.min(u.end,d),!n.extend&&m>u&&(d=u,u=m,m=d),d=gu(a,m);var w=gu(a,u);d&&w&&(n.rangeCount!==1||n.anchorNode!==d.node||n.anchorOffset!==d.offset||n.focusNode!==w.node||n.focusOffset!==w.offset)&&(i=i.createRange(),i.setStart(d.node,d.offset),n.removeAllRanges(),m>u?(n.addRange(i),n.extend(w.node,w.offset)):(i.setEnd(w.node,w.offset),n.addRange(i)))}}for(i=[],n=a;n=n.parentNode;)n.nodeType===1&&i.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof a.focus=="function"&&a.focus(),a=0;a<i.length;a++)n=i[a],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var rp=c&&"documentMode"in document&&11>=document.documentMode,fs=null,zo=null,sr=null,Ho=!1;function yu(n,i,a){var u=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;Ho||fs==null||fs!==Xt(u)||(u=fs,"selectionStart"in u&&jo(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),sr&&ir(sr,u)||(sr=u,u=ua(zo,"onSelect"),0<u.length&&(i=new Ro("onSelect","select",null,i,a),n.push({event:i,listeners:u}),i.target=fs)))}function oa(n,i){var a={};return a[n.toLowerCase()]=i.toLowerCase(),a["Webkit"+n]="webkit"+i,a["Moz"+n]="moz"+i,a}var ps={animationend:oa("Animation","AnimationEnd"),animationiteration:oa("Animation","AnimationIteration"),animationstart:oa("Animation","AnimationStart"),transitionend:oa("Transition","TransitionEnd")},Bo={},wu={};c&&(wu=document.createElement("div").style,"AnimationEvent"in window||(delete ps.animationend.animation,delete ps.animationiteration.animation,delete ps.animationstart.animation),"TransitionEvent"in window||delete ps.transitionend.transition);function la(n){if(Bo[n])return Bo[n];if(!ps[n])return n;var i=ps[n],a;for(a in i)if(i.hasOwnProperty(a)&&a in wu)return Bo[n]=i[a];return n}var Au=la("animationend"),bu=la("animationiteration"),_u=la("animationstart"),Su=la("transitionend"),xu=new Map,Eu="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ri(n,i){xu.set(n,i),o(i,[n])}for(var Uo=0;Uo<Eu.length;Uo++){var $o=Eu[Uo],ap=$o.toLowerCase(),op=$o[0].toUpperCase()+$o.slice(1);ri(ap,"on"+op)}ri(Au,"onAnimationEnd"),ri(bu,"onAnimationIteration"),ri(_u,"onAnimationStart"),ri("dblclick","onDoubleClick"),ri("focusin","onFocus"),ri("focusout","onBlur"),ri(Su,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var rr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),lp=new Set("cancel close invalid load scroll toggle".split(" ").concat(rr));function Cu(n,i,a){var u=n.type||"unknown-event";n.currentTarget=a,Vr(u,i,void 0,n),n.currentTarget=null}function ku(n,i){i=(i&4)!==0;for(var a=0;a<n.length;a++){var u=n[a],d=u.event;u=u.listeners;t:{var m=void 0;if(i)for(var w=u.length-1;0<=w;w--){var x=u[w],P=x.instance,F=x.currentTarget;if(x=x.listener,P!==m&&d.isPropagationStopped())break t;Cu(d,x,F),m=P}else for(w=0;w<u.length;w++){if(x=u[w],P=x.instance,F=x.currentTarget,x=x.listener,P!==m&&d.isPropagationStopped())break t;Cu(d,x,F),m=P}}}if(On)throw n=rs,On=!1,rs=null,n}function Zt(n,i){var a=i[Qo];a===void 0&&(a=i[Qo]=new Set);var u=n+"__bubble";a.has(u)||(Tu(i,n,2,!1),a.add(u))}function Vo(n,i,a){var u=0;i&&(u|=4),Tu(a,n,u,i)}var ca="_reactListening"+Math.random().toString(36).slice(2);function ar(n){if(!n[ca]){n[ca]=!0,s.forEach(function(a){a!=="selectionchange"&&(lp.has(a)||Vo(a,!1,n),Vo(a,!0,n))});var i=n.nodeType===9?n:n.ownerDocument;i===null||i[ca]||(i[ca]=!0,Vo("selectionchange",!1,i))}}function Tu(n,i,a,u){switch(Qc(i)){case 1:var d=_f;break;case 4:d=Sf;break;default:d=ko}a=d.bind(null,i,a,n),d=void 0,!Gs||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(d=!0),u?d!==void 0?n.addEventListener(i,a,{capture:!0,passive:d}):n.addEventListener(i,a,!0):d!==void 0?n.addEventListener(i,a,{passive:d}):n.addEventListener(i,a,!1)}function Go(n,i,a,u,d){var m=u;if((i&1)===0&&(i&2)===0&&u!==null)t:for(;;){if(u===null)return;var w=u.tag;if(w===3||w===4){var x=u.stateNode.containerInfo;if(x===d||x.nodeType===8&&x.parentNode===d)break;if(w===4)for(w=u.return;w!==null;){var P=w.tag;if((P===3||P===4)&&(P=w.stateNode.containerInfo,P===d||P.nodeType===8&&P.parentNode===d))return;w=w.return}for(;x!==null;){if(w=Fi(x),w===null)return;if(P=w.tag,P===5||P===6){u=m=w;continue t}x=x.parentNode}}u=u.return}Zn(function(){var F=m,$=Mi(a),G=[];t:{var U=xu.get(n);if(U!==void 0){var et=Ro,ot=n;switch(n){case"keypress":if(ia(a)===0)break t;case"keydown":case"keyup":et=jf;break;case"focusin":ot="focus",et=No;break;case"focusout":ot="blur",et=No;break;case"beforeblur":case"afterblur":et=No;break;case"click":if(a.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":et=tu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":et=Cf;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":et=Bf;break;case Au:case bu:case _u:et=Pf;break;case Su:et=$f;break;case"scroll":et=xf;break;case"wheel":et=Gf;break;case"copy":case"cut":case"paste":et=Mf;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":et=nu}var lt=(i&4)!==0,ue=!lt&&n==="scroll",L=lt?U!==null?U+"Capture":null:U;lt=[];for(var R=F,N;R!==null;){N=R;var K=N.stateNode;if(N.tag===5&&K!==null&&(N=K,L!==null&&(K=Ni(R,L),K!=null&&lt.push(or(R,K,N)))),ue)break;R=R.return}0<lt.length&&(U=new et(U,ot,null,a,$),G.push({event:U,listeners:lt}))}}if((i&7)===0){t:{if(U=n==="mouseover"||n==="pointerover",et=n==="mouseout"||n==="pointerout",U&&a!==Fn&&(ot=a.relatedTarget||a.fromElement)&&(Fi(ot)||ot[zn]))break t;if((et||U)&&(U=$.window===$?$:(U=$.ownerDocument)?U.defaultView||U.parentWindow:window,et?(ot=a.relatedTarget||a.toElement,et=F,ot=ot?Fi(ot):null,ot!==null&&(ue=ce(ot),ot!==ue||ot.tag!==5&&ot.tag!==6)&&(ot=null)):(et=null,ot=F),et!==ot)){if(lt=tu,K="onMouseLeave",L="onMouseEnter",R="mouse",(n==="pointerout"||n==="pointerover")&&(lt=nu,K="onPointerLeave",L="onPointerEnter",R="pointer"),ue=et==null?U:vs(et),N=ot==null?U:vs(ot),U=new lt(K,R+"leave",et,a,$),U.target=ue,U.relatedTarget=N,K=null,Fi($)===F&&(lt=new lt(L,R+"enter",ot,a,$),lt.target=N,lt.relatedTarget=ue,K=lt),ue=K,et&&ot)e:{for(lt=et,L=ot,R=0,N=lt;N;N=gs(N))R++;for(N=0,K=L;K;K=gs(K))N++;for(;0<R-N;)lt=gs(lt),R--;for(;0<N-R;)L=gs(L),N--;for(;R--;){if(lt===L||L!==null&&lt===L.alternate)break e;lt=gs(lt),L=gs(L)}lt=null}else lt=null;et!==null&&Pu(G,U,et,lt,!1),ot!==null&&ue!==null&&Pu(G,ue,ot,lt,!0)}}t:{if(U=F?vs(F):window,et=U.nodeName&&U.nodeName.toLowerCase(),et==="select"||et==="input"&&U.type==="file")var ut=Zf;else if(lu(U))if(uu)ut=np;else{ut=tp;var gt=Jf}else(et=U.nodeName)&&et.toLowerCase()==="input"&&(U.type==="checkbox"||U.type==="radio")&&(ut=ep);if(ut&&(ut=ut(n,F))){cu(G,ut,a,$);break t}gt&&gt(n,U,F),n==="focusout"&&(gt=U._wrapperState)&&gt.controlled&&U.type==="number"&&Cn(U,"number",U.value)}switch(gt=F?vs(F):window,n){case"focusin":(lu(gt)||gt.contentEditable==="true")&&(fs=gt,zo=F,sr=null);break;case"focusout":sr=zo=fs=null;break;case"mousedown":Ho=!0;break;case"contextmenu":case"mouseup":case"dragend":Ho=!1,yu(G,a,$);break;case"selectionchange":if(rp)break;case"keydown":case"keyup":yu(G,a,$)}var mt;if(Fo)t:{switch(n){case"compositionstart":var bt="onCompositionStart";break t;case"compositionend":bt="onCompositionEnd";break t;case"compositionupdate":bt="onCompositionUpdate";break t}bt=void 0}else ds?au(n,a)&&(bt="onCompositionEnd"):n==="keydown"&&a.keyCode===229&&(bt="onCompositionStart");bt&&(iu&&a.locale!=="ko"&&(ds||bt!=="onCompositionStart"?bt==="onCompositionEnd"&&ds&&(mt=Zc()):(si=$,Po="value"in si?si.value:si.textContent,ds=!0)),gt=ua(F,bt),0<gt.length&&(bt=new eu(bt,n,null,a,$),G.push({event:bt,listeners:gt}),mt?bt.data=mt:(mt=ou(a),mt!==null&&(bt.data=mt)))),(mt=Xf?qf(n,a):Yf(n,a))&&(F=ua(F,"onBeforeInput"),0<F.length&&($=new eu("onBeforeInput","beforeinput",null,a,$),G.push({event:$,listeners:F}),$.data=mt))}ku(G,i)})}function or(n,i,a){return{instance:n,listener:i,currentTarget:a}}function ua(n,i){for(var a=i+"Capture",u=[];n!==null;){var d=n,m=d.stateNode;d.tag===5&&m!==null&&(d=m,m=Ni(n,a),m!=null&&u.unshift(or(n,m,d)),m=Ni(n,i),m!=null&&u.push(or(n,m,d))),n=n.return}return u}function gs(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function Pu(n,i,a,u,d){for(var m=i._reactName,w=[];a!==null&&a!==u;){var x=a,P=x.alternate,F=x.stateNode;if(P!==null&&P===u)break;x.tag===5&&F!==null&&(x=F,d?(P=Ni(a,m),P!=null&&w.unshift(or(a,P,x))):d||(P=Ni(a,m),P!=null&&w.push(or(a,P,x)))),a=a.return}w.length!==0&&n.push({event:i,listeners:w})}var cp=/\r\n?/g,up=/\u0000|\uFFFD/g;function Ru(n){return(typeof n=="string"?n:""+n).replace(cp,`
`).replace(up,"")}function ha(n,i,a){if(i=Ru(i),Ru(n)!==i&&a)throw Error(e(425))}function da(){}var Wo=null,Xo=null;function qo(n,i){return n==="textarea"||n==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Yo=typeof setTimeout=="function"?setTimeout:void 0,hp=typeof clearTimeout=="function"?clearTimeout:void 0,Mu=typeof Promise=="function"?Promise:void 0,dp=typeof queueMicrotask=="function"?queueMicrotask:typeof Mu<"u"?function(n){return Mu.resolve(null).then(n).catch(fp)}:Yo;function fp(n){setTimeout(function(){throw n})}function Ko(n,i){var a=i,u=0;do{var d=a.nextSibling;if(n.removeChild(a),d&&d.nodeType===8)if(a=d.data,a==="/$"){if(u===0){n.removeChild(d),Qs(i);return}u--}else a!=="$"&&a!=="$?"&&a!=="$!"||u++;a=d}while(a);Qs(i)}function ai(n){for(;n!=null;n=n.nextSibling){var i=n.nodeType;if(i===1||i===3)break;if(i===8){if(i=n.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return n}function Lu(n){n=n.previousSibling;for(var i=0;n;){if(n.nodeType===8){var a=n.data;if(a==="$"||a==="$!"||a==="$?"){if(i===0)return n;i--}else a==="/$"&&i++}n=n.previousSibling}return null}var ms=Math.random().toString(36).slice(2),kn="__reactFiber$"+ms,lr="__reactProps$"+ms,zn="__reactContainer$"+ms,Qo="__reactEvents$"+ms,pp="__reactListeners$"+ms,gp="__reactHandles$"+ms;function Fi(n){var i=n[kn];if(i)return i;for(var a=n.parentNode;a;){if(i=a[zn]||a[kn]){if(a=i.alternate,i.child!==null||a!==null&&a.child!==null)for(n=Lu(n);n!==null;){if(a=n[kn])return a;n=Lu(n)}return i}n=a,a=n.parentNode}return null}function cr(n){return n=n[kn]||n[zn],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function vs(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(e(33))}function fa(n){return n[lr]||null}var Zo=[],ys=-1;function oi(n){return{current:n}}function Jt(n){0>ys||(n.current=Zo[ys],Zo[ys]=null,ys--)}function qt(n,i){ys++,Zo[ys]=n.current,n.current=i}var li={},Pe=oi(li),$e=oi(!1),Di=li;function ws(n,i){var a=n.type.contextTypes;if(!a)return li;var u=n.stateNode;if(u&&u.__reactInternalMemoizedUnmaskedChildContext===i)return u.__reactInternalMemoizedMaskedChildContext;var d={},m;for(m in a)d[m]=i[m];return u&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=d),d}function Ve(n){return n=n.childContextTypes,n!=null}function pa(){Jt($e),Jt(Pe)}function Nu(n,i,a){if(Pe.current!==li)throw Error(e(168));qt(Pe,i),qt($e,a)}function Iu(n,i,a){var u=n.stateNode;if(i=i.childContextTypes,typeof u.getChildContext!="function")return a;u=u.getChildContext();for(var d in u)if(!(d in i))throw Error(e(108,dt(n)||"Unknown",d));return Q({},a,u)}function ga(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||li,Di=Pe.current,qt(Pe,n),qt($e,$e.current),!0}function Fu(n,i,a){var u=n.stateNode;if(!u)throw Error(e(169));a?(n=Iu(n,i,Di),u.__reactInternalMemoizedMergedChildContext=n,Jt($e),Jt(Pe),qt(Pe,n)):Jt($e),qt($e,a)}var Hn=null,ma=!1,Jo=!1;function Du(n){Hn===null?Hn=[n]:Hn.push(n)}function mp(n){ma=!0,Du(n)}function ci(){if(!Jo&&Hn!==null){Jo=!0;var n=0,i=Gt;try{var a=Hn;for(Gt=1;n<a.length;n++){var u=a[n];do u=u(!0);while(u!==null)}Hn=null,ma=!1}catch(d){throw Hn!==null&&(Hn=Hn.slice(n+1)),Yr(B,ci),d}finally{Gt=i,Jo=!1}}return null}var As=[],bs=0,va=null,ya=0,cn=[],un=0,Oi=null,Bn=1,Un="";function ji(n,i){As[bs++]=ya,As[bs++]=va,va=n,ya=i}function Ou(n,i,a){cn[un++]=Bn,cn[un++]=Un,cn[un++]=Oi,Oi=n;var u=Bn;n=Un;var d=32-Vt(u)-1;u&=~(1<<d),a+=1;var m=32-Vt(i)+d;if(30<m){var w=d-d%5;m=(u&(1<<w)-1).toString(32),u>>=w,d-=w,Bn=1<<32-Vt(i)+d|a<<d|u,Un=m+n}else Bn=1<<m|a<<d|u,Un=n}function tl(n){n.return!==null&&(ji(n,1),Ou(n,1,0))}function el(n){for(;n===va;)va=As[--bs],As[bs]=null,ya=As[--bs],As[bs]=null;for(;n===Oi;)Oi=cn[--un],cn[un]=null,Un=cn[--un],cn[un]=null,Bn=cn[--un],cn[un]=null}var en=null,nn=null,ee=!1,yn=null;function ju(n,i){var a=pn(5,null,null,0);a.elementType="DELETED",a.stateNode=i,a.return=n,i=n.deletions,i===null?(n.deletions=[a],n.flags|=16):i.push(a)}function zu(n,i){switch(n.tag){case 5:var a=n.type;return i=i.nodeType!==1||a.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(n.stateNode=i,en=n,nn=ai(i.firstChild),!0):!1;case 6:return i=n.pendingProps===""||i.nodeType!==3?null:i,i!==null?(n.stateNode=i,en=n,nn=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(a=Oi!==null?{id:Bn,overflow:Un}:null,n.memoizedState={dehydrated:i,treeContext:a,retryLane:1073741824},a=pn(18,null,null,0),a.stateNode=i,a.return=n,n.child=a,en=n,nn=null,!0):!1;default:return!1}}function nl(n){return(n.mode&1)!==0&&(n.flags&128)===0}function il(n){if(ee){var i=nn;if(i){var a=i;if(!zu(n,i)){if(nl(n))throw Error(e(418));i=ai(a.nextSibling);var u=en;i&&zu(n,i)?ju(u,a):(n.flags=n.flags&-4097|2,ee=!1,en=n)}}else{if(nl(n))throw Error(e(418));n.flags=n.flags&-4097|2,ee=!1,en=n}}}function Hu(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;en=n}function wa(n){if(n!==en)return!1;if(!ee)return Hu(n),ee=!0,!1;var i;if((i=n.tag!==3)&&!(i=n.tag!==5)&&(i=n.type,i=i!=="head"&&i!=="body"&&!qo(n.type,n.memoizedProps)),i&&(i=nn)){if(nl(n))throw Bu(),Error(e(418));for(;i;)ju(n,i),i=ai(i.nextSibling)}if(Hu(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(e(317));t:{for(n=n.nextSibling,i=0;n;){if(n.nodeType===8){var a=n.data;if(a==="/$"){if(i===0){nn=ai(n.nextSibling);break t}i--}else a!=="$"&&a!=="$!"&&a!=="$?"||i++}n=n.nextSibling}nn=null}}else nn=en?ai(n.stateNode.nextSibling):null;return!0}function Bu(){for(var n=nn;n;)n=ai(n.nextSibling)}function _s(){nn=en=null,ee=!1}function sl(n){yn===null?yn=[n]:yn.push(n)}var vp=j.ReactCurrentBatchConfig;function ur(n,i,a){if(n=a.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(a._owner){if(a=a._owner,a){if(a.tag!==1)throw Error(e(309));var u=a.stateNode}if(!u)throw Error(e(147,n));var d=u,m=""+n;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===m?i.ref:(i=function(w){var x=d.refs;w===null?delete x[m]:x[m]=w},i._stringRef=m,i)}if(typeof n!="string")throw Error(e(284));if(!a._owner)throw Error(e(290,n))}return n}function Aa(n,i){throw n=Object.prototype.toString.call(i),Error(e(31,n==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":n))}function Uu(n){var i=n._init;return i(n._payload)}function $u(n){function i(L,R){if(n){var N=L.deletions;N===null?(L.deletions=[R],L.flags|=16):N.push(R)}}function a(L,R){if(!n)return null;for(;R!==null;)i(L,R),R=R.sibling;return null}function u(L,R){for(L=new Map;R!==null;)R.key!==null?L.set(R.key,R):L.set(R.index,R),R=R.sibling;return L}function d(L,R){return L=vi(L,R),L.index=0,L.sibling=null,L}function m(L,R,N){return L.index=N,n?(N=L.alternate,N!==null?(N=N.index,N<R?(L.flags|=2,R):N):(L.flags|=2,R)):(L.flags|=1048576,R)}function w(L){return n&&L.alternate===null&&(L.flags|=2),L}function x(L,R,N,K){return R===null||R.tag!==6?(R=Yl(N,L.mode,K),R.return=L,R):(R=d(R,N),R.return=L,R)}function P(L,R,N,K){var ut=N.type;return ut===V?$(L,R,N.props.children,K,N.key):R!==null&&(R.elementType===ut||typeof ut=="object"&&ut!==null&&ut.$$typeof===Z&&Uu(ut)===R.type)?(K=d(R,N.props),K.ref=ur(L,R,N),K.return=L,K):(K=Va(N.type,N.key,N.props,null,L.mode,K),K.ref=ur(L,R,N),K.return=L,K)}function F(L,R,N,K){return R===null||R.tag!==4||R.stateNode.containerInfo!==N.containerInfo||R.stateNode.implementation!==N.implementation?(R=Kl(N,L.mode,K),R.return=L,R):(R=d(R,N.children||[]),R.return=L,R)}function $(L,R,N,K,ut){return R===null||R.tag!==7?(R=Wi(N,L.mode,K,ut),R.return=L,R):(R=d(R,N),R.return=L,R)}function G(L,R,N){if(typeof R=="string"&&R!==""||typeof R=="number")return R=Yl(""+R,L.mode,N),R.return=L,R;if(typeof R=="object"&&R!==null){switch(R.$$typeof){case H:return N=Va(R.type,R.key,R.props,null,L.mode,N),N.ref=ur(L,null,R),N.return=L,N;case W:return R=Kl(R,L.mode,N),R.return=L,R;case Z:var K=R._init;return G(L,K(R._payload),N)}if(Ei(R)||nt(R))return R=Wi(R,L.mode,N,null),R.return=L,R;Aa(L,R)}return null}function U(L,R,N,K){var ut=R!==null?R.key:null;if(typeof N=="string"&&N!==""||typeof N=="number")return ut!==null?null:x(L,R,""+N,K);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case H:return N.key===ut?P(L,R,N,K):null;case W:return N.key===ut?F(L,R,N,K):null;case Z:return ut=N._init,U(L,R,ut(N._payload),K)}if(Ei(N)||nt(N))return ut!==null?null:$(L,R,N,K,null);Aa(L,N)}return null}function et(L,R,N,K,ut){if(typeof K=="string"&&K!==""||typeof K=="number")return L=L.get(N)||null,x(R,L,""+K,ut);if(typeof K=="object"&&K!==null){switch(K.$$typeof){case H:return L=L.get(K.key===null?N:K.key)||null,P(R,L,K,ut);case W:return L=L.get(K.key===null?N:K.key)||null,F(R,L,K,ut);case Z:var gt=K._init;return et(L,R,N,gt(K._payload),ut)}if(Ei(K)||nt(K))return L=L.get(N)||null,$(R,L,K,ut,null);Aa(R,K)}return null}function ot(L,R,N,K){for(var ut=null,gt=null,mt=R,bt=R=0,xe=null;mt!==null&&bt<N.length;bt++){mt.index>bt?(xe=mt,mt=null):xe=mt.sibling;var $t=U(L,mt,N[bt],K);if($t===null){mt===null&&(mt=xe);break}n&&mt&&$t.alternate===null&&i(L,mt),R=m($t,R,bt),gt===null?ut=$t:gt.sibling=$t,gt=$t,mt=xe}if(bt===N.length)return a(L,mt),ee&&ji(L,bt),ut;if(mt===null){for(;bt<N.length;bt++)mt=G(L,N[bt],K),mt!==null&&(R=m(mt,R,bt),gt===null?ut=mt:gt.sibling=mt,gt=mt);return ee&&ji(L,bt),ut}for(mt=u(L,mt);bt<N.length;bt++)xe=et(mt,L,bt,N[bt],K),xe!==null&&(n&&xe.alternate!==null&&mt.delete(xe.key===null?bt:xe.key),R=m(xe,R,bt),gt===null?ut=xe:gt.sibling=xe,gt=xe);return n&&mt.forEach(function(yi){return i(L,yi)}),ee&&ji(L,bt),ut}function lt(L,R,N,K){var ut=nt(N);if(typeof ut!="function")throw Error(e(150));if(N=ut.call(N),N==null)throw Error(e(151));for(var gt=ut=null,mt=R,bt=R=0,xe=null,$t=N.next();mt!==null&&!$t.done;bt++,$t=N.next()){mt.index>bt?(xe=mt,mt=null):xe=mt.sibling;var yi=U(L,mt,$t.value,K);if(yi===null){mt===null&&(mt=xe);break}n&&mt&&yi.alternate===null&&i(L,mt),R=m(yi,R,bt),gt===null?ut=yi:gt.sibling=yi,gt=yi,mt=xe}if($t.done)return a(L,mt),ee&&ji(L,bt),ut;if(mt===null){for(;!$t.done;bt++,$t=N.next())$t=G(L,$t.value,K),$t!==null&&(R=m($t,R,bt),gt===null?ut=$t:gt.sibling=$t,gt=$t);return ee&&ji(L,bt),ut}for(mt=u(L,mt);!$t.done;bt++,$t=N.next())$t=et(mt,L,bt,$t.value,K),$t!==null&&(n&&$t.alternate!==null&&mt.delete($t.key===null?bt:$t.key),R=m($t,R,bt),gt===null?ut=$t:gt.sibling=$t,gt=$t);return n&&mt.forEach(function(Kp){return i(L,Kp)}),ee&&ji(L,bt),ut}function ue(L,R,N,K){if(typeof N=="object"&&N!==null&&N.type===V&&N.key===null&&(N=N.props.children),typeof N=="object"&&N!==null){switch(N.$$typeof){case H:t:{for(var ut=N.key,gt=R;gt!==null;){if(gt.key===ut){if(ut=N.type,ut===V){if(gt.tag===7){a(L,gt.sibling),R=d(gt,N.props.children),R.return=L,L=R;break t}}else if(gt.elementType===ut||typeof ut=="object"&&ut!==null&&ut.$$typeof===Z&&Uu(ut)===gt.type){a(L,gt.sibling),R=d(gt,N.props),R.ref=ur(L,gt,N),R.return=L,L=R;break t}a(L,gt);break}else i(L,gt);gt=gt.sibling}N.type===V?(R=Wi(N.props.children,L.mode,K,N.key),R.return=L,L=R):(K=Va(N.type,N.key,N.props,null,L.mode,K),K.ref=ur(L,R,N),K.return=L,L=K)}return w(L);case W:t:{for(gt=N.key;R!==null;){if(R.key===gt)if(R.tag===4&&R.stateNode.containerInfo===N.containerInfo&&R.stateNode.implementation===N.implementation){a(L,R.sibling),R=d(R,N.children||[]),R.return=L,L=R;break t}else{a(L,R);break}else i(L,R);R=R.sibling}R=Kl(N,L.mode,K),R.return=L,L=R}return w(L);case Z:return gt=N._init,ue(L,R,gt(N._payload),K)}if(Ei(N))return ot(L,R,N,K);if(nt(N))return lt(L,R,N,K);Aa(L,N)}return typeof N=="string"&&N!==""||typeof N=="number"?(N=""+N,R!==null&&R.tag===6?(a(L,R.sibling),R=d(R,N),R.return=L,L=R):(a(L,R),R=Yl(N,L.mode,K),R.return=L,L=R),w(L)):a(L,R)}return ue}var Ss=$u(!0),Vu=$u(!1),ba=oi(null),_a=null,xs=null,rl=null;function al(){rl=xs=_a=null}function ol(n){var i=ba.current;Jt(ba),n._currentValue=i}function ll(n,i,a){for(;n!==null;){var u=n.alternate;if((n.childLanes&i)!==i?(n.childLanes|=i,u!==null&&(u.childLanes|=i)):u!==null&&(u.childLanes&i)!==i&&(u.childLanes|=i),n===a)break;n=n.return}}function Es(n,i){_a=n,rl=xs=null,n=n.dependencies,n!==null&&n.firstContext!==null&&((n.lanes&i)!==0&&(Ge=!0),n.firstContext=null)}function hn(n){var i=n._currentValue;if(rl!==n)if(n={context:n,memoizedValue:i,next:null},xs===null){if(_a===null)throw Error(e(308));xs=n,_a.dependencies={lanes:0,firstContext:n}}else xs=xs.next=n;return i}var zi=null;function cl(n){zi===null?zi=[n]:zi.push(n)}function Gu(n,i,a,u){var d=i.interleaved;return d===null?(a.next=a,cl(i)):(a.next=d.next,d.next=a),i.interleaved=a,$n(n,u)}function $n(n,i){n.lanes|=i;var a=n.alternate;for(a!==null&&(a.lanes|=i),a=n,n=n.return;n!==null;)n.childLanes|=i,a=n.alternate,a!==null&&(a.childLanes|=i),a=n,n=n.return;return a.tag===3?a.stateNode:null}var ui=!1;function ul(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Wu(n,i){n=n.updateQueue,i.updateQueue===n&&(i.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Vn(n,i){return{eventTime:n,lane:i,tag:0,payload:null,callback:null,next:null}}function hi(n,i,a){var u=n.updateQueue;if(u===null)return null;if(u=u.shared,(Bt&2)!==0){var d=u.pending;return d===null?i.next=i:(i.next=d.next,d.next=i),u.pending=i,$n(n,a)}return d=u.interleaved,d===null?(i.next=i,cl(u)):(i.next=d.next,d.next=i),u.interleaved=i,$n(n,a)}function Sa(n,i,a){if(i=i.updateQueue,i!==null&&(i=i.shared,(a&4194240)!==0)){var u=i.lanes;u&=n.pendingLanes,a|=u,i.lanes=a,cs(n,a)}}function Xu(n,i){var a=n.updateQueue,u=n.alternate;if(u!==null&&(u=u.updateQueue,a===u)){var d=null,m=null;if(a=a.firstBaseUpdate,a!==null){do{var w={eventTime:a.eventTime,lane:a.lane,tag:a.tag,payload:a.payload,callback:a.callback,next:null};m===null?d=m=w:m=m.next=w,a=a.next}while(a!==null);m===null?d=m=i:m=m.next=i}else d=m=i;a={baseState:u.baseState,firstBaseUpdate:d,lastBaseUpdate:m,shared:u.shared,effects:u.effects},n.updateQueue=a;return}n=a.lastBaseUpdate,n===null?a.firstBaseUpdate=i:n.next=i,a.lastBaseUpdate=i}function xa(n,i,a,u){var d=n.updateQueue;ui=!1;var m=d.firstBaseUpdate,w=d.lastBaseUpdate,x=d.shared.pending;if(x!==null){d.shared.pending=null;var P=x,F=P.next;P.next=null,w===null?m=F:w.next=F,w=P;var $=n.alternate;$!==null&&($=$.updateQueue,x=$.lastBaseUpdate,x!==w&&(x===null?$.firstBaseUpdate=F:x.next=F,$.lastBaseUpdate=P))}if(m!==null){var G=d.baseState;w=0,$=F=P=null,x=m;do{var U=x.lane,et=x.eventTime;if((u&U)===U){$!==null&&($=$.next={eventTime:et,lane:0,tag:x.tag,payload:x.payload,callback:x.callback,next:null});t:{var ot=n,lt=x;switch(U=i,et=a,lt.tag){case 1:if(ot=lt.payload,typeof ot=="function"){G=ot.call(et,G,U);break t}G=ot;break t;case 3:ot.flags=ot.flags&-65537|128;case 0:if(ot=lt.payload,U=typeof ot=="function"?ot.call(et,G,U):ot,U==null)break t;G=Q({},G,U);break t;case 2:ui=!0}}x.callback!==null&&x.lane!==0&&(n.flags|=64,U=d.effects,U===null?d.effects=[x]:U.push(x))}else et={eventTime:et,lane:U,tag:x.tag,payload:x.payload,callback:x.callback,next:null},$===null?(F=$=et,P=G):$=$.next=et,w|=U;if(x=x.next,x===null){if(x=d.shared.pending,x===null)break;U=x,x=U.next,U.next=null,d.lastBaseUpdate=U,d.shared.pending=null}}while(!0);if($===null&&(P=G),d.baseState=P,d.firstBaseUpdate=F,d.lastBaseUpdate=$,i=d.shared.interleaved,i!==null){d=i;do w|=d.lane,d=d.next;while(d!==i)}else m===null&&(d.shared.lanes=0);Ui|=w,n.lanes=w,n.memoizedState=G}}function qu(n,i,a){if(n=i.effects,i.effects=null,n!==null)for(i=0;i<n.length;i++){var u=n[i],d=u.callback;if(d!==null){if(u.callback=null,u=a,typeof d!="function")throw Error(e(191,d));d.call(u)}}}var hr={},Tn=oi(hr),dr=oi(hr),fr=oi(hr);function Hi(n){if(n===hr)throw Error(e(174));return n}function hl(n,i){switch(qt(fr,i),qt(dr,n),qt(Tn,hr),n=i.nodeType,n){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:Yn(null,"");break;default:n=n===8?i.parentNode:i,i=n.namespaceURI||null,n=n.tagName,i=Yn(i,n)}Jt(Tn),qt(Tn,i)}function Cs(){Jt(Tn),Jt(dr),Jt(fr)}function Yu(n){Hi(fr.current);var i=Hi(Tn.current),a=Yn(i,n.type);i!==a&&(qt(dr,n),qt(Tn,a))}function dl(n){dr.current===n&&(Jt(Tn),Jt(dr))}var re=oi(0);function Ea(n){for(var i=n;i!==null;){if(i.tag===13){var a=i.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||a.data==="$?"||a.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var fl=[];function pl(){for(var n=0;n<fl.length;n++)fl[n]._workInProgressVersionPrimary=null;fl.length=0}var Ca=j.ReactCurrentDispatcher,gl=j.ReactCurrentBatchConfig,Bi=0,ae=null,ve=null,_e=null,ka=!1,pr=!1,gr=0,yp=0;function Re(){throw Error(e(321))}function ml(n,i){if(i===null)return!1;for(var a=0;a<i.length&&a<n.length;a++)if(!vn(n[a],i[a]))return!1;return!0}function vl(n,i,a,u,d,m){if(Bi=m,ae=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,Ca.current=n===null||n.memoizedState===null?_p:Sp,n=a(u,d),pr){m=0;do{if(pr=!1,gr=0,25<=m)throw Error(e(301));m+=1,_e=ve=null,i.updateQueue=null,Ca.current=xp,n=a(u,d)}while(pr)}if(Ca.current=Ra,i=ve!==null&&ve.next!==null,Bi=0,_e=ve=ae=null,ka=!1,i)throw Error(e(300));return n}function yl(){var n=gr!==0;return gr=0,n}function Pn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return _e===null?ae.memoizedState=_e=n:_e=_e.next=n,_e}function dn(){if(ve===null){var n=ae.alternate;n=n!==null?n.memoizedState:null}else n=ve.next;var i=_e===null?ae.memoizedState:_e.next;if(i!==null)_e=i,ve=n;else{if(n===null)throw Error(e(310));ve=n,n={memoizedState:ve.memoizedState,baseState:ve.baseState,baseQueue:ve.baseQueue,queue:ve.queue,next:null},_e===null?ae.memoizedState=_e=n:_e=_e.next=n}return _e}function mr(n,i){return typeof i=="function"?i(n):i}function wl(n){var i=dn(),a=i.queue;if(a===null)throw Error(e(311));a.lastRenderedReducer=n;var u=ve,d=u.baseQueue,m=a.pending;if(m!==null){if(d!==null){var w=d.next;d.next=m.next,m.next=w}u.baseQueue=d=m,a.pending=null}if(d!==null){m=d.next,u=u.baseState;var x=w=null,P=null,F=m;do{var $=F.lane;if((Bi&$)===$)P!==null&&(P=P.next={lane:0,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null}),u=F.hasEagerState?F.eagerState:n(u,F.action);else{var G={lane:$,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null};P===null?(x=P=G,w=u):P=P.next=G,ae.lanes|=$,Ui|=$}F=F.next}while(F!==null&&F!==m);P===null?w=u:P.next=x,vn(u,i.memoizedState)||(Ge=!0),i.memoizedState=u,i.baseState=w,i.baseQueue=P,a.lastRenderedState=u}if(n=a.interleaved,n!==null){d=n;do m=d.lane,ae.lanes|=m,Ui|=m,d=d.next;while(d!==n)}else d===null&&(a.lanes=0);return[i.memoizedState,a.dispatch]}function Al(n){var i=dn(),a=i.queue;if(a===null)throw Error(e(311));a.lastRenderedReducer=n;var u=a.dispatch,d=a.pending,m=i.memoizedState;if(d!==null){a.pending=null;var w=d=d.next;do m=n(m,w.action),w=w.next;while(w!==d);vn(m,i.memoizedState)||(Ge=!0),i.memoizedState=m,i.baseQueue===null&&(i.baseState=m),a.lastRenderedState=m}return[m,u]}function Ku(){}function Qu(n,i){var a=ae,u=dn(),d=i(),m=!vn(u.memoizedState,d);if(m&&(u.memoizedState=d,Ge=!0),u=u.queue,bl(th.bind(null,a,u,n),[n]),u.getSnapshot!==i||m||_e!==null&&_e.memoizedState.tag&1){if(a.flags|=2048,vr(9,Ju.bind(null,a,u,d,i),void 0,null),Se===null)throw Error(e(349));(Bi&30)!==0||Zu(a,i,d)}return d}function Zu(n,i,a){n.flags|=16384,n={getSnapshot:i,value:a},i=ae.updateQueue,i===null?(i={lastEffect:null,stores:null},ae.updateQueue=i,i.stores=[n]):(a=i.stores,a===null?i.stores=[n]:a.push(n))}function Ju(n,i,a,u){i.value=a,i.getSnapshot=u,eh(i)&&nh(n)}function th(n,i,a){return a(function(){eh(i)&&nh(n)})}function eh(n){var i=n.getSnapshot;n=n.value;try{var a=i();return!vn(n,a)}catch{return!0}}function nh(n){var i=$n(n,1);i!==null&&_n(i,n,1,-1)}function ih(n){var i=Pn();return typeof n=="function"&&(n=n()),i.memoizedState=i.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:mr,lastRenderedState:n},i.queue=n,n=n.dispatch=bp.bind(null,ae,n),[i.memoizedState,n]}function vr(n,i,a,u){return n={tag:n,create:i,destroy:a,deps:u,next:null},i=ae.updateQueue,i===null?(i={lastEffect:null,stores:null},ae.updateQueue=i,i.lastEffect=n.next=n):(a=i.lastEffect,a===null?i.lastEffect=n.next=n:(u=a.next,a.next=n,n.next=u,i.lastEffect=n)),n}function sh(){return dn().memoizedState}function Ta(n,i,a,u){var d=Pn();ae.flags|=n,d.memoizedState=vr(1|i,a,void 0,u===void 0?null:u)}function Pa(n,i,a,u){var d=dn();u=u===void 0?null:u;var m=void 0;if(ve!==null){var w=ve.memoizedState;if(m=w.destroy,u!==null&&ml(u,w.deps)){d.memoizedState=vr(i,a,m,u);return}}ae.flags|=n,d.memoizedState=vr(1|i,a,m,u)}function rh(n,i){return Ta(8390656,8,n,i)}function bl(n,i){return Pa(2048,8,n,i)}function ah(n,i){return Pa(4,2,n,i)}function oh(n,i){return Pa(4,4,n,i)}function lh(n,i){if(typeof i=="function")return n=n(),i(n),function(){i(null)};if(i!=null)return n=n(),i.current=n,function(){i.current=null}}function ch(n,i,a){return a=a!=null?a.concat([n]):null,Pa(4,4,lh.bind(null,i,n),a)}function _l(){}function uh(n,i){var a=dn();i=i===void 0?null:i;var u=a.memoizedState;return u!==null&&i!==null&&ml(i,u[1])?u[0]:(a.memoizedState=[n,i],n)}function hh(n,i){var a=dn();i=i===void 0?null:i;var u=a.memoizedState;return u!==null&&i!==null&&ml(i,u[1])?u[0]:(n=n(),a.memoizedState=[n,i],n)}function dh(n,i,a){return(Bi&21)===0?(n.baseState&&(n.baseState=!1,Ge=!0),n.memoizedState=a):(vn(a,i)||(a=Ws(),ae.lanes|=a,Ui|=a,n.baseState=!0),i)}function wp(n,i){var a=Gt;Gt=a!==0&&4>a?a:4,n(!0);var u=gl.transition;gl.transition={};try{n(!1),i()}finally{Gt=a,gl.transition=u}}function fh(){return dn().memoizedState}function Ap(n,i,a){var u=gi(n);if(a={lane:u,action:a,hasEagerState:!1,eagerState:null,next:null},ph(n))gh(i,a);else if(a=Gu(n,i,a,u),a!==null){var d=je();_n(a,n,u,d),mh(a,i,u)}}function bp(n,i,a){var u=gi(n),d={lane:u,action:a,hasEagerState:!1,eagerState:null,next:null};if(ph(n))gh(i,d);else{var m=n.alternate;if(n.lanes===0&&(m===null||m.lanes===0)&&(m=i.lastRenderedReducer,m!==null))try{var w=i.lastRenderedState,x=m(w,a);if(d.hasEagerState=!0,d.eagerState=x,vn(x,w)){var P=i.interleaved;P===null?(d.next=d,cl(i)):(d.next=P.next,P.next=d),i.interleaved=d;return}}catch{}a=Gu(n,i,d,u),a!==null&&(d=je(),_n(a,n,u,d),mh(a,i,u))}}function ph(n){var i=n.alternate;return n===ae||i!==null&&i===ae}function gh(n,i){pr=ka=!0;var a=n.pending;a===null?i.next=i:(i.next=a.next,a.next=i),n.pending=i}function mh(n,i,a){if((a&4194240)!==0){var u=i.lanes;u&=n.pendingLanes,a|=u,i.lanes=a,cs(n,a)}}var Ra={readContext:hn,useCallback:Re,useContext:Re,useEffect:Re,useImperativeHandle:Re,useInsertionEffect:Re,useLayoutEffect:Re,useMemo:Re,useReducer:Re,useRef:Re,useState:Re,useDebugValue:Re,useDeferredValue:Re,useTransition:Re,useMutableSource:Re,useSyncExternalStore:Re,useId:Re,unstable_isNewReconciler:!1},_p={readContext:hn,useCallback:function(n,i){return Pn().memoizedState=[n,i===void 0?null:i],n},useContext:hn,useEffect:rh,useImperativeHandle:function(n,i,a){return a=a!=null?a.concat([n]):null,Ta(4194308,4,lh.bind(null,i,n),a)},useLayoutEffect:function(n,i){return Ta(4194308,4,n,i)},useInsertionEffect:function(n,i){return Ta(4,2,n,i)},useMemo:function(n,i){var a=Pn();return i=i===void 0?null:i,n=n(),a.memoizedState=[n,i],n},useReducer:function(n,i,a){var u=Pn();return i=a!==void 0?a(i):i,u.memoizedState=u.baseState=i,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:i},u.queue=n,n=n.dispatch=Ap.bind(null,ae,n),[u.memoizedState,n]},useRef:function(n){var i=Pn();return n={current:n},i.memoizedState=n},useState:ih,useDebugValue:_l,useDeferredValue:function(n){return Pn().memoizedState=n},useTransition:function(){var n=ih(!1),i=n[0];return n=wp.bind(null,n[1]),Pn().memoizedState=n,[i,n]},useMutableSource:function(){},useSyncExternalStore:function(n,i,a){var u=ae,d=Pn();if(ee){if(a===void 0)throw Error(e(407));a=a()}else{if(a=i(),Se===null)throw Error(e(349));(Bi&30)!==0||Zu(u,i,a)}d.memoizedState=a;var m={value:a,getSnapshot:i};return d.queue=m,rh(th.bind(null,u,m,n),[n]),u.flags|=2048,vr(9,Ju.bind(null,u,m,a,i),void 0,null),a},useId:function(){var n=Pn(),i=Se.identifierPrefix;if(ee){var a=Un,u=Bn;a=(u&~(1<<32-Vt(u)-1)).toString(32)+a,i=":"+i+"R"+a,a=gr++,0<a&&(i+="H"+a.toString(32)),i+=":"}else a=yp++,i=":"+i+"r"+a.toString(32)+":";return n.memoizedState=i},unstable_isNewReconciler:!1},Sp={readContext:hn,useCallback:uh,useContext:hn,useEffect:bl,useImperativeHandle:ch,useInsertionEffect:ah,useLayoutEffect:oh,useMemo:hh,useReducer:wl,useRef:sh,useState:function(){return wl(mr)},useDebugValue:_l,useDeferredValue:function(n){var i=dn();return dh(i,ve.memoizedState,n)},useTransition:function(){var n=wl(mr)[0],i=dn().memoizedState;return[n,i]},useMutableSource:Ku,useSyncExternalStore:Qu,useId:fh,unstable_isNewReconciler:!1},xp={readContext:hn,useCallback:uh,useContext:hn,useEffect:bl,useImperativeHandle:ch,useInsertionEffect:ah,useLayoutEffect:oh,useMemo:hh,useReducer:Al,useRef:sh,useState:function(){return Al(mr)},useDebugValue:_l,useDeferredValue:function(n){var i=dn();return ve===null?i.memoizedState=n:dh(i,ve.memoizedState,n)},useTransition:function(){var n=Al(mr)[0],i=dn().memoizedState;return[n,i]},useMutableSource:Ku,useSyncExternalStore:Qu,useId:fh,unstable_isNewReconciler:!1};function wn(n,i){if(n&&n.defaultProps){i=Q({},i),n=n.defaultProps;for(var a in n)i[a]===void 0&&(i[a]=n[a]);return i}return i}function Sl(n,i,a,u){i=n.memoizedState,a=a(u,i),a=a==null?i:Q({},i,a),n.memoizedState=a,n.lanes===0&&(n.updateQueue.baseState=a)}var Ma={isMounted:function(n){return(n=n._reactInternals)?ce(n)===n:!1},enqueueSetState:function(n,i,a){n=n._reactInternals;var u=je(),d=gi(n),m=Vn(u,d);m.payload=i,a!=null&&(m.callback=a),i=hi(n,m,d),i!==null&&(_n(i,n,d,u),Sa(i,n,d))},enqueueReplaceState:function(n,i,a){n=n._reactInternals;var u=je(),d=gi(n),m=Vn(u,d);m.tag=1,m.payload=i,a!=null&&(m.callback=a),i=hi(n,m,d),i!==null&&(_n(i,n,d,u),Sa(i,n,d))},enqueueForceUpdate:function(n,i){n=n._reactInternals;var a=je(),u=gi(n),d=Vn(a,u);d.tag=2,i!=null&&(d.callback=i),i=hi(n,d,u),i!==null&&(_n(i,n,u,a),Sa(i,n,u))}};function vh(n,i,a,u,d,m,w){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(u,m,w):i.prototype&&i.prototype.isPureReactComponent?!ir(a,u)||!ir(d,m):!0}function yh(n,i,a){var u=!1,d=li,m=i.contextType;return typeof m=="object"&&m!==null?m=hn(m):(d=Ve(i)?Di:Pe.current,u=i.contextTypes,m=(u=u!=null)?ws(n,d):li),i=new i(a,m),n.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Ma,n.stateNode=i,i._reactInternals=n,u&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=d,n.__reactInternalMemoizedMaskedChildContext=m),i}function wh(n,i,a,u){n=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(a,u),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(a,u),i.state!==n&&Ma.enqueueReplaceState(i,i.state,null)}function xl(n,i,a,u){var d=n.stateNode;d.props=a,d.state=n.memoizedState,d.refs={},ul(n);var m=i.contextType;typeof m=="object"&&m!==null?d.context=hn(m):(m=Ve(i)?Di:Pe.current,d.context=ws(n,m)),d.state=n.memoizedState,m=i.getDerivedStateFromProps,typeof m=="function"&&(Sl(n,i,m,a),d.state=n.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof d.getSnapshotBeforeUpdate=="function"||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(i=d.state,typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount(),i!==d.state&&Ma.enqueueReplaceState(d,d.state,null),xa(n,a,d,u),d.state=n.memoizedState),typeof d.componentDidMount=="function"&&(n.flags|=4194308)}function ks(n,i){try{var a="",u=i;do a+=xt(u),u=u.return;while(u);var d=a}catch(m){d=`
Error generating stack: `+m.message+`
`+m.stack}return{value:n,source:i,stack:d,digest:null}}function El(n,i,a){return{value:n,source:null,stack:a??null,digest:i??null}}function Cl(n,i){try{console.error(i.value)}catch(a){setTimeout(function(){throw a})}}var Ep=typeof WeakMap=="function"?WeakMap:Map;function Ah(n,i,a){a=Vn(-1,a),a.tag=3,a.payload={element:null};var u=i.value;return a.callback=function(){ja||(ja=!0,Bl=u),Cl(n,i)},a}function bh(n,i,a){a=Vn(-1,a),a.tag=3;var u=n.type.getDerivedStateFromError;if(typeof u=="function"){var d=i.value;a.payload=function(){return u(d)},a.callback=function(){Cl(n,i)}}var m=n.stateNode;return m!==null&&typeof m.componentDidCatch=="function"&&(a.callback=function(){Cl(n,i),typeof u!="function"&&(fi===null?fi=new Set([this]):fi.add(this));var w=i.stack;this.componentDidCatch(i.value,{componentStack:w!==null?w:""})}),a}function _h(n,i,a){var u=n.pingCache;if(u===null){u=n.pingCache=new Ep;var d=new Set;u.set(i,d)}else d=u.get(i),d===void 0&&(d=new Set,u.set(i,d));d.has(a)||(d.add(a),n=zp.bind(null,n,i,a),i.then(n,n))}function Sh(n){do{var i;if((i=n.tag===13)&&(i=n.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return n;n=n.return}while(n!==null);return null}function xh(n,i,a,u,d){return(n.mode&1)===0?(n===i?n.flags|=65536:(n.flags|=128,a.flags|=131072,a.flags&=-52805,a.tag===1&&(a.alternate===null?a.tag=17:(i=Vn(-1,1),i.tag=2,hi(a,i,1))),a.lanes|=1),n):(n.flags|=65536,n.lanes=d,n)}var Cp=j.ReactCurrentOwner,Ge=!1;function Oe(n,i,a,u){i.child=n===null?Vu(i,null,a,u):Ss(i,n.child,a,u)}function Eh(n,i,a,u,d){a=a.render;var m=i.ref;return Es(i,d),u=vl(n,i,a,u,m,d),a=yl(),n!==null&&!Ge?(i.updateQueue=n.updateQueue,i.flags&=-2053,n.lanes&=~d,Gn(n,i,d)):(ee&&a&&tl(i),i.flags|=1,Oe(n,i,u,d),i.child)}function Ch(n,i,a,u,d){if(n===null){var m=a.type;return typeof m=="function"&&!ql(m)&&m.defaultProps===void 0&&a.compare===null&&a.defaultProps===void 0?(i.tag=15,i.type=m,kh(n,i,m,u,d)):(n=Va(a.type,null,u,i,i.mode,d),n.ref=i.ref,n.return=i,i.child=n)}if(m=n.child,(n.lanes&d)===0){var w=m.memoizedProps;if(a=a.compare,a=a!==null?a:ir,a(w,u)&&n.ref===i.ref)return Gn(n,i,d)}return i.flags|=1,n=vi(m,u),n.ref=i.ref,n.return=i,i.child=n}function kh(n,i,a,u,d){if(n!==null){var m=n.memoizedProps;if(ir(m,u)&&n.ref===i.ref)if(Ge=!1,i.pendingProps=u=m,(n.lanes&d)!==0)(n.flags&131072)!==0&&(Ge=!0);else return i.lanes=n.lanes,Gn(n,i,d)}return kl(n,i,a,u,d)}function Th(n,i,a){var u=i.pendingProps,d=u.children,m=n!==null?n.memoizedState:null;if(u.mode==="hidden")if((i.mode&1)===0)i.memoizedState={baseLanes:0,cachePool:null,transitions:null},qt(Ps,sn),sn|=a;else{if((a&1073741824)===0)return n=m!==null?m.baseLanes|a:a,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:n,cachePool:null,transitions:null},i.updateQueue=null,qt(Ps,sn),sn|=n,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},u=m!==null?m.baseLanes:a,qt(Ps,sn),sn|=u}else m!==null?(u=m.baseLanes|a,i.memoizedState=null):u=a,qt(Ps,sn),sn|=u;return Oe(n,i,d,a),i.child}function Ph(n,i){var a=i.ref;(n===null&&a!==null||n!==null&&n.ref!==a)&&(i.flags|=512,i.flags|=2097152)}function kl(n,i,a,u,d){var m=Ve(a)?Di:Pe.current;return m=ws(i,m),Es(i,d),a=vl(n,i,a,u,m,d),u=yl(),n!==null&&!Ge?(i.updateQueue=n.updateQueue,i.flags&=-2053,n.lanes&=~d,Gn(n,i,d)):(ee&&u&&tl(i),i.flags|=1,Oe(n,i,a,d),i.child)}function Rh(n,i,a,u,d){if(Ve(a)){var m=!0;ga(i)}else m=!1;if(Es(i,d),i.stateNode===null)Na(n,i),yh(i,a,u),xl(i,a,u,d),u=!0;else if(n===null){var w=i.stateNode,x=i.memoizedProps;w.props=x;var P=w.context,F=a.contextType;typeof F=="object"&&F!==null?F=hn(F):(F=Ve(a)?Di:Pe.current,F=ws(i,F));var $=a.getDerivedStateFromProps,G=typeof $=="function"||typeof w.getSnapshotBeforeUpdate=="function";G||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(x!==u||P!==F)&&wh(i,w,u,F),ui=!1;var U=i.memoizedState;w.state=U,xa(i,u,w,d),P=i.memoizedState,x!==u||U!==P||$e.current||ui?(typeof $=="function"&&(Sl(i,a,$,u),P=i.memoizedState),(x=ui||vh(i,a,x,u,U,P,F))?(G||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount()),typeof w.componentDidMount=="function"&&(i.flags|=4194308)):(typeof w.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=u,i.memoizedState=P),w.props=u,w.state=P,w.context=F,u=x):(typeof w.componentDidMount=="function"&&(i.flags|=4194308),u=!1)}else{w=i.stateNode,Wu(n,i),x=i.memoizedProps,F=i.type===i.elementType?x:wn(i.type,x),w.props=F,G=i.pendingProps,U=w.context,P=a.contextType,typeof P=="object"&&P!==null?P=hn(P):(P=Ve(a)?Di:Pe.current,P=ws(i,P));var et=a.getDerivedStateFromProps;($=typeof et=="function"||typeof w.getSnapshotBeforeUpdate=="function")||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(x!==G||U!==P)&&wh(i,w,u,P),ui=!1,U=i.memoizedState,w.state=U,xa(i,u,w,d);var ot=i.memoizedState;x!==G||U!==ot||$e.current||ui?(typeof et=="function"&&(Sl(i,a,et,u),ot=i.memoizedState),(F=ui||vh(i,a,F,u,U,ot,P)||!1)?($||typeof w.UNSAFE_componentWillUpdate!="function"&&typeof w.componentWillUpdate!="function"||(typeof w.componentWillUpdate=="function"&&w.componentWillUpdate(u,ot,P),typeof w.UNSAFE_componentWillUpdate=="function"&&w.UNSAFE_componentWillUpdate(u,ot,P)),typeof w.componentDidUpdate=="function"&&(i.flags|=4),typeof w.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof w.componentDidUpdate!="function"||x===n.memoizedProps&&U===n.memoizedState||(i.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||x===n.memoizedProps&&U===n.memoizedState||(i.flags|=1024),i.memoizedProps=u,i.memoizedState=ot),w.props=u,w.state=ot,w.context=P,u=F):(typeof w.componentDidUpdate!="function"||x===n.memoizedProps&&U===n.memoizedState||(i.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||x===n.memoizedProps&&U===n.memoizedState||(i.flags|=1024),u=!1)}return Tl(n,i,a,u,m,d)}function Tl(n,i,a,u,d,m){Ph(n,i);var w=(i.flags&128)!==0;if(!u&&!w)return d&&Fu(i,a,!1),Gn(n,i,m);u=i.stateNode,Cp.current=i;var x=w&&typeof a.getDerivedStateFromError!="function"?null:u.render();return i.flags|=1,n!==null&&w?(i.child=Ss(i,n.child,null,m),i.child=Ss(i,null,x,m)):Oe(n,i,x,m),i.memoizedState=u.state,d&&Fu(i,a,!0),i.child}function Mh(n){var i=n.stateNode;i.pendingContext?Nu(n,i.pendingContext,i.pendingContext!==i.context):i.context&&Nu(n,i.context,!1),hl(n,i.containerInfo)}function Lh(n,i,a,u,d){return _s(),sl(d),i.flags|=256,Oe(n,i,a,u),i.child}var Pl={dehydrated:null,treeContext:null,retryLane:0};function Rl(n){return{baseLanes:n,cachePool:null,transitions:null}}function Nh(n,i,a){var u=i.pendingProps,d=re.current,m=!1,w=(i.flags&128)!==0,x;if((x=w)||(x=n!==null&&n.memoizedState===null?!1:(d&2)!==0),x?(m=!0,i.flags&=-129):(n===null||n.memoizedState!==null)&&(d|=1),qt(re,d&1),n===null)return il(i),n=i.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?((i.mode&1)===0?i.lanes=1:n.data==="$!"?i.lanes=8:i.lanes=1073741824,null):(w=u.children,n=u.fallback,m?(u=i.mode,m=i.child,w={mode:"hidden",children:w},(u&1)===0&&m!==null?(m.childLanes=0,m.pendingProps=w):m=Ga(w,u,0,null),n=Wi(n,u,a,null),m.return=i,n.return=i,m.sibling=n,i.child=m,i.child.memoizedState=Rl(a),i.memoizedState=Pl,n):Ml(i,w));if(d=n.memoizedState,d!==null&&(x=d.dehydrated,x!==null))return kp(n,i,w,u,x,d,a);if(m){m=u.fallback,w=i.mode,d=n.child,x=d.sibling;var P={mode:"hidden",children:u.children};return(w&1)===0&&i.child!==d?(u=i.child,u.childLanes=0,u.pendingProps=P,i.deletions=null):(u=vi(d,P),u.subtreeFlags=d.subtreeFlags&14680064),x!==null?m=vi(x,m):(m=Wi(m,w,a,null),m.flags|=2),m.return=i,u.return=i,u.sibling=m,i.child=u,u=m,m=i.child,w=n.child.memoizedState,w=w===null?Rl(a):{baseLanes:w.baseLanes|a,cachePool:null,transitions:w.transitions},m.memoizedState=w,m.childLanes=n.childLanes&~a,i.memoizedState=Pl,u}return m=n.child,n=m.sibling,u=vi(m,{mode:"visible",children:u.children}),(i.mode&1)===0&&(u.lanes=a),u.return=i,u.sibling=null,n!==null&&(a=i.deletions,a===null?(i.deletions=[n],i.flags|=16):a.push(n)),i.child=u,i.memoizedState=null,u}function Ml(n,i){return i=Ga({mode:"visible",children:i},n.mode,0,null),i.return=n,n.child=i}function La(n,i,a,u){return u!==null&&sl(u),Ss(i,n.child,null,a),n=Ml(i,i.pendingProps.children),n.flags|=2,i.memoizedState=null,n}function kp(n,i,a,u,d,m,w){if(a)return i.flags&256?(i.flags&=-257,u=El(Error(e(422))),La(n,i,w,u)):i.memoizedState!==null?(i.child=n.child,i.flags|=128,null):(m=u.fallback,d=i.mode,u=Ga({mode:"visible",children:u.children},d,0,null),m=Wi(m,d,w,null),m.flags|=2,u.return=i,m.return=i,u.sibling=m,i.child=u,(i.mode&1)!==0&&Ss(i,n.child,null,w),i.child.memoizedState=Rl(w),i.memoizedState=Pl,m);if((i.mode&1)===0)return La(n,i,w,null);if(d.data==="$!"){if(u=d.nextSibling&&d.nextSibling.dataset,u)var x=u.dgst;return u=x,m=Error(e(419)),u=El(m,u,void 0),La(n,i,w,u)}if(x=(w&n.childLanes)!==0,Ge||x){if(u=Se,u!==null){switch(w&-w){case 4:d=2;break;case 16:d=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:d=32;break;case 536870912:d=268435456;break;default:d=0}d=(d&(u.suspendedLanes|w))!==0?0:d,d!==0&&d!==m.retryLane&&(m.retryLane=d,$n(n,d),_n(u,n,d,-1))}return Xl(),u=El(Error(e(421))),La(n,i,w,u)}return d.data==="$?"?(i.flags|=128,i.child=n.child,i=Hp.bind(null,n),d._reactRetry=i,null):(n=m.treeContext,nn=ai(d.nextSibling),en=i,ee=!0,yn=null,n!==null&&(cn[un++]=Bn,cn[un++]=Un,cn[un++]=Oi,Bn=n.id,Un=n.overflow,Oi=i),i=Ml(i,u.children),i.flags|=4096,i)}function Ih(n,i,a){n.lanes|=i;var u=n.alternate;u!==null&&(u.lanes|=i),ll(n.return,i,a)}function Ll(n,i,a,u,d){var m=n.memoizedState;m===null?n.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:u,tail:a,tailMode:d}:(m.isBackwards=i,m.rendering=null,m.renderingStartTime=0,m.last=u,m.tail=a,m.tailMode=d)}function Fh(n,i,a){var u=i.pendingProps,d=u.revealOrder,m=u.tail;if(Oe(n,i,u.children,a),u=re.current,(u&2)!==0)u=u&1|2,i.flags|=128;else{if(n!==null&&(n.flags&128)!==0)t:for(n=i.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Ih(n,a,i);else if(n.tag===19)Ih(n,a,i);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===i)break t;for(;n.sibling===null;){if(n.return===null||n.return===i)break t;n=n.return}n.sibling.return=n.return,n=n.sibling}u&=1}if(qt(re,u),(i.mode&1)===0)i.memoizedState=null;else switch(d){case"forwards":for(a=i.child,d=null;a!==null;)n=a.alternate,n!==null&&Ea(n)===null&&(d=a),a=a.sibling;a=d,a===null?(d=i.child,i.child=null):(d=a.sibling,a.sibling=null),Ll(i,!1,d,a,m);break;case"backwards":for(a=null,d=i.child,i.child=null;d!==null;){if(n=d.alternate,n!==null&&Ea(n)===null){i.child=d;break}n=d.sibling,d.sibling=a,a=d,d=n}Ll(i,!0,a,null,m);break;case"together":Ll(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function Na(n,i){(i.mode&1)===0&&n!==null&&(n.alternate=null,i.alternate=null,i.flags|=2)}function Gn(n,i,a){if(n!==null&&(i.dependencies=n.dependencies),Ui|=i.lanes,(a&i.childLanes)===0)return null;if(n!==null&&i.child!==n.child)throw Error(e(153));if(i.child!==null){for(n=i.child,a=vi(n,n.pendingProps),i.child=a,a.return=i;n.sibling!==null;)n=n.sibling,a=a.sibling=vi(n,n.pendingProps),a.return=i;a.sibling=null}return i.child}function Tp(n,i,a){switch(i.tag){case 3:Mh(i),_s();break;case 5:Yu(i);break;case 1:Ve(i.type)&&ga(i);break;case 4:hl(i,i.stateNode.containerInfo);break;case 10:var u=i.type._context,d=i.memoizedProps.value;qt(ba,u._currentValue),u._currentValue=d;break;case 13:if(u=i.memoizedState,u!==null)return u.dehydrated!==null?(qt(re,re.current&1),i.flags|=128,null):(a&i.child.childLanes)!==0?Nh(n,i,a):(qt(re,re.current&1),n=Gn(n,i,a),n!==null?n.sibling:null);qt(re,re.current&1);break;case 19:if(u=(a&i.childLanes)!==0,(n.flags&128)!==0){if(u)return Fh(n,i,a);i.flags|=128}if(d=i.memoizedState,d!==null&&(d.rendering=null,d.tail=null,d.lastEffect=null),qt(re,re.current),u)break;return null;case 22:case 23:return i.lanes=0,Th(n,i,a)}return Gn(n,i,a)}var Dh,Nl,Oh,jh;Dh=function(n,i){for(var a=i.child;a!==null;){if(a.tag===5||a.tag===6)n.appendChild(a.stateNode);else if(a.tag!==4&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return;a=a.return}a.sibling.return=a.return,a=a.sibling}},Nl=function(){},Oh=function(n,i,a,u){var d=n.memoizedProps;if(d!==u){n=i.stateNode,Hi(Tn.current);var m=null;switch(a){case"input":d=xi(n,d),u=xi(n,u),m=[];break;case"select":d=Q({},d,{value:void 0}),u=Q({},u,{value:void 0}),m=[];break;case"textarea":d=es(n,d),u=es(n,u),m=[];break;default:typeof d.onClick!="function"&&typeof u.onClick=="function"&&(n.onclick=da)}Bs(a,u);var w;a=null;for(F in d)if(!u.hasOwnProperty(F)&&d.hasOwnProperty(F)&&d[F]!=null)if(F==="style"){var x=d[F];for(w in x)x.hasOwnProperty(w)&&(a||(a={}),a[w]="")}else F!=="dangerouslySetInnerHTML"&&F!=="children"&&F!=="suppressContentEditableWarning"&&F!=="suppressHydrationWarning"&&F!=="autoFocus"&&(r.hasOwnProperty(F)?m||(m=[]):(m=m||[]).push(F,null));for(F in u){var P=u[F];if(x=d?.[F],u.hasOwnProperty(F)&&P!==x&&(P!=null||x!=null))if(F==="style")if(x){for(w in x)!x.hasOwnProperty(w)||P&&P.hasOwnProperty(w)||(a||(a={}),a[w]="");for(w in P)P.hasOwnProperty(w)&&x[w]!==P[w]&&(a||(a={}),a[w]=P[w])}else a||(m||(m=[]),m.push(F,a)),a=P;else F==="dangerouslySetInnerHTML"?(P=P?P.__html:void 0,x=x?x.__html:void 0,P!=null&&x!==P&&(m=m||[]).push(F,P)):F==="children"?typeof P!="string"&&typeof P!="number"||(m=m||[]).push(F,""+P):F!=="suppressContentEditableWarning"&&F!=="suppressHydrationWarning"&&(r.hasOwnProperty(F)?(P!=null&&F==="onScroll"&&Zt("scroll",n),m||x===P||(m=[])):(m=m||[]).push(F,P))}a&&(m=m||[]).push("style",a);var F=m;(i.updateQueue=F)&&(i.flags|=4)}},jh=function(n,i,a,u){a!==u&&(i.flags|=4)};function yr(n,i){if(!ee)switch(n.tailMode){case"hidden":i=n.tail;for(var a=null;i!==null;)i.alternate!==null&&(a=i),i=i.sibling;a===null?n.tail=null:a.sibling=null;break;case"collapsed":a=n.tail;for(var u=null;a!==null;)a.alternate!==null&&(u=a),a=a.sibling;u===null?i||n.tail===null?n.tail=null:n.tail.sibling=null:u.sibling=null}}function Me(n){var i=n.alternate!==null&&n.alternate.child===n.child,a=0,u=0;if(i)for(var d=n.child;d!==null;)a|=d.lanes|d.childLanes,u|=d.subtreeFlags&14680064,u|=d.flags&14680064,d.return=n,d=d.sibling;else for(d=n.child;d!==null;)a|=d.lanes|d.childLanes,u|=d.subtreeFlags,u|=d.flags,d.return=n,d=d.sibling;return n.subtreeFlags|=u,n.childLanes=a,i}function Pp(n,i,a){var u=i.pendingProps;switch(el(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Me(i),null;case 1:return Ve(i.type)&&pa(),Me(i),null;case 3:return u=i.stateNode,Cs(),Jt($e),Jt(Pe),pl(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(n===null||n.child===null)&&(wa(i)?i.flags|=4:n===null||n.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,yn!==null&&(Vl(yn),yn=null))),Nl(n,i),Me(i),null;case 5:dl(i);var d=Hi(fr.current);if(a=i.type,n!==null&&i.stateNode!=null)Oh(n,i,a,u,d),n.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!u){if(i.stateNode===null)throw Error(e(166));return Me(i),null}if(n=Hi(Tn.current),wa(i)){u=i.stateNode,a=i.type;var m=i.memoizedProps;switch(u[kn]=i,u[lr]=m,n=(i.mode&1)!==0,a){case"dialog":Zt("cancel",u),Zt("close",u);break;case"iframe":case"object":case"embed":Zt("load",u);break;case"video":case"audio":for(d=0;d<rr.length;d++)Zt(rr[d],u);break;case"source":Zt("error",u);break;case"img":case"image":case"link":Zt("error",u),Zt("load",u);break;case"details":Zt("toggle",u);break;case"input":Hr(u,m),Zt("invalid",u);break;case"select":u._wrapperState={wasMultiple:!!m.multiple},Zt("invalid",u);break;case"textarea":Ci(u,m),Zt("invalid",u)}Bs(a,m),d=null;for(var w in m)if(m.hasOwnProperty(w)){var x=m[w];w==="children"?typeof x=="string"?u.textContent!==x&&(m.suppressHydrationWarning!==!0&&ha(u.textContent,x,n),d=["children",x]):typeof x=="number"&&u.textContent!==""+x&&(m.suppressHydrationWarning!==!0&&ha(u.textContent,x,n),d=["children",""+x]):r.hasOwnProperty(w)&&x!=null&&w==="onScroll"&&Zt("scroll",u)}switch(a){case"input":Yt(u),jt(u,m,!0);break;case"textarea":Yt(u),Ti(u);break;case"select":case"option":break;default:typeof m.onClick=="function"&&(u.onclick=da)}u=d,i.updateQueue=u,u!==null&&(i.flags|=4)}else{w=d.nodeType===9?d:d.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=Pi(a)),n==="http://www.w3.org/1999/xhtml"?a==="script"?(n=w.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof u.is=="string"?n=w.createElement(a,{is:u.is}):(n=w.createElement(a),a==="select"&&(w=n,u.multiple?w.multiple=!0:u.size&&(w.size=u.size))):n=w.createElementNS(n,a),n[kn]=i,n[lr]=u,Dh(n,i,!1,!1),i.stateNode=n;t:{switch(w=ln(a,u),a){case"dialog":Zt("cancel",n),Zt("close",n),d=u;break;case"iframe":case"object":case"embed":Zt("load",n),d=u;break;case"video":case"audio":for(d=0;d<rr.length;d++)Zt(rr[d],n);d=u;break;case"source":Zt("error",n),d=u;break;case"img":case"image":case"link":Zt("error",n),Zt("load",n),d=u;break;case"details":Zt("toggle",n),d=u;break;case"input":Hr(n,u),d=xi(n,u),Zt("invalid",n);break;case"option":d=u;break;case"select":n._wrapperState={wasMultiple:!!u.multiple},d=Q({},u,{value:void 0}),Zt("invalid",n);break;case"textarea":Ci(n,u),d=es(n,u),Zt("invalid",n);break;default:d=u}Bs(a,d),x=d;for(m in x)if(x.hasOwnProperty(m)){var P=x[m];m==="style"?Br(n,P):m==="dangerouslySetInnerHTML"?(P=P?P.__html:void 0,P!=null&&Ce(n,P)):m==="children"?typeof P=="string"?(a!=="textarea"||P!=="")&&on(n,P):typeof P=="number"&&on(n,""+P):m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&m!=="autoFocus"&&(r.hasOwnProperty(m)?P!=null&&m==="onScroll"&&Zt("scroll",n):P!=null&&O(n,m,P,w))}switch(a){case"input":Yt(n),jt(n,u,!1);break;case"textarea":Yt(n),Ti(n);break;case"option":u.value!=null&&n.setAttribute("value",""+Et(u.value));break;case"select":n.multiple=!!u.multiple,m=u.value,m!=null?Ee(n,!!u.multiple,m,!1):u.defaultValue!=null&&Ee(n,!!u.multiple,u.defaultValue,!0);break;default:typeof d.onClick=="function"&&(n.onclick=da)}switch(a){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break t;case"img":u=!0;break t;default:u=!1}}u&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return Me(i),null;case 6:if(n&&i.stateNode!=null)jh(n,i,n.memoizedProps,u);else{if(typeof u!="string"&&i.stateNode===null)throw Error(e(166));if(a=Hi(fr.current),Hi(Tn.current),wa(i)){if(u=i.stateNode,a=i.memoizedProps,u[kn]=i,(m=u.nodeValue!==a)&&(n=en,n!==null))switch(n.tag){case 3:ha(u.nodeValue,a,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&ha(u.nodeValue,a,(n.mode&1)!==0)}m&&(i.flags|=4)}else u=(a.nodeType===9?a:a.ownerDocument).createTextNode(u),u[kn]=i,i.stateNode=u}return Me(i),null;case 13:if(Jt(re),u=i.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(ee&&nn!==null&&(i.mode&1)!==0&&(i.flags&128)===0)Bu(),_s(),i.flags|=98560,m=!1;else if(m=wa(i),u!==null&&u.dehydrated!==null){if(n===null){if(!m)throw Error(e(318));if(m=i.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(e(317));m[kn]=i}else _s(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Me(i),m=!1}else yn!==null&&(Vl(yn),yn=null),m=!0;if(!m)return i.flags&65536?i:null}return(i.flags&128)!==0?(i.lanes=a,i):(u=u!==null,u!==(n!==null&&n.memoizedState!==null)&&u&&(i.child.flags|=8192,(i.mode&1)!==0&&(n===null||(re.current&1)!==0?ye===0&&(ye=3):Xl())),i.updateQueue!==null&&(i.flags|=4),Me(i),null);case 4:return Cs(),Nl(n,i),n===null&&ar(i.stateNode.containerInfo),Me(i),null;case 10:return ol(i.type._context),Me(i),null;case 17:return Ve(i.type)&&pa(),Me(i),null;case 19:if(Jt(re),m=i.memoizedState,m===null)return Me(i),null;if(u=(i.flags&128)!==0,w=m.rendering,w===null)if(u)yr(m,!1);else{if(ye!==0||n!==null&&(n.flags&128)!==0)for(n=i.child;n!==null;){if(w=Ea(n),w!==null){for(i.flags|=128,yr(m,!1),u=w.updateQueue,u!==null&&(i.updateQueue=u,i.flags|=4),i.subtreeFlags=0,u=a,a=i.child;a!==null;)m=a,n=u,m.flags&=14680066,w=m.alternate,w===null?(m.childLanes=0,m.lanes=n,m.child=null,m.subtreeFlags=0,m.memoizedProps=null,m.memoizedState=null,m.updateQueue=null,m.dependencies=null,m.stateNode=null):(m.childLanes=w.childLanes,m.lanes=w.lanes,m.child=w.child,m.subtreeFlags=0,m.deletions=null,m.memoizedProps=w.memoizedProps,m.memoizedState=w.memoizedState,m.updateQueue=w.updateQueue,m.type=w.type,n=w.dependencies,m.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),a=a.sibling;return qt(re,re.current&1|2),i.child}n=n.sibling}m.tail!==null&&k()>Rs&&(i.flags|=128,u=!0,yr(m,!1),i.lanes=4194304)}else{if(!u)if(n=Ea(w),n!==null){if(i.flags|=128,u=!0,a=n.updateQueue,a!==null&&(i.updateQueue=a,i.flags|=4),yr(m,!0),m.tail===null&&m.tailMode==="hidden"&&!w.alternate&&!ee)return Me(i),null}else 2*k()-m.renderingStartTime>Rs&&a!==1073741824&&(i.flags|=128,u=!0,yr(m,!1),i.lanes=4194304);m.isBackwards?(w.sibling=i.child,i.child=w):(a=m.last,a!==null?a.sibling=w:i.child=w,m.last=w)}return m.tail!==null?(i=m.tail,m.rendering=i,m.tail=i.sibling,m.renderingStartTime=k(),i.sibling=null,a=re.current,qt(re,u?a&1|2:a&1),i):(Me(i),null);case 22:case 23:return Wl(),u=i.memoizedState!==null,n!==null&&n.memoizedState!==null!==u&&(i.flags|=8192),u&&(i.mode&1)!==0?(sn&1073741824)!==0&&(Me(i),i.subtreeFlags&6&&(i.flags|=8192)):Me(i),null;case 24:return null;case 25:return null}throw Error(e(156,i.tag))}function Rp(n,i){switch(el(i),i.tag){case 1:return Ve(i.type)&&pa(),n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 3:return Cs(),Jt($e),Jt(Pe),pl(),n=i.flags,(n&65536)!==0&&(n&128)===0?(i.flags=n&-65537|128,i):null;case 5:return dl(i),null;case 13:if(Jt(re),n=i.memoizedState,n!==null&&n.dehydrated!==null){if(i.alternate===null)throw Error(e(340));_s()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 19:return Jt(re),null;case 4:return Cs(),null;case 10:return ol(i.type._context),null;case 22:case 23:return Wl(),null;case 24:return null;default:return null}}var Ia=!1,Le=!1,Mp=typeof WeakSet=="function"?WeakSet:Set,st=null;function Ts(n,i){var a=n.ref;if(a!==null)if(typeof a=="function")try{a(null)}catch(u){oe(n,i,u)}else a.current=null}function Il(n,i,a){try{a()}catch(u){oe(n,i,u)}}var zh=!1;function Lp(n,i){if(Wo=ta,n=vu(),jo(n)){if("selectionStart"in n)var a={start:n.selectionStart,end:n.selectionEnd};else t:{a=(a=n.ownerDocument)&&a.defaultView||window;var u=a.getSelection&&a.getSelection();if(u&&u.rangeCount!==0){a=u.anchorNode;var d=u.anchorOffset,m=u.focusNode;u=u.focusOffset;try{a.nodeType,m.nodeType}catch{a=null;break t}var w=0,x=-1,P=-1,F=0,$=0,G=n,U=null;e:for(;;){for(var et;G!==a||d!==0&&G.nodeType!==3||(x=w+d),G!==m||u!==0&&G.nodeType!==3||(P=w+u),G.nodeType===3&&(w+=G.nodeValue.length),(et=G.firstChild)!==null;)U=G,G=et;for(;;){if(G===n)break e;if(U===a&&++F===d&&(x=w),U===m&&++$===u&&(P=w),(et=G.nextSibling)!==null)break;G=U,U=G.parentNode}G=et}a=x===-1||P===-1?null:{start:x,end:P}}else a=null}a=a||{start:0,end:0}}else a=null;for(Xo={focusedElem:n,selectionRange:a},ta=!1,st=i;st!==null;)if(i=st,n=i.child,(i.subtreeFlags&1028)!==0&&n!==null)n.return=i,st=n;else for(;st!==null;){i=st;try{var ot=i.alternate;if((i.flags&1024)!==0)switch(i.tag){case 0:case 11:case 15:break;case 1:if(ot!==null){var lt=ot.memoizedProps,ue=ot.memoizedState,L=i.stateNode,R=L.getSnapshotBeforeUpdate(i.elementType===i.type?lt:wn(i.type,lt),ue);L.__reactInternalSnapshotBeforeUpdate=R}break;case 3:var N=i.stateNode.containerInfo;N.nodeType===1?N.textContent="":N.nodeType===9&&N.documentElement&&N.removeChild(N.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(e(163))}}catch(K){oe(i,i.return,K)}if(n=i.sibling,n!==null){n.return=i.return,st=n;break}st=i.return}return ot=zh,zh=!1,ot}function wr(n,i,a){var u=i.updateQueue;if(u=u!==null?u.lastEffect:null,u!==null){var d=u=u.next;do{if((d.tag&n)===n){var m=d.destroy;d.destroy=void 0,m!==void 0&&Il(i,a,m)}d=d.next}while(d!==u)}}function Fa(n,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var a=i=i.next;do{if((a.tag&n)===n){var u=a.create;a.destroy=u()}a=a.next}while(a!==i)}}function Fl(n){var i=n.ref;if(i!==null){var a=n.stateNode;n.tag,n=a,typeof i=="function"?i(n):i.current=n}}function Hh(n){var i=n.alternate;i!==null&&(n.alternate=null,Hh(i)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(i=n.stateNode,i!==null&&(delete i[kn],delete i[lr],delete i[Qo],delete i[pp],delete i[gp])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function Bh(n){return n.tag===5||n.tag===3||n.tag===4}function Uh(n){t:for(;;){for(;n.sibling===null;){if(n.return===null||Bh(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue t;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Dl(n,i,a){var u=n.tag;if(u===5||u===6)n=n.stateNode,i?a.nodeType===8?a.parentNode.insertBefore(n,i):a.insertBefore(n,i):(a.nodeType===8?(i=a.parentNode,i.insertBefore(n,a)):(i=a,i.appendChild(n)),a=a._reactRootContainer,a!=null||i.onclick!==null||(i.onclick=da));else if(u!==4&&(n=n.child,n!==null))for(Dl(n,i,a),n=n.sibling;n!==null;)Dl(n,i,a),n=n.sibling}function Ol(n,i,a){var u=n.tag;if(u===5||u===6)n=n.stateNode,i?a.insertBefore(n,i):a.appendChild(n);else if(u!==4&&(n=n.child,n!==null))for(Ol(n,i,a),n=n.sibling;n!==null;)Ol(n,i,a),n=n.sibling}var ke=null,An=!1;function di(n,i,a){for(a=a.child;a!==null;)$h(n,i,a),a=a.sibling}function $h(n,i,a){if(yt&&typeof yt.onCommitFiberUnmount=="function")try{yt.onCommitFiberUnmount(ct,a)}catch{}switch(a.tag){case 5:Le||Ts(a,i);case 6:var u=ke,d=An;ke=null,di(n,i,a),ke=u,An=d,ke!==null&&(An?(n=ke,a=a.stateNode,n.nodeType===8?n.parentNode.removeChild(a):n.removeChild(a)):ke.removeChild(a.stateNode));break;case 18:ke!==null&&(An?(n=ke,a=a.stateNode,n.nodeType===8?Ko(n.parentNode,a):n.nodeType===1&&Ko(n,a),Qs(n)):Ko(ke,a.stateNode));break;case 4:u=ke,d=An,ke=a.stateNode.containerInfo,An=!0,di(n,i,a),ke=u,An=d;break;case 0:case 11:case 14:case 15:if(!Le&&(u=a.updateQueue,u!==null&&(u=u.lastEffect,u!==null))){d=u=u.next;do{var m=d,w=m.destroy;m=m.tag,w!==void 0&&((m&2)!==0||(m&4)!==0)&&Il(a,i,w),d=d.next}while(d!==u)}di(n,i,a);break;case 1:if(!Le&&(Ts(a,i),u=a.stateNode,typeof u.componentWillUnmount=="function"))try{u.props=a.memoizedProps,u.state=a.memoizedState,u.componentWillUnmount()}catch(x){oe(a,i,x)}di(n,i,a);break;case 21:di(n,i,a);break;case 22:a.mode&1?(Le=(u=Le)||a.memoizedState!==null,di(n,i,a),Le=u):di(n,i,a);break;default:di(n,i,a)}}function Vh(n){var i=n.updateQueue;if(i!==null){n.updateQueue=null;var a=n.stateNode;a===null&&(a=n.stateNode=new Mp),i.forEach(function(u){var d=Bp.bind(null,n,u);a.has(u)||(a.add(u),u.then(d,d))})}}function bn(n,i){var a=i.deletions;if(a!==null)for(var u=0;u<a.length;u++){var d=a[u];try{var m=n,w=i,x=w;t:for(;x!==null;){switch(x.tag){case 5:ke=x.stateNode,An=!1;break t;case 3:ke=x.stateNode.containerInfo,An=!0;break t;case 4:ke=x.stateNode.containerInfo,An=!0;break t}x=x.return}if(ke===null)throw Error(e(160));$h(m,w,d),ke=null,An=!1;var P=d.alternate;P!==null&&(P.return=null),d.return=null}catch(F){oe(d,i,F)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)Gh(i,n),i=i.sibling}function Gh(n,i){var a=n.alternate,u=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(bn(i,n),Rn(n),u&4){try{wr(3,n,n.return),Fa(3,n)}catch(lt){oe(n,n.return,lt)}try{wr(5,n,n.return)}catch(lt){oe(n,n.return,lt)}}break;case 1:bn(i,n),Rn(n),u&512&&a!==null&&Ts(a,a.return);break;case 5:if(bn(i,n),Rn(n),u&512&&a!==null&&Ts(a,a.return),n.flags&32){var d=n.stateNode;try{on(d,"")}catch(lt){oe(n,n.return,lt)}}if(u&4&&(d=n.stateNode,d!=null)){var m=n.memoizedProps,w=a!==null?a.memoizedProps:m,x=n.type,P=n.updateQueue;if(n.updateQueue=null,P!==null)try{x==="input"&&m.type==="radio"&&m.name!=null&&Hs(d,m),ln(x,w);var F=ln(x,m);for(w=0;w<P.length;w+=2){var $=P[w],G=P[w+1];$==="style"?Br(d,G):$==="dangerouslySetInnerHTML"?Ce(d,G):$==="children"?on(d,G):O(d,$,G,F)}switch(x){case"input":ts(d,m);break;case"textarea":ki(d,m);break;case"select":var U=d._wrapperState.wasMultiple;d._wrapperState.wasMultiple=!!m.multiple;var et=m.value;et!=null?Ee(d,!!m.multiple,et,!1):U!==!!m.multiple&&(m.defaultValue!=null?Ee(d,!!m.multiple,m.defaultValue,!0):Ee(d,!!m.multiple,m.multiple?[]:"",!1))}d[lr]=m}catch(lt){oe(n,n.return,lt)}}break;case 6:if(bn(i,n),Rn(n),u&4){if(n.stateNode===null)throw Error(e(162));d=n.stateNode,m=n.memoizedProps;try{d.nodeValue=m}catch(lt){oe(n,n.return,lt)}}break;case 3:if(bn(i,n),Rn(n),u&4&&a!==null&&a.memoizedState.isDehydrated)try{Qs(i.containerInfo)}catch(lt){oe(n,n.return,lt)}break;case 4:bn(i,n),Rn(n);break;case 13:bn(i,n),Rn(n),d=n.child,d.flags&8192&&(m=d.memoizedState!==null,d.stateNode.isHidden=m,!m||d.alternate!==null&&d.alternate.memoizedState!==null||(Hl=k())),u&4&&Vh(n);break;case 22:if($=a!==null&&a.memoizedState!==null,n.mode&1?(Le=(F=Le)||$,bn(i,n),Le=F):bn(i,n),Rn(n),u&8192){if(F=n.memoizedState!==null,(n.stateNode.isHidden=F)&&!$&&(n.mode&1)!==0)for(st=n,$=n.child;$!==null;){for(G=st=$;st!==null;){switch(U=st,et=U.child,U.tag){case 0:case 11:case 14:case 15:wr(4,U,U.return);break;case 1:Ts(U,U.return);var ot=U.stateNode;if(typeof ot.componentWillUnmount=="function"){u=U,a=U.return;try{i=u,ot.props=i.memoizedProps,ot.state=i.memoizedState,ot.componentWillUnmount()}catch(lt){oe(u,a,lt)}}break;case 5:Ts(U,U.return);break;case 22:if(U.memoizedState!==null){qh(G);continue}}et!==null?(et.return=U,st=et):qh(G)}$=$.sibling}t:for($=null,G=n;;){if(G.tag===5){if($===null){$=G;try{d=G.stateNode,F?(m=d.style,typeof m.setProperty=="function"?m.setProperty("display","none","important"):m.display="none"):(x=G.stateNode,P=G.memoizedProps.style,w=P!=null&&P.hasOwnProperty("display")?P.display:null,x.style.display=ns("display",w))}catch(lt){oe(n,n.return,lt)}}}else if(G.tag===6){if($===null)try{G.stateNode.nodeValue=F?"":G.memoizedProps}catch(lt){oe(n,n.return,lt)}}else if((G.tag!==22&&G.tag!==23||G.memoizedState===null||G===n)&&G.child!==null){G.child.return=G,G=G.child;continue}if(G===n)break t;for(;G.sibling===null;){if(G.return===null||G.return===n)break t;$===G&&($=null),G=G.return}$===G&&($=null),G.sibling.return=G.return,G=G.sibling}}break;case 19:bn(i,n),Rn(n),u&4&&Vh(n);break;case 21:break;default:bn(i,n),Rn(n)}}function Rn(n){var i=n.flags;if(i&2){try{t:{for(var a=n.return;a!==null;){if(Bh(a)){var u=a;break t}a=a.return}throw Error(e(160))}switch(u.tag){case 5:var d=u.stateNode;u.flags&32&&(on(d,""),u.flags&=-33);var m=Uh(n);Ol(n,m,d);break;case 3:case 4:var w=u.stateNode.containerInfo,x=Uh(n);Dl(n,x,w);break;default:throw Error(e(161))}}catch(P){oe(n,n.return,P)}n.flags&=-3}i&4096&&(n.flags&=-4097)}function Np(n,i,a){st=n,Wh(n)}function Wh(n,i,a){for(var u=(n.mode&1)!==0;st!==null;){var d=st,m=d.child;if(d.tag===22&&u){var w=d.memoizedState!==null||Ia;if(!w){var x=d.alternate,P=x!==null&&x.memoizedState!==null||Le;x=Ia;var F=Le;if(Ia=w,(Le=P)&&!F)for(st=d;st!==null;)w=st,P=w.child,w.tag===22&&w.memoizedState!==null?Yh(d):P!==null?(P.return=w,st=P):Yh(d);for(;m!==null;)st=m,Wh(m),m=m.sibling;st=d,Ia=x,Le=F}Xh(n)}else(d.subtreeFlags&8772)!==0&&m!==null?(m.return=d,st=m):Xh(n)}}function Xh(n){for(;st!==null;){var i=st;if((i.flags&8772)!==0){var a=i.alternate;try{if((i.flags&8772)!==0)switch(i.tag){case 0:case 11:case 15:Le||Fa(5,i);break;case 1:var u=i.stateNode;if(i.flags&4&&!Le)if(a===null)u.componentDidMount();else{var d=i.elementType===i.type?a.memoizedProps:wn(i.type,a.memoizedProps);u.componentDidUpdate(d,a.memoizedState,u.__reactInternalSnapshotBeforeUpdate)}var m=i.updateQueue;m!==null&&qu(i,m,u);break;case 3:var w=i.updateQueue;if(w!==null){if(a=null,i.child!==null)switch(i.child.tag){case 5:a=i.child.stateNode;break;case 1:a=i.child.stateNode}qu(i,w,a)}break;case 5:var x=i.stateNode;if(a===null&&i.flags&4){a=x;var P=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":P.autoFocus&&a.focus();break;case"img":P.src&&(a.src=P.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var F=i.alternate;if(F!==null){var $=F.memoizedState;if($!==null){var G=$.dehydrated;G!==null&&Qs(G)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(e(163))}Le||i.flags&512&&Fl(i)}catch(U){oe(i,i.return,U)}}if(i===n){st=null;break}if(a=i.sibling,a!==null){a.return=i.return,st=a;break}st=i.return}}function qh(n){for(;st!==null;){var i=st;if(i===n){st=null;break}var a=i.sibling;if(a!==null){a.return=i.return,st=a;break}st=i.return}}function Yh(n){for(;st!==null;){var i=st;try{switch(i.tag){case 0:case 11:case 15:var a=i.return;try{Fa(4,i)}catch(P){oe(i,a,P)}break;case 1:var u=i.stateNode;if(typeof u.componentDidMount=="function"){var d=i.return;try{u.componentDidMount()}catch(P){oe(i,d,P)}}var m=i.return;try{Fl(i)}catch(P){oe(i,m,P)}break;case 5:var w=i.return;try{Fl(i)}catch(P){oe(i,w,P)}}}catch(P){oe(i,i.return,P)}if(i===n){st=null;break}var x=i.sibling;if(x!==null){x.return=i.return,st=x;break}st=i.return}}var Ip=Math.ceil,Da=j.ReactCurrentDispatcher,jl=j.ReactCurrentOwner,fn=j.ReactCurrentBatchConfig,Bt=0,Se=null,pe=null,Te=0,sn=0,Ps=oi(0),ye=0,Ar=null,Ui=0,Oa=0,zl=0,br=null,We=null,Hl=0,Rs=1/0,Wn=null,ja=!1,Bl=null,fi=null,za=!1,pi=null,Ha=0,_r=0,Ul=null,Ba=-1,Ua=0;function je(){return(Bt&6)!==0?k():Ba!==-1?Ba:Ba=k()}function gi(n){return(n.mode&1)===0?1:(Bt&2)!==0&&Te!==0?Te&-Te:vp.transition!==null?(Ua===0&&(Ua=Ws()),Ua):(n=Gt,n!==0||(n=window.event,n=n===void 0?16:Qc(n.type)),n)}function _n(n,i,a,u){if(50<_r)throw _r=0,Ul=null,Error(e(185));Jn(n,a,u),((Bt&2)===0||n!==Se)&&(n===Se&&((Bt&2)===0&&(Oa|=a),ye===4&&mi(n,Te)),Xe(n,u),a===1&&Bt===0&&(i.mode&1)===0&&(Rs=k()+500,ma&&ci()))}function Xe(n,i){var a=n.callbackNode;De(n,i);var u=jn(n,n===Se?Te:0);if(u===0)a!==null&&Kr(a),n.callbackNode=null,n.callbackPriority=0;else if(i=u&-u,n.callbackPriority!==i){if(a!=null&&Kr(a),i===1)n.tag===0?mp(Qh.bind(null,n)):Du(Qh.bind(null,n)),dp(function(){(Bt&6)===0&&ci()}),a=null;else{switch($c(u)){case 1:a=B;break;case 4:a=tt;break;case 16:a=kt;break;case 536870912:a=It;break;default:a=kt}a=rd(a,Kh.bind(null,n))}n.callbackPriority=i,n.callbackNode=a}}function Kh(n,i){if(Ba=-1,Ua=0,(Bt&6)!==0)throw Error(e(327));var a=n.callbackNode;if(Ms()&&n.callbackNode!==a)return null;var u=jn(n,n===Se?Te:0);if(u===0)return null;if((u&30)!==0||(u&n.expiredLanes)!==0||i)i=$a(n,u);else{i=u;var d=Bt;Bt|=2;var m=Jh();(Se!==n||Te!==i)&&(Wn=null,Rs=k()+500,Vi(n,i));do try{Op();break}catch(x){Zh(n,x)}while(!0);al(),Da.current=m,Bt=d,pe!==null?i=0:(Se=null,Te=0,i=ye)}if(i!==0){if(i===2&&(d=os(n),d!==0&&(u=d,i=$l(n,d))),i===1)throw a=Ar,Vi(n,0),mi(n,u),Xe(n,k()),a;if(i===6)mi(n,u);else{if(d=n.current.alternate,(u&30)===0&&!Fp(d)&&(i=$a(n,u),i===2&&(m=os(n),m!==0&&(u=m,i=$l(n,m))),i===1))throw a=Ar,Vi(n,0),mi(n,u),Xe(n,k()),a;switch(n.finishedWork=d,n.finishedLanes=u,i){case 0:case 1:throw Error(e(345));case 2:Gi(n,We,Wn);break;case 3:if(mi(n,u),(u&130023424)===u&&(i=Hl+500-k(),10<i)){if(jn(n,0)!==0)break;if(d=n.suspendedLanes,(d&u)!==u){je(),n.pingedLanes|=n.suspendedLanes&d;break}n.timeoutHandle=Yo(Gi.bind(null,n,We,Wn),i);break}Gi(n,We,Wn);break;case 4:if(mi(n,u),(u&4194240)===u)break;for(i=n.eventTimes,d=-1;0<u;){var w=31-Vt(u);m=1<<w,w=i[w],w>d&&(d=w),u&=~m}if(u=d,u=k()-u,u=(120>u?120:480>u?480:1080>u?1080:1920>u?1920:3e3>u?3e3:4320>u?4320:1960*Ip(u/1960))-u,10<u){n.timeoutHandle=Yo(Gi.bind(null,n,We,Wn),u);break}Gi(n,We,Wn);break;case 5:Gi(n,We,Wn);break;default:throw Error(e(329))}}}return Xe(n,k()),n.callbackNode===a?Kh.bind(null,n):null}function $l(n,i){var a=br;return n.current.memoizedState.isDehydrated&&(Vi(n,i).flags|=256),n=$a(n,i),n!==2&&(i=We,We=a,i!==null&&Vl(i)),n}function Vl(n){We===null?We=n:We.push.apply(We,n)}function Fp(n){for(var i=n;;){if(i.flags&16384){var a=i.updateQueue;if(a!==null&&(a=a.stores,a!==null))for(var u=0;u<a.length;u++){var d=a[u],m=d.getSnapshot;d=d.value;try{if(!vn(m(),d))return!1}catch{return!1}}}if(a=i.child,i.subtreeFlags&16384&&a!==null)a.return=i,i=a;else{if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function mi(n,i){for(i&=~zl,i&=~Oa,n.suspendedLanes|=i,n.pingedLanes&=~i,n=n.expirationTimes;0<i;){var a=31-Vt(i),u=1<<a;n[a]=-1,i&=~u}}function Qh(n){if((Bt&6)!==0)throw Error(e(327));Ms();var i=jn(n,0);if((i&1)===0)return Xe(n,k()),null;var a=$a(n,i);if(n.tag!==0&&a===2){var u=os(n);u!==0&&(i=u,a=$l(n,u))}if(a===1)throw a=Ar,Vi(n,0),mi(n,i),Xe(n,k()),a;if(a===6)throw Error(e(345));return n.finishedWork=n.current.alternate,n.finishedLanes=i,Gi(n,We,Wn),Xe(n,k()),null}function Gl(n,i){var a=Bt;Bt|=1;try{return n(i)}finally{Bt=a,Bt===0&&(Rs=k()+500,ma&&ci())}}function $i(n){pi!==null&&pi.tag===0&&(Bt&6)===0&&Ms();var i=Bt;Bt|=1;var a=fn.transition,u=Gt;try{if(fn.transition=null,Gt=1,n)return n()}finally{Gt=u,fn.transition=a,Bt=i,(Bt&6)===0&&ci()}}function Wl(){sn=Ps.current,Jt(Ps)}function Vi(n,i){n.finishedWork=null,n.finishedLanes=0;var a=n.timeoutHandle;if(a!==-1&&(n.timeoutHandle=-1,hp(a)),pe!==null)for(a=pe.return;a!==null;){var u=a;switch(el(u),u.tag){case 1:u=u.type.childContextTypes,u!=null&&pa();break;case 3:Cs(),Jt($e),Jt(Pe),pl();break;case 5:dl(u);break;case 4:Cs();break;case 13:Jt(re);break;case 19:Jt(re);break;case 10:ol(u.type._context);break;case 22:case 23:Wl()}a=a.return}if(Se=n,pe=n=vi(n.current,null),Te=sn=i,ye=0,Ar=null,zl=Oa=Ui=0,We=br=null,zi!==null){for(i=0;i<zi.length;i++)if(a=zi[i],u=a.interleaved,u!==null){a.interleaved=null;var d=u.next,m=a.pending;if(m!==null){var w=m.next;m.next=d,u.next=w}a.pending=u}zi=null}return n}function Zh(n,i){do{var a=pe;try{if(al(),Ca.current=Ra,ka){for(var u=ae.memoizedState;u!==null;){var d=u.queue;d!==null&&(d.pending=null),u=u.next}ka=!1}if(Bi=0,_e=ve=ae=null,pr=!1,gr=0,jl.current=null,a===null||a.return===null){ye=1,Ar=i,pe=null;break}t:{var m=n,w=a.return,x=a,P=i;if(i=Te,x.flags|=32768,P!==null&&typeof P=="object"&&typeof P.then=="function"){var F=P,$=x,G=$.tag;if(($.mode&1)===0&&(G===0||G===11||G===15)){var U=$.alternate;U?($.updateQueue=U.updateQueue,$.memoizedState=U.memoizedState,$.lanes=U.lanes):($.updateQueue=null,$.memoizedState=null)}var et=Sh(w);if(et!==null){et.flags&=-257,xh(et,w,x,m,i),et.mode&1&&_h(m,F,i),i=et,P=F;var ot=i.updateQueue;if(ot===null){var lt=new Set;lt.add(P),i.updateQueue=lt}else ot.add(P);break t}else{if((i&1)===0){_h(m,F,i),Xl();break t}P=Error(e(426))}}else if(ee&&x.mode&1){var ue=Sh(w);if(ue!==null){(ue.flags&65536)===0&&(ue.flags|=256),xh(ue,w,x,m,i),sl(ks(P,x));break t}}m=P=ks(P,x),ye!==4&&(ye=2),br===null?br=[m]:br.push(m),m=w;do{switch(m.tag){case 3:m.flags|=65536,i&=-i,m.lanes|=i;var L=Ah(m,P,i);Xu(m,L);break t;case 1:x=P;var R=m.type,N=m.stateNode;if((m.flags&128)===0&&(typeof R.getDerivedStateFromError=="function"||N!==null&&typeof N.componentDidCatch=="function"&&(fi===null||!fi.has(N)))){m.flags|=65536,i&=-i,m.lanes|=i;var K=bh(m,x,i);Xu(m,K);break t}}m=m.return}while(m!==null)}ed(a)}catch(ut){i=ut,pe===a&&a!==null&&(pe=a=a.return);continue}break}while(!0)}function Jh(){var n=Da.current;return Da.current=Ra,n===null?Ra:n}function Xl(){(ye===0||ye===3||ye===2)&&(ye=4),Se===null||(Ui&268435455)===0&&(Oa&268435455)===0||mi(Se,Te)}function $a(n,i){var a=Bt;Bt|=2;var u=Jh();(Se!==n||Te!==i)&&(Wn=null,Vi(n,i));do try{Dp();break}catch(d){Zh(n,d)}while(!0);if(al(),Bt=a,Da.current=u,pe!==null)throw Error(e(261));return Se=null,Te=0,ye}function Dp(){for(;pe!==null;)td(pe)}function Op(){for(;pe!==null&&!xo();)td(pe)}function td(n){var i=sd(n.alternate,n,sn);n.memoizedProps=n.pendingProps,i===null?ed(n):pe=i,jl.current=null}function ed(n){var i=n;do{var a=i.alternate;if(n=i.return,(i.flags&32768)===0){if(a=Pp(a,i,sn),a!==null){pe=a;return}}else{if(a=Rp(a,i),a!==null){a.flags&=32767,pe=a;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{ye=6,pe=null;return}}if(i=i.sibling,i!==null){pe=i;return}pe=i=n}while(i!==null);ye===0&&(ye=5)}function Gi(n,i,a){var u=Gt,d=fn.transition;try{fn.transition=null,Gt=1,jp(n,i,a,u)}finally{fn.transition=d,Gt=u}return null}function jp(n,i,a,u){do Ms();while(pi!==null);if((Bt&6)!==0)throw Error(e(327));a=n.finishedWork;var d=n.finishedLanes;if(a===null)return null;if(n.finishedWork=null,n.finishedLanes=0,a===n.current)throw Error(e(177));n.callbackNode=null,n.callbackPriority=0;var m=a.lanes|a.childLanes;if(Qr(n,m),n===Se&&(pe=Se=null,Te=0),(a.subtreeFlags&2064)===0&&(a.flags&2064)===0||za||(za=!0,rd(kt,function(){return Ms(),null})),m=(a.flags&15990)!==0,(a.subtreeFlags&15990)!==0||m){m=fn.transition,fn.transition=null;var w=Gt;Gt=1;var x=Bt;Bt|=4,jl.current=null,Lp(n,a),Gh(a,n),sp(Xo),ta=!!Wo,Xo=Wo=null,n.current=a,Np(a),_(),Bt=x,Gt=w,fn.transition=m}else n.current=a;if(za&&(za=!1,pi=n,Ha=d),m=n.pendingLanes,m===0&&(fi=null),Ht(a.stateNode),Xe(n,k()),i!==null)for(u=n.onRecoverableError,a=0;a<i.length;a++)d=i[a],u(d.value,{componentStack:d.stack,digest:d.digest});if(ja)throw ja=!1,n=Bl,Bl=null,n;return(Ha&1)!==0&&n.tag!==0&&Ms(),m=n.pendingLanes,(m&1)!==0?n===Ul?_r++:(_r=0,Ul=n):_r=0,ci(),null}function Ms(){if(pi!==null){var n=$c(Ha),i=fn.transition,a=Gt;try{if(fn.transition=null,Gt=16>n?16:n,pi===null)var u=!1;else{if(n=pi,pi=null,Ha=0,(Bt&6)!==0)throw Error(e(331));var d=Bt;for(Bt|=4,st=n.current;st!==null;){var m=st,w=m.child;if((st.flags&16)!==0){var x=m.deletions;if(x!==null){for(var P=0;P<x.length;P++){var F=x[P];for(st=F;st!==null;){var $=st;switch($.tag){case 0:case 11:case 15:wr(8,$,m)}var G=$.child;if(G!==null)G.return=$,st=G;else for(;st!==null;){$=st;var U=$.sibling,et=$.return;if(Hh($),$===F){st=null;break}if(U!==null){U.return=et,st=U;break}st=et}}}var ot=m.alternate;if(ot!==null){var lt=ot.child;if(lt!==null){ot.child=null;do{var ue=lt.sibling;lt.sibling=null,lt=ue}while(lt!==null)}}st=m}}if((m.subtreeFlags&2064)!==0&&w!==null)w.return=m,st=w;else t:for(;st!==null;){if(m=st,(m.flags&2048)!==0)switch(m.tag){case 0:case 11:case 15:wr(9,m,m.return)}var L=m.sibling;if(L!==null){L.return=m.return,st=L;break t}st=m.return}}var R=n.current;for(st=R;st!==null;){w=st;var N=w.child;if((w.subtreeFlags&2064)!==0&&N!==null)N.return=w,st=N;else t:for(w=R;st!==null;){if(x=st,(x.flags&2048)!==0)try{switch(x.tag){case 0:case 11:case 15:Fa(9,x)}}catch(ut){oe(x,x.return,ut)}if(x===w){st=null;break t}var K=x.sibling;if(K!==null){K.return=x.return,st=K;break t}st=x.return}}if(Bt=d,ci(),yt&&typeof yt.onPostCommitFiberRoot=="function")try{yt.onPostCommitFiberRoot(ct,n)}catch{}u=!0}return u}finally{Gt=a,fn.transition=i}}return!1}function nd(n,i,a){i=ks(a,i),i=Ah(n,i,1),n=hi(n,i,1),i=je(),n!==null&&(Jn(n,1,i),Xe(n,i))}function oe(n,i,a){if(n.tag===3)nd(n,n,a);else for(;i!==null;){if(i.tag===3){nd(i,n,a);break}else if(i.tag===1){var u=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(fi===null||!fi.has(u))){n=ks(a,n),n=bh(i,n,1),i=hi(i,n,1),n=je(),i!==null&&(Jn(i,1,n),Xe(i,n));break}}i=i.return}}function zp(n,i,a){var u=n.pingCache;u!==null&&u.delete(i),i=je(),n.pingedLanes|=n.suspendedLanes&a,Se===n&&(Te&a)===a&&(ye===4||ye===3&&(Te&130023424)===Te&&500>k()-Hl?Vi(n,0):zl|=a),Xe(n,i)}function id(n,i){i===0&&((n.mode&1)===0?i=1:(i=be,be<<=1,(be&130023424)===0&&(be=4194304)));var a=je();n=$n(n,i),n!==null&&(Jn(n,i,a),Xe(n,a))}function Hp(n){var i=n.memoizedState,a=0;i!==null&&(a=i.retryLane),id(n,a)}function Bp(n,i){var a=0;switch(n.tag){case 13:var u=n.stateNode,d=n.memoizedState;d!==null&&(a=d.retryLane);break;case 19:u=n.stateNode;break;default:throw Error(e(314))}u!==null&&u.delete(i),id(n,a)}var sd;sd=function(n,i,a){if(n!==null)if(n.memoizedProps!==i.pendingProps||$e.current)Ge=!0;else{if((n.lanes&a)===0&&(i.flags&128)===0)return Ge=!1,Tp(n,i,a);Ge=(n.flags&131072)!==0}else Ge=!1,ee&&(i.flags&1048576)!==0&&Ou(i,ya,i.index);switch(i.lanes=0,i.tag){case 2:var u=i.type;Na(n,i),n=i.pendingProps;var d=ws(i,Pe.current);Es(i,a),d=vl(null,i,u,n,d,a);var m=yl();return i.flags|=1,typeof d=="object"&&d!==null&&typeof d.render=="function"&&d.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,Ve(u)?(m=!0,ga(i)):m=!1,i.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,ul(i),d.updater=Ma,i.stateNode=d,d._reactInternals=i,xl(i,u,n,a),i=Tl(null,i,u,!0,m,a)):(i.tag=0,ee&&m&&tl(i),Oe(null,i,d,a),i=i.child),i;case 16:u=i.elementType;t:{switch(Na(n,i),n=i.pendingProps,d=u._init,u=d(u._payload),i.type=u,d=i.tag=$p(u),n=wn(u,n),d){case 0:i=kl(null,i,u,n,a);break t;case 1:i=Rh(null,i,u,n,a);break t;case 11:i=Eh(null,i,u,n,a);break t;case 14:i=Ch(null,i,u,wn(u.type,n),a);break t}throw Error(e(306,u,""))}return i;case 0:return u=i.type,d=i.pendingProps,d=i.elementType===u?d:wn(u,d),kl(n,i,u,d,a);case 1:return u=i.type,d=i.pendingProps,d=i.elementType===u?d:wn(u,d),Rh(n,i,u,d,a);case 3:t:{if(Mh(i),n===null)throw Error(e(387));u=i.pendingProps,m=i.memoizedState,d=m.element,Wu(n,i),xa(i,u,null,a);var w=i.memoizedState;if(u=w.element,m.isDehydrated)if(m={element:u,isDehydrated:!1,cache:w.cache,pendingSuspenseBoundaries:w.pendingSuspenseBoundaries,transitions:w.transitions},i.updateQueue.baseState=m,i.memoizedState=m,i.flags&256){d=ks(Error(e(423)),i),i=Lh(n,i,u,a,d);break t}else if(u!==d){d=ks(Error(e(424)),i),i=Lh(n,i,u,a,d);break t}else for(nn=ai(i.stateNode.containerInfo.firstChild),en=i,ee=!0,yn=null,a=Vu(i,null,u,a),i.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling;else{if(_s(),u===d){i=Gn(n,i,a);break t}Oe(n,i,u,a)}i=i.child}return i;case 5:return Yu(i),n===null&&il(i),u=i.type,d=i.pendingProps,m=n!==null?n.memoizedProps:null,w=d.children,qo(u,d)?w=null:m!==null&&qo(u,m)&&(i.flags|=32),Ph(n,i),Oe(n,i,w,a),i.child;case 6:return n===null&&il(i),null;case 13:return Nh(n,i,a);case 4:return hl(i,i.stateNode.containerInfo),u=i.pendingProps,n===null?i.child=Ss(i,null,u,a):Oe(n,i,u,a),i.child;case 11:return u=i.type,d=i.pendingProps,d=i.elementType===u?d:wn(u,d),Eh(n,i,u,d,a);case 7:return Oe(n,i,i.pendingProps,a),i.child;case 8:return Oe(n,i,i.pendingProps.children,a),i.child;case 12:return Oe(n,i,i.pendingProps.children,a),i.child;case 10:t:{if(u=i.type._context,d=i.pendingProps,m=i.memoizedProps,w=d.value,qt(ba,u._currentValue),u._currentValue=w,m!==null)if(vn(m.value,w)){if(m.children===d.children&&!$e.current){i=Gn(n,i,a);break t}}else for(m=i.child,m!==null&&(m.return=i);m!==null;){var x=m.dependencies;if(x!==null){w=m.child;for(var P=x.firstContext;P!==null;){if(P.context===u){if(m.tag===1){P=Vn(-1,a&-a),P.tag=2;var F=m.updateQueue;if(F!==null){F=F.shared;var $=F.pending;$===null?P.next=P:(P.next=$.next,$.next=P),F.pending=P}}m.lanes|=a,P=m.alternate,P!==null&&(P.lanes|=a),ll(m.return,a,i),x.lanes|=a;break}P=P.next}}else if(m.tag===10)w=m.type===i.type?null:m.child;else if(m.tag===18){if(w=m.return,w===null)throw Error(e(341));w.lanes|=a,x=w.alternate,x!==null&&(x.lanes|=a),ll(w,a,i),w=m.sibling}else w=m.child;if(w!==null)w.return=m;else for(w=m;w!==null;){if(w===i){w=null;break}if(m=w.sibling,m!==null){m.return=w.return,w=m;break}w=w.return}m=w}Oe(n,i,d.children,a),i=i.child}return i;case 9:return d=i.type,u=i.pendingProps.children,Es(i,a),d=hn(d),u=u(d),i.flags|=1,Oe(n,i,u,a),i.child;case 14:return u=i.type,d=wn(u,i.pendingProps),d=wn(u.type,d),Ch(n,i,u,d,a);case 15:return kh(n,i,i.type,i.pendingProps,a);case 17:return u=i.type,d=i.pendingProps,d=i.elementType===u?d:wn(u,d),Na(n,i),i.tag=1,Ve(u)?(n=!0,ga(i)):n=!1,Es(i,a),yh(i,u,d),xl(i,u,d,a),Tl(null,i,u,!0,n,a);case 19:return Fh(n,i,a);case 22:return Th(n,i,a)}throw Error(e(156,i.tag))};function rd(n,i){return Yr(n,i)}function Up(n,i,a,u){this.tag=n,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function pn(n,i,a,u){return new Up(n,i,a,u)}function ql(n){return n=n.prototype,!(!n||!n.isReactComponent)}function $p(n){if(typeof n=="function")return ql(n)?1:0;if(n!=null){if(n=n.$$typeof,n===Nt)return 11;if(n===Ut)return 14}return 2}function vi(n,i){var a=n.alternate;return a===null?(a=pn(n.tag,i,n.key,n.mode),a.elementType=n.elementType,a.type=n.type,a.stateNode=n.stateNode,a.alternate=n,n.alternate=a):(a.pendingProps=i,a.type=n.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=n.flags&14680064,a.childLanes=n.childLanes,a.lanes=n.lanes,a.child=n.child,a.memoizedProps=n.memoizedProps,a.memoizedState=n.memoizedState,a.updateQueue=n.updateQueue,i=n.dependencies,a.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},a.sibling=n.sibling,a.index=n.index,a.ref=n.ref,a}function Va(n,i,a,u,d,m){var w=2;if(u=n,typeof n=="function")ql(n)&&(w=1);else if(typeof n=="string")w=5;else t:switch(n){case V:return Wi(a.children,d,m,i);case it:w=8,d|=8;break;case X:return n=pn(12,a,i,d|2),n.elementType=X,n.lanes=m,n;case Mt:return n=pn(13,a,i,d),n.elementType=Mt,n.lanes=m,n;case Lt:return n=pn(19,a,i,d),n.elementType=Lt,n.lanes=m,n;case q:return Ga(a,d,m,i);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case Ct:w=10;break t;case ft:w=9;break t;case Nt:w=11;break t;case Ut:w=14;break t;case Z:w=16,u=null;break t}throw Error(e(130,n==null?n:typeof n,""))}return i=pn(w,a,i,d),i.elementType=n,i.type=u,i.lanes=m,i}function Wi(n,i,a,u){return n=pn(7,n,u,i),n.lanes=a,n}function Ga(n,i,a,u){return n=pn(22,n,u,i),n.elementType=q,n.lanes=a,n.stateNode={isHidden:!1},n}function Yl(n,i,a){return n=pn(6,n,null,i),n.lanes=a,n}function Kl(n,i,a){return i=pn(4,n.children!==null?n.children:[],n.key,i),i.lanes=a,i.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},i}function Vp(n,i,a,u,d){this.tag=i,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ls(0),this.expirationTimes=ls(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ls(0),this.identifierPrefix=u,this.onRecoverableError=d,this.mutableSourceEagerHydrationData=null}function Ql(n,i,a,u,d,m,w,x,P){return n=new Vp(n,i,a,x,P),i===1?(i=1,m===!0&&(i|=8)):i=0,m=pn(3,null,null,i),n.current=m,m.stateNode=n,m.memoizedState={element:u,isDehydrated:a,cache:null,transitions:null,pendingSuspenseBoundaries:null},ul(m),n}function Gp(n,i,a){var u=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:W,key:u==null?null:""+u,children:n,containerInfo:i,implementation:a}}function ad(n){if(!n)return li;n=n._reactInternals;t:{if(ce(n)!==n||n.tag!==1)throw Error(e(170));var i=n;do{switch(i.tag){case 3:i=i.stateNode.context;break t;case 1:if(Ve(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break t}}i=i.return}while(i!==null);throw Error(e(171))}if(n.tag===1){var a=n.type;if(Ve(a))return Iu(n,a,i)}return i}function od(n,i,a,u,d,m,w,x,P){return n=Ql(a,u,!0,n,d,m,w,x,P),n.context=ad(null),a=n.current,u=je(),d=gi(a),m=Vn(u,d),m.callback=i??null,hi(a,m,d),n.current.lanes=d,Jn(n,d,u),Xe(n,u),n}function Wa(n,i,a,u){var d=i.current,m=je(),w=gi(d);return a=ad(a),i.context===null?i.context=a:i.pendingContext=a,i=Vn(m,w),i.payload={element:n},u=u===void 0?null:u,u!==null&&(i.callback=u),n=hi(d,i,w),n!==null&&(_n(n,d,w,m),Sa(n,d,w)),w}function Xa(n){return n=n.current,n.child?(n.child.tag===5,n.child.stateNode):null}function ld(n,i){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var a=n.retryLane;n.retryLane=a!==0&&a<i?a:i}}function Zl(n,i){ld(n,i),(n=n.alternate)&&ld(n,i)}function Wp(){return null}var cd=typeof reportError=="function"?reportError:function(n){console.error(n)};function Jl(n){this._internalRoot=n}qa.prototype.render=Jl.prototype.render=function(n){var i=this._internalRoot;if(i===null)throw Error(e(409));Wa(n,i,null,null)},qa.prototype.unmount=Jl.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var i=n.containerInfo;$i(function(){Wa(null,n,null,null)}),i[zn]=null}};function qa(n){this._internalRoot=n}qa.prototype.unstable_scheduleHydration=function(n){if(n){var i=Wc();n={blockedOn:null,target:n,priority:i};for(var a=0;a<ii.length&&i!==0&&i<ii[a].priority;a++);ii.splice(a,0,n),a===0&&Yc(n)}};function tc(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function Ya(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function ud(){}function Xp(n,i,a,u,d){if(d){if(typeof u=="function"){var m=u;u=function(){var F=Xa(w);m.call(F)}}var w=od(i,u,n,0,null,!1,!1,"",ud);return n._reactRootContainer=w,n[zn]=w.current,ar(n.nodeType===8?n.parentNode:n),$i(),w}for(;d=n.lastChild;)n.removeChild(d);if(typeof u=="function"){var x=u;u=function(){var F=Xa(P);x.call(F)}}var P=Ql(n,0,!1,null,null,!1,!1,"",ud);return n._reactRootContainer=P,n[zn]=P.current,ar(n.nodeType===8?n.parentNode:n),$i(function(){Wa(i,P,a,u)}),P}function Ka(n,i,a,u,d){var m=a._reactRootContainer;if(m){var w=m;if(typeof d=="function"){var x=d;d=function(){var P=Xa(w);x.call(P)}}Wa(i,w,n,d)}else w=Xp(a,i,n,d,u);return Xa(w)}Vc=function(n){switch(n.tag){case 3:var i=n.stateNode;if(i.current.memoizedState.isDehydrated){var a=Je(i.pendingLanes);a!==0&&(cs(i,a|1),Xe(i,k()),(Bt&6)===0&&(Rs=k()+500,ci()))}break;case 13:$i(function(){var u=$n(n,1);if(u!==null){var d=je();_n(u,n,1,d)}}),Zl(n,1)}},Eo=function(n){if(n.tag===13){var i=$n(n,134217728);if(i!==null){var a=je();_n(i,n,134217728,a)}Zl(n,134217728)}},Gc=function(n){if(n.tag===13){var i=gi(n),a=$n(n,i);if(a!==null){var u=je();_n(a,n,i,u)}Zl(n,i)}},Wc=function(){return Gt},Xc=function(n,i){var a=Gt;try{return Gt=n,i()}finally{Gt=a}},Li=function(n,i,a){switch(i){case"input":if(ts(n,a),i=a.name,a.type==="radio"&&i!=null){for(a=n;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<a.length;i++){var u=a[i];if(u!==n&&u.form===n.form){var d=fa(u);if(!d)throw Error(e(90));Ze(u),ts(u,d)}}}break;case"textarea":ki(n,a);break;case"select":i=a.value,i!=null&&Ee(n,!!a.multiple,i,!1)}},Ur=Gl,$s=$i;var qp={usingClientEntryPoint:!1,Events:[cr,vs,fa,is,Us,Gl]},Sr={findFiberByHostInstance:Fi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Yp={bundleType:Sr.bundleType,version:Sr.version,rendererPackageName:Sr.rendererPackageName,rendererConfig:Sr.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:j.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=Xr(n),n===null?null:n.stateNode},findFiberByHostInstance:Sr.findFiberByHostInstance||Wp,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Qa=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Qa.isDisabled&&Qa.supportsFiber)try{ct=Qa.inject(Yp),yt=Qa}catch{}}return qe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=qp,qe.createPortal=function(n,i){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!tc(i))throw Error(e(200));return Gp(n,i,null,a)},qe.createRoot=function(n,i){if(!tc(n))throw Error(e(299));var a=!1,u="",d=cd;return i!=null&&(i.unstable_strictMode===!0&&(a=!0),i.identifierPrefix!==void 0&&(u=i.identifierPrefix),i.onRecoverableError!==void 0&&(d=i.onRecoverableError)),i=Ql(n,1,!1,null,null,a,!1,u,d),n[zn]=i.current,ar(n.nodeType===8?n.parentNode:n),new Jl(i)},qe.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var i=n._reactInternals;if(i===void 0)throw typeof n.render=="function"?Error(e(188)):(n=Object.keys(n).join(","),Error(e(268,n)));return n=Xr(i),n=n===null?null:n.stateNode,n},qe.flushSync=function(n){return $i(n)},qe.hydrate=function(n,i,a){if(!Ya(i))throw Error(e(200));return Ka(null,n,i,!0,a)},qe.hydrateRoot=function(n,i,a){if(!tc(n))throw Error(e(405));var u=a!=null&&a.hydratedSources||null,d=!1,m="",w=cd;if(a!=null&&(a.unstable_strictMode===!0&&(d=!0),a.identifierPrefix!==void 0&&(m=a.identifierPrefix),a.onRecoverableError!==void 0&&(w=a.onRecoverableError)),i=od(i,null,n,1,a??null,d,!1,m,w),n[zn]=i.current,ar(n),u)for(n=0;n<u.length;n++)a=u[n],d=a._getVersion,d=d(a._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[a,d]:i.mutableSourceEagerHydrationData.push(a,d);return new qa(i)},qe.render=function(n,i,a){if(!Ya(i))throw Error(e(200));return Ka(null,n,i,!1,a)},qe.unmountComponentAtNode=function(n){if(!Ya(n))throw Error(e(40));return n._reactRootContainer?($i(function(){Ka(null,null,n,!1,function(){n._reactRootContainer=null,n[zn]=null})}),!0):!1},qe.unstable_batchedUpdates=Gl,qe.unstable_renderSubtreeIntoContainer=function(n,i,a,u){if(!Ya(a))throw Error(e(200));if(n==null||n._reactInternals===void 0)throw Error(e(38));return Ka(n,i,a,!1,u)},qe.version="18.3.1-next-f1338f8080-20240426",qe}var Ad;function sg(){if(Ad)return sc.exports;Ad=1;function p(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(p)}catch(t){console.error(t)}}return p(),sc.exports=ig(),sc.exports}var bd;function rg(){if(bd)return Ja;bd=1;var p=sg();return Ja.createRoot=p.createRoot,Ja.hydrateRoot=p.hydrateRoot,Ja}var ag=rg();const og=$d(ag);var Lr={};Lr.d=(p,t)=>{for(var e in t)Lr.o(t,e)&&!Lr.o(p,e)&&Object.defineProperty(p,e,{enumerable:!0,get:t[e]})};Lr.o=(p,t)=>Object.prototype.hasOwnProperty.call(p,t);var _t=globalThis.pdfjsLib={};Lr.d(_t,{AbortException:()=>bi,AnnotationEditorLayer:()=>qn,AnnotationEditorParamsType:()=>zt,AnnotationEditorType:()=>Pt,AnnotationEditorUIManager:()=>_i,AnnotationLayer:()=>nv,AnnotationMode:()=>wi,ColorPicker:()=>mn,DOMSVGFactory:()=>jc,DrawLayer:()=>ze,FeatureTest:()=>Be,GlobalWorkerOptions:()=>Ir,ImageKind:()=>so,InvalidPDFException:()=>wc,MissingPDFException:()=>Fr,OPS:()=>xn,OutputScale:()=>Ac,PDFDataRangeTransport:()=>cf,PDFDateString:()=>Wd,PDFWorker:()=>Ds,PasswordResponses:()=>hg,PermissionFlag:()=>ug,PixelsPerInch:()=>zs,RenderingCancelledException:()=>Pc,TextLayer:()=>He,TouchManager:()=>vo,UnexpectedResponseException:()=>oo,Util:()=>ht,VerbosityLevel:()=>uo,XfaLayer:()=>hf,build:()=>Dm,createValidAbsoluteUrl:()=>gg,fetchData:()=>go,getDocument:()=>km,getFilenameFromUrl:()=>xg,getPdfFilenameFromUrl:()=>Eg,getXfaPageViewport:()=>Cg,isDataScheme:()=>mo,isPdfFile:()=>Rc,noContextMenu:()=>En,normalizeUnicode:()=>bg,setLayerDimensions:()=>Qi,shadow:()=>Ot,stopEvent:()=>an,version:()=>Fm});const Fe=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Vd=[1,0,0,1,0,0],yc=[.001,0,0,.001,0,0],lg=1e7,oc=1.35,rn={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},wi={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},cg="pdfjs_internal_editor_",Pt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},zt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},ug={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Ne={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},so={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},we={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,WIDGET:20},Cr={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},uo={ERRORS:0,WARNINGS:1,INFOS:5},xn={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},hg={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let ho=uo.WARNINGS;function dg(p){Number.isInteger(p)&&(ho=p)}function fg(){return ho}function fo(p){ho>=uo.INFOS&&console.log(`Info: ${p}`)}function Rt(p){ho>=uo.WARNINGS&&console.log(`Warning: ${p}`)}function Wt(p){throw new Error(p)}function me(p,t){p||Wt(t)}function pg(p){switch(p?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function gg(p,t=null,e=null){if(!p)return null;try{if(e&&typeof p=="string"&&(e.addDefaultProtocol&&p.startsWith("www.")&&p.match(/\./g)?.length>=2&&(p=`http://${p}`),e.tryConvertEncoding))try{p=Ag(p)}catch{}const s=t?new URL(p,t):new URL(p);if(pg(s))return s}catch{}return null}function Ot(p,t,e,s=!1){return Object.defineProperty(p,t,{value:e,enumerable:!s,configurable:!0,writable:!1}),e}const Si=(function(){function t(e,s){this.message=e,this.name=s}return t.prototype=new Error,t.constructor=t,t})();class _d extends Si{constructor(t,e){super(t,"PasswordException"),this.code=e}}class lc extends Si{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class wc extends Si{constructor(t){super(t,"InvalidPDFException")}}class Fr extends Si{constructor(t){super(t,"MissingPDFException")}}class oo extends Si{constructor(t,e){super(t,"UnexpectedResponseException"),this.status=e}}class mg extends Si{constructor(t){super(t,"FormatError")}}class bi extends Si{constructor(t){super(t,"AbortException")}}function Gd(p){(typeof p!="object"||p?.length===void 0)&&Wt("Invalid argument for bytesToString");const t=p.length,e=8192;if(t<e)return String.fromCharCode.apply(null,p);const s=[];for(let r=0;r<t;r+=e){const o=Math.min(r+e,t),l=p.subarray(r,o);s.push(String.fromCharCode.apply(null,l))}return s.join("")}function po(p){typeof p!="string"&&Wt("Invalid argument for stringToBytes");const t=p.length,e=new Uint8Array(t);for(let s=0;s<t;++s)e[s]=p.charCodeAt(s)&255;return e}function vg(p){return String.fromCharCode(p>>24&255,p>>16&255,p>>8&255,p&255)}function kc(p){const t=Object.create(null);for(const[e,s]of p)t[e]=s;return t}function yg(){const p=new Uint8Array(4);return p[0]=1,new Uint32Array(p.buffer,0,1)[0]===1}function wg(){try{return new Function(""),!0}catch{return!1}}class Be{static get isLittleEndian(){return Ot(this,"isLittleEndian",yg())}static get isEvalSupported(){return Ot(this,"isEvalSupported",wg())}static get isOffscreenCanvasSupported(){return Ot(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Ot(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){return typeof navigator<"u"&&typeof navigator?.platform=="string"?Ot(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof navigator?.userAgent=="string"&&navigator.userAgent.includes("Firefox")}):Ot(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){return Ot(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const cc=Array.from(Array(256).keys(),p=>p.toString(16).padStart(2,"0"));class ht{static makeHexColor(t,e,s){return`#${cc[t]}${cc[e]}${cc[s]}`}static scaleMinMax(t,e){let s;t[0]?(t[0]<0&&(s=e[0],e[0]=e[2],e[2]=s),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(s=e[1],e[1]=e[3],e[3]=s),e[1]*=t[3],e[3]*=t[3]):(s=e[0],e[0]=e[1],e[1]=s,s=e[2],e[2]=e[3],e[3]=s,t[1]<0&&(s=e[1],e[1]=e[3],e[3]=s),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(s=e[0],e[0]=e[2],e[2]=s),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static applyTransform(t,e){const s=t[0]*e[0]+t[1]*e[2]+e[4],r=t[0]*e[1]+t[1]*e[3]+e[5];return[s,r]}static applyInverseTransform(t,e){const s=e[0]*e[3]-e[1]*e[2],r=(t[0]*e[3]-t[1]*e[2]+e[2]*e[5]-e[4]*e[3])/s,o=(-t[0]*e[1]+t[1]*e[0]+e[4]*e[1]-e[5]*e[0])/s;return[r,o]}static getAxialAlignedBoundingBox(t,e){const s=this.applyTransform(t,e),r=this.applyTransform(t.slice(2,4),e),o=this.applyTransform([t[0],t[3]],e),l=this.applyTransform([t[2],t[1]],e);return[Math.min(s[0],r[0],o[0],l[0]),Math.min(s[1],r[1],o[1],l[1]),Math.max(s[0],r[0],o[0],l[0]),Math.max(s[1],r[1],o[1],l[1])]}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t){const e=[t[0],t[2],t[1],t[3]],s=t[0]*e[0]+t[1]*e[2],r=t[0]*e[1]+t[1]*e[3],o=t[2]*e[0]+t[3]*e[2],l=t[2]*e[1]+t[3]*e[3],c=(s+l)/2,h=Math.sqrt((s+l)**2-4*(s*l-o*r))/2,f=c+h||1,g=c-h||1;return[Math.sqrt(f),Math.sqrt(g)]}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const s=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),r=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(s>r)return null;const o=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),l=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return o>l?null:[s,o,r,l]}static#t(t,e,s,r,o,l,c,h,f,g){if(f<=0||f>=1)return;const v=1-f,y=f*f,A=y*f,b=v*(v*(v*t+3*f*e)+3*y*s)+A*r,S=v*(v*(v*o+3*f*l)+3*y*c)+A*h;g[0]=Math.min(g[0],b),g[1]=Math.min(g[1],S),g[2]=Math.max(g[2],b),g[3]=Math.max(g[3],S)}static#e(t,e,s,r,o,l,c,h,f,g,v,y){if(Math.abs(f)<1e-12){Math.abs(g)>=1e-12&&this.#t(t,e,s,r,o,l,c,h,-v/g,y);return}const A=g**2-4*v*f;if(A<0)return;const b=Math.sqrt(A),S=2*f;this.#t(t,e,s,r,o,l,c,h,(-g+b)/S,y),this.#t(t,e,s,r,o,l,c,h,(-g-b)/S,y)}static bezierBoundingBox(t,e,s,r,o,l,c,h,f){return f?(f[0]=Math.min(f[0],t,c),f[1]=Math.min(f[1],e,h),f[2]=Math.max(f[2],t,c),f[3]=Math.max(f[3],e,h)):f=[Math.min(t,c),Math.min(e,h),Math.max(t,c),Math.max(e,h)],this.#e(t,s,o,c,e,r,l,h,3*(-t+3*(s-o)+c),6*(t-2*s+o),3*(s-t),f),this.#e(t,s,o,c,e,r,l,h,3*(-e+3*(r-l)+h),6*(e-2*r+l),3*(r-e),f),f}}function Ag(p){return decodeURIComponent(escape(p))}let uc=null,Sd=null;function bg(p){return uc||(uc=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Sd=new Map([["","t"]])),p.replaceAll(uc,(t,e,s)=>e?e.normalize("NFKC"):Sd.get(s))}function _g(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const p=new Uint8Array(32);return crypto.getRandomValues(p),Gd(p)}const Tc="pdfjs_internal_id_";function Sg(p){return Uint8Array.prototype.toBase64?p.toBase64():btoa(Gd(p))}typeof Promise.try!="function"&&(Promise.try=function(p,...t){return new Promise(e=>{e(p(...t))})});const Xn="http://www.w3.org/2000/svg";class zs{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function go(p,t="text"){if(Rr(p,document.baseURI)){const e=await fetch(p);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,s)=>{const r=new XMLHttpRequest;r.open("GET",p,!0),r.responseType=t,r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE){if(r.status===200||r.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(r.response);return}e(r.responseText);return}s(new Error(r.statusText))}},r.send(null)})}class Or{constructor({viewBox:t,userUnit:e,scale:s,rotation:r,offsetX:o=0,offsetY:l=0,dontFlip:c=!1}){this.viewBox=t,this.userUnit=e,this.scale=s,this.rotation=r,this.offsetX=o,this.offsetY=l,s*=e;const h=(t[2]+t[0])/2,f=(t[3]+t[1])/2;let g,v,y,A;switch(r%=360,r<0&&(r+=360),r){case 180:g=-1,v=0,y=0,A=1;break;case 90:g=0,v=1,y=1,A=0;break;case 270:g=0,v=-1,y=-1,A=0;break;case 0:g=1,v=0,y=0,A=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}c&&(y=-y,A=-A);let b,S,T,C;g===0?(b=Math.abs(f-t[1])*s+o,S=Math.abs(h-t[0])*s+l,T=(t[3]-t[1])*s,C=(t[2]-t[0])*s):(b=Math.abs(h-t[0])*s+o,S=Math.abs(f-t[1])*s+l,T=(t[2]-t[0])*s,C=(t[3]-t[1])*s),this.transform=[g*s,v*s,y*s,A*s,b-g*s*h-y*s*f,S-v*s*h-A*s*f],this.width=T,this.height=C}get rawDims(){const{userUnit:t,viewBox:e}=this,s=e.map(r=>r*t);return Ot(this,"rawDims",{pageWidth:s[2]-s[0],pageHeight:s[3]-s[1],pageX:s[0],pageY:s[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:s=this.offsetX,offsetY:r=this.offsetY,dontFlip:o=!1}={}){return new Or({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:s,offsetY:r,dontFlip:o})}convertToViewportPoint(t,e){return ht.applyTransform([t,e],this.transform)}convertToViewportRectangle(t){const e=ht.applyTransform([t[0],t[1]],this.transform),s=ht.applyTransform([t[2],t[3]],this.transform);return[e[0],e[1],s[0],s[1]]}convertToPdfPoint(t,e){return ht.applyInverseTransform([t,e],this.transform)}}class Pc extends Si{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function mo(p){const t=p.length;let e=0;for(;e<t&&p[e].trim()==="";)e++;return p.substring(e,e+5).toLowerCase()==="data:"}function Rc(p){return typeof p=="string"&&/\.pdf$/i.test(p)}function xg(p){return[p]=p.split(/[#?]/,1),p.substring(p.lastIndexOf("/")+1)}function Eg(p,t="document.pdf"){if(typeof p!="string")return t;if(mo(p))return Rt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const e=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,s=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,r=e.exec(p);let o=s.exec(r[1])||s.exec(r[2])||s.exec(r[3]);if(o&&(o=o[0],o.includes("%")))try{o=s.exec(decodeURIComponent(o))[0]}catch{}return o||t}class xd{started=Object.create(null);times=[];time(t){t in this.started&&Rt(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||Rt(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:s}of this.times)e=Math.max(s.length,e);for(const{name:s,start:r,end:o}of this.times)t.push(`${s.padEnd(e)} ${o-r}ms
`);return t.join("")}}function Rr(p,t){try{const{protocol:e}=t?new URL(p,t):new URL(p);return e==="http:"||e==="https:"}catch{return!1}}function En(p){p.preventDefault()}function an(p){p.preventDefault(),p.stopPropagation()}class Wd{static#t;static toDateObject(t){if(!t||typeof t!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const e=this.#t.exec(t);if(!e)return null;const s=parseInt(e[1],10);let r=parseInt(e[2],10);r=r>=1&&r<=12?r-1:0;let o=parseInt(e[3],10);o=o>=1&&o<=31?o:1;let l=parseInt(e[4],10);l=l>=0&&l<=23?l:0;let c=parseInt(e[5],10);c=c>=0&&c<=59?c:0;let h=parseInt(e[6],10);h=h>=0&&h<=59?h:0;const f=e[7]||"Z";let g=parseInt(e[8],10);g=g>=0&&g<=23?g:0;let v=parseInt(e[9],10)||0;return v=v>=0&&v<=59?v:0,f==="-"?(l+=g,c+=v):f==="+"&&(l-=g,c-=v),new Date(Date.UTC(s,r,o,l,c,h))}}function Cg(p,{scale:t=1,rotation:e=0}){const{width:s,height:r}=p.attributes.style,o=[0,0,parseInt(s),parseInt(r)];return new Or({viewBox:o,userUnit:1,scale:t,rotation:e})}function Mc(p){if(p.startsWith("#")){const t=parseInt(p.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return p.startsWith("rgb(")?p.slice(4,-1).split(",").map(t=>parseInt(t)):p.startsWith("rgba(")?p.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(Rt(`Not a valid color format: "${p}"`),[0,0,0])}function kg(p){const t=document.createElement("span");t.style.visibility="hidden",document.body.append(t);for(const e of p.keys()){t.style.color=e;const s=window.getComputedStyle(t).color;p.set(e,Mc(s))}t.remove()}function ie(p){const{a:t,b:e,c:s,d:r,e:o,f:l}=p.getTransform();return[t,e,s,r,o,l]}function Mn(p){const{a:t,b:e,c:s,d:r,e:o,f:l}=p.getTransform().invertSelf();return[t,e,s,r,o,l]}function Qi(p,t,e=!1,s=!0){if(t instanceof Or){const{pageWidth:r,pageHeight:o}=t.rawDims,{style:l}=p,c=Be.isCSSRoundSupported,h=`var(--scale-factor) * ${r}px`,f=`var(--scale-factor) * ${o}px`,g=c?`round(down, ${h}, var(--scale-round-x, 1px))`:`calc(${h})`,v=c?`round(down, ${f}, var(--scale-round-y, 1px))`:`calc(${f})`;!e||t.rotation%180===0?(l.width=g,l.height=v):(l.width=v,l.height=g)}s&&p.setAttribute("data-main-rotation",t.rotation)}class Ac{constructor(){const t=window.devicePixelRatio||1;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}}class Nr{#t=null;#e=null;#n;#i=null;#r=null;static#s=null;constructor(t){this.#n=t,Nr.#s||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"})}render(){const t=this.#t=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=this.#n._uiManager._signal;t.addEventListener("contextmenu",En,{signal:e}),t.addEventListener("pointerdown",Nr.#l,{signal:e});const s=this.#i=document.createElement("div");s.className="buttons",t.append(s);const r=this.#n.toolbarPosition;if(r){const{style:o}=t,l=this.#n._uiManager.direction==="ltr"?1-r[0]:r[0];o.insetInlineEnd=`${100*l}%`,o.top=`calc(${100*r[1]}% + var(--editor-toolbar-vert-offset))`}return this.#d(),t}get div(){return this.#t}static#l(t){t.stopPropagation()}#o(t){this.#n._focusEventsAllowed=!1,an(t)}#u(t){this.#n._focusEventsAllowed=!0,an(t)}#c(t){const e=this.#n._uiManager._signal;t.addEventListener("focusin",this.#o.bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",this.#u.bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",En,{signal:e})}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#r?.shown()}#d(){const{editorType:t,_uiManager:e}=this.#n,s=document.createElement("button");s.className="delete",s.tabIndex=0,s.setAttribute("data-l10n-id",Nr.#s[t]),this.#c(s),s.addEventListener("click",r=>{e.delete()},{signal:e._signal}),this.#i.append(s)}get#h(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const e=await t.render();this.#c(e),this.#i.prepend(e,this.#h),this.#r=t}addColorPicker(t){this.#e=t;const e=t.renderButton();this.#c(e),this.#i.prepend(e,this.#h)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class Tg{#t=null;#e=null;#n;constructor(t){this.#n=t}#i(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar"),t.addEventListener("contextmenu",En,{signal:this.#n._signal});const e=this.#t=document.createElement("div");return e.className="buttons",t.append(e),this.#s(),t}#r(t,e){let s=0,r=0;for(const o of t){const l=o.y+o.height;if(l<s)continue;const c=o.x+(e?o.width:0);if(l>s){r=c,s=l;continue}e?c>r&&(r=c):c<r&&(r=c)}return[e?1-r:r,s]}show(t,e,s){const[r,o]=this.#r(e,s),{style:l}=this.#e||=this.#i();t.append(this.#e),l.insetInlineEnd=`${100*r}%`,l.top=`calc(${100*o}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#s(){const t=document.createElement("button");t.className="highlightButton",t.tabIndex=0,t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const e=document.createElement("span");t.append(e),e.className="visuallyHidden",e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const s=this.#n._signal;t.addEventListener("contextmenu",En,{signal:s}),t.addEventListener("click",()=>{this.#n.highlightSelection("floating_button")},{signal:s}),this.#t.append(t)}}function lo(p,t,e){for(const s of e)t.addEventListener(s,p[s].bind(p))}class Pg{#t=0;get id(){return`${cg}${this.#t++}`}}class Lc{#t=_g();#e=0;#n=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),r=new Image;r.src=t;const o=r.decode().then(()=>(s.drawImage(r,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return Ot(this,"_isSVGFittingCanvas",o)}async#i(t,e){this.#n||=new Map;let s=this.#n.get(t);if(s===null)return null;if(s?.bitmap)return s.refCounter+=1,s;try{s||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let r;if(typeof e=="string"?(s.url=e,r=await go(e,"blob")):e instanceof File?r=s.file=e:e instanceof Blob&&(r=e),r.type==="image/svg+xml"){const o=Lc._isSVGFittingCanvas,l=new FileReader,c=new Image,h=new Promise((f,g)=>{c.onload=()=>{s.bitmap=c,s.isSvg=!0,f()},l.onload=async()=>{const v=s.svgUrl=l.result;c.src=await o?`${v}#svgView(preserveAspectRatio(none))`:v},c.onerror=l.onerror=g});l.readAsDataURL(r),await h}else s.bitmap=await createImageBitmap(r);s.refCounter=1}catch(r){Rt(r),s=null}return this.#n.set(t,s),s&&this.#n.set(s.id,s),s}async getFromFile(t){const{lastModified:e,name:s,size:r,type:o}=t;return this.#i(`${e}_${s}_${r}_${o}`,t)}async getFromUrl(t){return this.#i(t,t)}async getFromBlob(t,e){const s=await e;return this.#i(t,s)}async getFromId(t){this.#n||=new Map;const e=this.#n.get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:s}=e;return delete e.blobPromise,this.getFromBlob(e.id,s)}return this.getFromUrl(e.url)}getFromCanvas(t,e){this.#n||=new Map;let s=this.#n.get(t);if(s?.bitmap)return s.refCounter+=1,s;const r=new OffscreenCanvas(e.width,e.height);return r.getContext("2d").drawImage(e,0,0),s={bitmap:r.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#n.set(t,s),this.#n.set(s.id,s),s}getSvgUrl(t){const e=this.#n.get(t);return e?.isSvg?e.svgUrl:null}deleteId(t){this.#n||=new Map;const e=this.#n.get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:s}=e;if(!e.url&&!e.file){const r=new OffscreenCanvas(s.width,s.height);r.getContext("bitmaprenderer").transferFromImageBitmap(s),e.blobPromise=r.convertToBlob()}s.close?.(),e.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#t}_`)}}class Rg{#t=[];#e=!1;#n;#i=-1;constructor(t=128){this.#n=t}add({cmd:t,undo:e,post:s,mustExec:r,type:o=NaN,overwriteIfSameType:l=!1,keepUndo:c=!1}){if(r&&t(),this.#e)return;const h={cmd:t,undo:e,post:s,type:o};if(this.#i===-1){this.#t.length>0&&(this.#t.length=0),this.#i=0,this.#t.push(h);return}if(l&&this.#t[this.#i].type===o){c&&(h.undo=this.#t[this.#i].undo),this.#t[this.#i]=h;return}const f=this.#i+1;f===this.#n?this.#t.splice(0,1):(this.#i=f,f<this.#t.length&&this.#t.splice(f)),this.#t.push(h)}undo(){if(this.#i===-1)return;this.#e=!0;const{undo:t,post:e}=this.#t[this.#i];t(),e?.(),this.#e=!1,this.#i-=1}redo(){if(this.#i<this.#t.length-1){this.#i+=1,this.#e=!0;const{cmd:t,post:e}=this.#t[this.#i];t(),e?.(),this.#e=!1}}hasSomethingToUndo(){return this.#i!==-1}hasSomethingToRedo(){return this.#i<this.#t.length-1}cleanType(t){if(this.#i!==-1){for(let e=this.#i;e>=0;e--)if(this.#t[e].type!==t){this.#t.splice(e+1,this.#i-e),this.#i=e;return}this.#t.length=0,this.#i=-1}}destroy(){this.#t=null}}class jr{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=Be.platform;for(const[s,r,o={}]of t)for(const l of s){const c=l.startsWith("mac+");e&&c?(this.callbacks.set(l.slice(4),{callback:r,options:o}),this.allKeys.add(l.split("+").at(-1))):!e&&!c&&(this.callbacks.set(l,{callback:r,options:o}),this.allKeys.add(l.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e}exec(t,e){if(!this.allKeys.has(e.key))return;const s=this.callbacks.get(this.#t(e));if(!s)return;const{callback:r,options:{bubbles:o=!1,args:l=[],checker:c=null}}=s;c&&!c(t,e)||(r.bind(t,...l,e)(),o||an(e))}}class Nc{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return kg(t),Ot(this,"_colors",t)}convert(t){const e=Mc(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[s,r]of this._colors)if(r.every((o,l)=>o===e[l]))return Nc._colorsMapping.get(s);return e}getHexCode(t){const e=this._colors.get(t);return e?ht.makeHexColor(...e):t}}class _i{#t=new AbortController;#e=null;#n=new Map;#i=new Map;#r=null;#s=null;#l=null;#o=new Rg;#u=null;#c=null;#d=0;#h=new Set;#f=null;#a=null;#p=new Set;_editorUndoBar=null;#m=!1;#g=!1;#v=!1;#A=null;#y=null;#b=null;#S=null;#E=!1;#k=null;#P=new Pg;#_=!1;#T=!1;#C=null;#M=null;#I=null;#D=null;#x=Pt.NONE;#w=new Set;#N=null;#B=null;#U=null;#$={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#O=[0,0];#F=null;#j=null;#V=null;#L=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=_i.prototype,e=l=>l.#j.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&l.hasSomethingToControl(),s=(l,{target:c})=>{if(c instanceof HTMLInputElement){const{type:h}=c;return h!=="text"&&h!=="number"}return!0},r=this.TRANSLATE_SMALL,o=this.TRANSLATE_BIG;return Ot(this,"_keyboardManager",new jr([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],t.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:s}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(l,{target:c})=>!(c instanceof HTMLButtonElement)&&l.#j.contains(c)&&!l.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(l,{target:c})=>!(c instanceof HTMLButtonElement)&&l.#j.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-r,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-o,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[r,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[o,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-r],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-o],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,r],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,o],checker:e}]]))}constructor(t,e,s,r,o,l,c,h,f,g,v,y,A){const b=this._signal=this.#t.signal;this.#j=t,this.#V=e,this.#r=s,this._eventBus=r,r._on("editingaction",this.onEditingAction.bind(this),{signal:b}),r._on("pagechanging",this.onPageChanging.bind(this),{signal:b}),r._on("scalechanging",this.onScaleChanging.bind(this),{signal:b}),r._on("rotationchanging",this.onRotationChanging.bind(this),{signal:b}),r._on("setpreference",this.onSetPreference.bind(this),{signal:b}),r._on("switchannotationeditorparams",S=>this.updateParams(S.type,S.value),{signal:b}),this.#et(),this.#rt(),this.#q(),this.#s=o.annotationStorage,this.#A=o.filterFactory,this.#B=l,this.#S=c||null,this.#m=h,this.#g=f,this.#v=g,this.#D=v||null,this.viewParameters={realScale:zs.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=y||null,this._supportsPinchToZoom=A!==!1}destroy(){this.#L?.resolve(),this.#L=null,this.#t?.abort(),this.#t=null,this._signal=null;for(const t of this.#i.values())t.destroy();this.#i.clear(),this.#n.clear(),this.#p.clear(),this.#e=null,this.#w.clear(),this.#o.destroy(),this.#r?.destroy(),this.#k?.hide(),this.#k=null,this.#y&&(clearTimeout(this.#y),this.#y=null),this.#F&&(clearTimeout(this.#F),this.#F=null),this._editorUndoBar?.destroy()}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#D}get useNewAltTextFlow(){return this.#g}get useNewAltTextWhenAddingImage(){return this.#v}get hcmFilter(){return Ot(this,"hcmFilter",this.#B?this.#A.addHCMFilter(this.#B.foreground,this.#B.background):"none")}get direction(){return Ot(this,"direction",getComputedStyle(this.#j).direction)}get highlightColors(){return Ot(this,"highlightColors",this.#S?new Map(this.#S.split(",").map(t=>t.split("=").map(e=>e.trim()))):null)}get highlightColorNames(){return Ot(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#c=t}setMainHighlightColorPicker(t){this.#I=t}editAltText(t,e=!1){this.#r?.editAltText(this,t,e)}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){t==="enableNewAltTextWhenAddingImage"&&(this.#v=e)}onPageChanging({pageNumber:t}){this.#d=t-1}focusMainContainer(){this.#j.focus()}findParent(t,e){for(const s of this.#i.values()){const{x:r,y:o,width:l,height:c}=s.div.getBoundingClientRect();if(t>=r&&t<=r+l&&e>=o&&e<=o+c)return s}return null}disableUserSelect(t=!1){this.#V.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#p.add(t)}removeShouldRescale(t){this.#p.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*zs.PDF_TO_CSS_UNITS;for(const e of this.#p)e.onScaleChanging();this.#c?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#z({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#X(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const s of this.#i.values())if(s.hasTextLayer(t))return s;return null}highlightSelection(t=""){const e=document.getSelection();if(!e||e.isCollapsed)return;const{anchorNode:s,anchorOffset:r,focusNode:o,focusOffset:l}=e,c=e.toString(),f=this.#z(e).closest(".textLayer"),g=this.getSelectionBoxes(f);if(!g)return;e.empty();const v=this.#X(f),y=this.#x===Pt.NONE,A=()=>{v?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:g,anchorNode:s,anchorOffset:r,focusNode:o,focusOffset:l,text:c}),y&&this.showAllEditors("highlight",!0,!0)};if(y){this.switchToMode(Pt.HIGHLIGHT,A);return}A()}#J(){const t=document.getSelection();if(!t||t.isCollapsed)return;const s=this.#z(t).closest(".textLayer"),r=this.getSelectionBoxes(s);r&&(this.#k||=new Tg(this),this.#k.show(s,r,this.direction==="ltr"))}addToAnnotationStorage(t){!t.isEmpty()&&this.#s&&!this.#s.has(t.id)&&this.#s.setValue(t.id,t)}#tt(){const t=document.getSelection();if(!t||t.isCollapsed){this.#N&&(this.#k?.hide(),this.#N=null,this.#R({hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===this.#N)return;const r=this.#z(t).closest(".textLayer");if(!r){this.#N&&(this.#k?.hide(),this.#N=null,this.#R({hasSelectedText:!1}));return}if(this.#k?.hide(),this.#N=e,this.#R({hasSelectedText:!0}),!(this.#x!==Pt.HIGHLIGHT&&this.#x!==Pt.NONE)&&(this.#x===Pt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#E=this.isShiftKeyDown,!this.isShiftKeyDown)){const o=this.#x===Pt.HIGHLIGHT?this.#X(r):null;o?.toggleDrawing();const l=new AbortController,c=this.combinedSignal(l),h=f=>{f.type==="pointerup"&&f.button!==0||(l.abort(),o?.toggleDrawing(!0),f.type==="pointerup"&&this.#W("main_toolbar"))};window.addEventListener("pointerup",h,{signal:c}),window.addEventListener("blur",h,{signal:c})}}#W(t=""){this.#x===Pt.HIGHLIGHT?this.highlightSelection(t):this.#m&&this.#J()}#et(){document.addEventListener("selectionchange",this.#tt.bind(this),{signal:this._signal})}#nt(){if(this.#b)return;this.#b=new AbortController;const t=this.combinedSignal(this.#b);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#it(){this.#b?.abort(),this.#b=null}blur(){if(this.isShiftKeyDown=!1,this.#E&&(this.#E=!1,this.#W("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of this.#w)if(e.div.contains(t)){this.#M=[e,t],e._focusEventsAllowed=!1;break}}focus(){if(!this.#M)return;const[t,e]=this.#M;this.#M=null,e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}#q(){if(this.#C)return;this.#C=new AbortController;const t=this.combinedSignal(this.#C);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#st(){this.#C?.abort(),this.#C=null}#Y(){if(this.#u)return;this.#u=new AbortController;const t=this.combinedSignal(this.#u);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#K(){this.#u?.abort(),this.#u=null}#rt(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#q(),this.#Y()}removeEditListeners(){this.#st(),this.#K()}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const s of this.#a)if(s.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const s of this.#a)if(s.isHandlingMimeForPasting(e.type)){s.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const e=[];for(const s of this.#w){const r=s.serialize(!0);r&&e.push(r)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const o of e.items)for(const l of this.#a)if(l.isHandlingMimeForPasting(o.type)){l.paste(o,this.currentLayer);return}let s=e.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(o){Rt(`paste: "${o.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const r=this.currentLayer;try{const o=[];for(const h of s){const f=await r.deserialize(h);if(!f)return;o.push(f)}const l=()=>{for(const h of o)this.#Q(h);this.#Z(o)},c=()=>{for(const h of o)h.remove()};this.addCommands({cmd:l,undo:c,mustExec:!0})}catch(o){Rt(`paste: "${o.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#x!==Pt.NONE&&!this.isEditorHandlingKeyboard&&_i._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#E&&(this.#E=!1,this.#W("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}#R(t){Object.entries(t).some(([s,r])=>this.#$[s]!==r)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#$,t)}),this.#x===Pt.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#H([[zt.HIGHLIGHT_FREE,!0]]))}#H(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#nt(),this.#Y(),this.#R({isEditing:this.#x!==Pt.NONE,isEmpty:this.#G(),hasSomethingToUndo:this.#o.hasSomethingToUndo(),hasSomethingToRedo:this.#o.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#it(),this.#K(),this.#R({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#a){this.#a=t;for(const e of this.#a)this.#H(e.defaultPropertiesToUpdate)}}getId(){return this.#P.id}get currentLayer(){return this.#i.get(this.#d)}getLayer(t){return this.#i.get(t)}get currentPageIndex(){return this.#d}addLayer(t){this.#i.set(t.pageIndex,t),this.#_?t.enable():t.disable()}removeLayer(t){this.#i.delete(t.pageIndex)}async updateMode(t,e=null,s=!1){if(this.#x!==t&&!(this.#L&&(await this.#L.promise,!this.#L))){if(this.#L=Promise.withResolvers(),this.#x=t,t===Pt.NONE){this.setEditingState(!1),this.#ot(),this._editorUndoBar?.hide(),this.#L.resolve();return}this.setEditingState(!0),await this.#at(),this.unselectAll();for(const r of this.#i.values())r.updateMode(t);if(!e){s&&this.addNewEditorFromKeyboard(),this.#L.resolve();return}for(const r of this.#n.values())r.annotationElementId===e?(this.setSelected(r),r.enterInEditMode()):r.unselect();this.#L.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t!==this.#x&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:t})}updateParams(t,e){if(this.#a){switch(t){case zt.CREATE:this.currentLayer.addNewEditor();return;case zt.HIGHLIGHT_DEFAULT_COLOR:this.#I?.updateColor(e);break;case zt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#U||=new Map).set(t,e),this.showAllEditors("highlight",e);break}for(const s of this.#w)s.updateParams(t,e);for(const s of this.#a)s.updateDefaultParams(t,e)}}showAllEditors(t,e,s=!1){for(const o of this.#n.values())o.editorType===t&&o.show(e);(this.#U?.get(zt.HIGHLIGHT_SHOW_ALL)??!0)!==e&&this.#H([[zt.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(this.#T!==t){this.#T=t;for(const e of this.#i.values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}async#at(){if(!this.#_){this.#_=!0;const t=[];for(const e of this.#i.values())t.push(e.enable());await Promise.all(t);for(const e of this.#n.values())e.enable()}}#ot(){if(this.unselectAll(),this.#_){this.#_=!1;for(const t of this.#i.values())t.disable();for(const t of this.#n.values())t.disable()}}getEditors(t){const e=[];for(const s of this.#n.values())s.pageIndex===t&&e.push(s);return e}getEditor(t){return this.#n.get(t)}addEditor(t){this.#n.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#y&&clearTimeout(this.#y),this.#y=setTimeout(()=>{this.focusMainContainer(),this.#y=null},0)),this.#n.delete(t.id),this.unselect(t),(!t.annotationElementId||!this.#h.has(t.annotationElementId))&&this.#s?.remove(t.id)}addDeletedAnnotationElement(t){this.#h.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#h.has(t)}removeDeletedAnnotationElement(t){this.#h.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#Q(t){const e=this.#i.get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#H(t.propertiesToUpdate))}get#lt(){let t=null;for(t of this.#w);return t}updateUI(t){this.#lt===t&&this.#H(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#H(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#w.has(t)){this.#w.delete(t),t.unselect(),this.#R({hasSelectedEditor:this.hasSelection});return}this.#w.add(t),t.select(),this.#H(t.propertiesToUpdate),this.#R({hasSelectedEditor:!0})}setSelected(t){this.#c?.commitOrRemove();for(const e of this.#w)e!==t&&e.unselect();this.#w.clear(),this.#w.add(t),t.select(),this.#H(t.propertiesToUpdate),this.#R({hasSelectedEditor:!0})}isSelected(t){return this.#w.has(t)}get firstSelectedEditor(){return this.#w.values().next().value}unselect(t){t.unselect(),this.#w.delete(t),this.#R({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#w.size!==0}get isEnterHandled(){return this.#w.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#o.undo(),this.#R({hasSomethingToUndo:this.#o.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#G()}),this._editorUndoBar?.hide()}redo(){this.#o.redo(),this.#R({hasSomethingToUndo:!0,hasSomethingToRedo:this.#o.hasSomethingToRedo(),isEmpty:this.#G()})}addCommands(t){this.#o.add(t),this.#R({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#G()})}cleanUndoStack(t){this.#o.cleanType(t)}#G(){if(this.#n.size===0)return!0;if(this.#n.size===1)for(const t of this.#n.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...this.#w],s=()=>{this._editorUndoBar?.show(r,e.length===1?e[0].editorType:e.length);for(const o of e)o.remove()},r=()=>{for(const o of e)this.#Q(o)};this.addCommands({cmd:s,undo:r,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#Z(t){for(const e of this.#w)e.unselect();this.#w.clear();for(const e of t)e.isEmpty()||(this.#w.add(e),e.select());this.#R({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#w)t.commit();this.#Z(this.#n.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#x!==Pt.NONE))&&!this.#c?.commitOrRemove()&&this.hasSelection){for(const t of this.#w)t.unselect();this.#w.clear(),this.#R({hasSelectedEditor:!1})}}translateSelectedEditors(t,e,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;this.#O[0]+=t,this.#O[1]+=e;const[r,o]=this.#O,l=[...this.#w],c=1e3;this.#F&&clearTimeout(this.#F),this.#F=setTimeout(()=>{this.#F=null,this.#O[0]=this.#O[1]=0,this.addCommands({cmd:()=>{for(const h of l)this.#n.has(h.id)&&h.translateInPage(r,o)},undo:()=>{for(const h of l)this.#n.has(h.id)&&h.translateInPage(-r,-o)},mustExec:!1})},c);for(const h of l)h.translateInPage(t,e)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#f=new Map;for(const t of this.#w)this.#f.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#f)return!1;this.disableUserSelect(!1);const t=this.#f;this.#f=null;let e=!1;for(const[{x:r,y:o,pageIndex:l},c]of t)c.newX=r,c.newY=o,c.newPageIndex=l,e||=r!==c.savedX||o!==c.savedY||l!==c.savedPageIndex;if(!e)return!1;const s=(r,o,l,c)=>{if(this.#n.has(r.id)){const h=this.#i.get(c);h?r._setParentAndPosition(h,o,l):(r.pageIndex=c,r.x=o,r.y=l)}};return this.addCommands({cmd:()=>{for(const[r,{newX:o,newY:l,newPageIndex:c}]of t)s(r,o,l,c)},undo:()=>{for(const[r,{savedX:o,savedY:l,savedPageIndex:c}]of t)s(r,o,l,c)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(this.#f)for(const s of this.#f.keys())s.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#w.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#x}get imageManager(){return Ot(this,"imageManager",new Lc)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let f=0,g=e.rangeCount;f<g;f++)if(!t.contains(e.getRangeAt(f).commonAncestorContainer))return null;const{x:s,y:r,width:o,height:l}=t.getBoundingClientRect();let c;switch(t.getAttribute("data-main-rotation")){case"90":c=(f,g,v,y)=>({x:(g-r)/l,y:1-(f+v-s)/o,width:y/l,height:v/o});break;case"180":c=(f,g,v,y)=>({x:1-(f+v-s)/o,y:1-(g+y-r)/l,width:v/o,height:y/l});break;case"270":c=(f,g,v,y)=>({x:1-(g+y-r)/l,y:(f-s)/o,width:y/l,height:v/o});break;default:c=(f,g,v,y)=>({x:(f-s)/o,y:(g-r)/l,width:v/o,height:y/l});break}const h=[];for(let f=0,g=e.rangeCount;f<g;f++){const v=e.getRangeAt(f);if(!v.collapsed)for(const{x:y,y:A,width:b,height:S}of v.getClientRects())b===0||S===0||h.push(c(y,A,b,S))}return h.length===0?null:h}addChangedExistingAnnotation({annotationElementId:t,id:e}){(this.#l||=new Map).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){this.#l?.delete(t)}renderAnnotationElement(t){const e=this.#l?.get(t.data.id);if(!e)return;const s=this.#s.getRawValue(e);s&&(this.#x===Pt.NONE&&!s.hasBeenModified||s.renderAnnotationElement(t))}}class Nn{#t=null;#e=!1;#n=null;#i=null;#r=null;#s=null;#l=!1;#o=null;#u=null;#c=null;#d=null;#h=!1;static#f=null;static _l10n=null;constructor(t){this.#u=t,this.#h=t._uiManager.useNewAltTextFlow,Nn.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){Nn._l10n??=t}async render(){const t=this.#n=document.createElement("button");t.className="altText",t.tabIndex="0";const e=this.#i=document.createElement("span");t.append(e),this.#h?(t.classList.add("new"),t.setAttribute("data-l10n-id",Nn.#f.missing),e.setAttribute("data-l10n-id",Nn.#f["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=this.#u._uiManager._signal;t.addEventListener("contextmenu",En,{signal:s}),t.addEventListener("pointerdown",o=>o.stopPropagation(),{signal:s});const r=o=>{o.preventDefault(),this.#u._uiManager.editAltText(this.#u),this.#h&&this.#u._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#a}})};return t.addEventListener("click",r,{capture:!0,signal:s}),t.addEventListener("keydown",o=>{o.target===t&&o.key==="Enter"&&(this.#l=!0,r(o))},{signal:s}),await this.#p(),t}get#a(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#n&&(this.#n.focus({focusVisible:this.#l}),this.#l=!1)}isEmpty(){return this.#h?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#h?this.#t!==null||!!this.#c:this.isEmpty()}get guessedText(){return this.#c}async setGuessedText(t){this.#t===null&&(this.#c=t,this.#d=await Nn._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#p())}toggleAltTextBadge(t=!1){if(!this.#h||this.#t){this.#o?.remove(),this.#o=null;return}if(!this.#o){const e=this.#o=document.createElement("div");e.className="noAltTextBadge",this.#u.div.append(e)}this.#o.classList.toggle("hidden",!t)}serialize(t){let e=this.#t;return!t&&this.#c===e&&(e=this.#d),{altText:e,decorative:this.#e,guessedText:this.#c,textWithDisclaimer:this.#d}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:e,guessedText:s,textWithDisclaimer:r,cancel:o=!1}){s&&(this.#c=s,this.#d=r),!(this.#t===t&&this.#e===e)&&(o||(this.#t=t,this.#e=e),this.#p())}toggle(t=!1){this.#n&&(!t&&this.#s&&(clearTimeout(this.#s),this.#s=null),this.#n.disabled=!t)}shown(){this.#u._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#a}})}destroy(){this.#n?.remove(),this.#n=null,this.#i=null,this.#r=null,this.#o?.remove(),this.#o=null}async#p(){const t=this.#n;if(!t)return;if(this.#h){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",Nn.#f[this.#a]),this.#i?.setAttribute("data-l10n-id",Nn.#f[`${this.#a}-label`]),!this.#t){this.#r?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#r?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=this.#r;if(!e){this.#r=e=document.createElement("span"),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${this.#u.id}`;const r=100,o=this.#u._uiManager._signal;o.addEventListener("abort",()=>{clearTimeout(this.#s),this.#s=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#s=setTimeout(()=>{this.#s=null,this.#r.classList.add("show"),this.#u._reportTelemetry({action:"alt_text_tooltip"})},r)},{signal:o}),t.addEventListener("mouseleave",()=>{this.#s&&(clearTimeout(this.#s),this.#s=null),this.#r?.classList.remove("show")},{signal:o})}this.#e?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=this.#t),e.parentNode||t.append(e),this.#u.getImageForAltText()?.setAttribute("aria-describedby",e.id)}}class vo{#t;#e=!1;#n=null;#i;#r;#s;#l;#o;#u=null;#c;#d=null;constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:s=null,onPinchStart:r=null,onPinching:o=null,onPinchEnd:l=null,signal:c}){this.#t=t,this.#n=s,this.#i=e,this.#r=r,this.#s=o,this.#l=l,this.#c=new AbortController,this.#o=AbortSignal.any([c,this.#c.signal]),t.addEventListener("touchstart",this.#h.bind(this),{passive:!1,signal:this.#o})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return Ot(this,"MIN_TOUCH_DISTANCE_TO_PINCH",35/(window.devicePixelRatio||1))}#h(t){if(this.#i?.()||t.touches.length<2)return;if(!this.#d){this.#d=new AbortController;const r=AbortSignal.any([this.#o,this.#d.signal]),o=this.#t,l={signal:r,passive:!1};o.addEventListener("touchmove",this.#f.bind(this),l),o.addEventListener("touchend",this.#a.bind(this),l),o.addEventListener("touchcancel",this.#a.bind(this),l),this.#r?.()}if(an(t),t.touches.length!==2||this.#n?.()){this.#u=null;return}let[e,s]=t.touches;e.identifier>s.identifier&&([e,s]=[s,e]),this.#u={touch0X:e.screenX,touch0Y:e.screenY,touch1X:s.screenX,touch1Y:s.screenY}}#f(t){if(!this.#u||t.touches.length!==2)return;let[e,s]=t.touches;e.identifier>s.identifier&&([e,s]=[s,e]);const{screenX:r,screenY:o}=e,{screenX:l,screenY:c}=s,h=this.#u,{touch0X:f,touch0Y:g,touch1X:v,touch1Y:y}=h,A=v-f,b=y-g,S=l-r,T=c-o,C=Math.hypot(S,T)||1,I=Math.hypot(A,b)||1;if(!this.#e&&Math.abs(I-C)<=vo.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(h.touch0X=r,h.touch0Y=o,h.touch1X=l,h.touch1Y=c,t.preventDefault(),!this.#e){this.#e=!0;return}const O=[(r+l)/2,(o+c)/2];this.#s?.(O,I,C)}#a(t){this.#d.abort(),this.#d=null,this.#l?.(),this.#u&&(t.preventDefault(),this.#u=null,this.#e=!1)}destroy(){this.#c?.abort(),this.#c=null}}class At{#t=null;#e=null;#n=null;#i=!1;#r=null;#s="";#l=!1;#o=null;#u=null;#c=null;#d=null;#h="";#f=!1;#a=null;#p=!1;#m=!1;#g=!1;#v=null;#A=0;#y=0;#b=null;#S=null;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#E=!1;#k=At._zIndex++;static _borderLineWidth=-1;static _colorManager=new Nc;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=At.prototype._resizeWithKeyboard,e=_i.TRANSLATE_SMALL,s=_i.TRANSLATE_BIG;return Ot(this,"_resizerKeyboardManager",new jr([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,s]}],[["Escape","mac+Escape"],At.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null;const{rotation:e,rawDims:{pageWidth:s,pageHeight:r,pageX:o,pageY:l}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,r],this.pageTranslation=[o,l];const[c,h]=this.parentDimensions;this.x=t.x/c,this.y=t.y/h,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return Ot(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new Mg({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(At._l10n??=t,At._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),At._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);At._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){Wt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#E}set _isDraggable(t){this.#E=t,this.div?.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#k}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):this.#z(),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#f?this.#f=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,s,r){const[o,l]=this.parentDimensions;[s,r]=this.screenToPageTranslation(s,r),this.x=(t+s)/o,this.y=(e+r)/l,this.fixAndSetPosition()}#P([t,e],s,r){[s,r]=this.screenToPageTranslation(s,r),this.x+=s/t,this.y+=r/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,e){this.#P(this.parentDimensions,t,e)}translateInPage(t,e){this.#a||=[this.x,this.y,this.width,this.height],this.#P(this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}drag(t,e){this.#a||=[this.x,this.y,this.width,this.height];const{div:s,parentDimensions:[r,o]}=this;if(this.x+=t/r,this.y+=e/o,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:v,y}=this.div.getBoundingClientRect();this.parent.findNewParent(this,v,y)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:l,y:c}=this;const[h,f]=this.getBaseTranslation();l+=h,c+=f;const{style:g}=s;g.left=`${(100*l).toFixed(2)}%`,g.top=`${(100*c).toFixed(2)}%`,this._onTranslating(l,c),s.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!this.#a&&(this.#a[0]!==this.x||this.#a[1]!==this.y)}get _hasBeenResized(){return!!this.#a&&(this.#a[2]!==this.width||this.#a[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:s}=At,r=s/t,o=s/e;switch(this.rotation){case 90:return[-r,o];case 180:return[r,o];case 270:return[r,-o];default:return[-r,-o]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[s,r]}=this;let{x:o,y:l,width:c,height:h}=this;if(c*=s,h*=r,o*=s,l*=r,this._mustFixPosition)switch(t){case 0:o=Math.max(0,Math.min(s-c,o)),l=Math.max(0,Math.min(r-h,l));break;case 90:o=Math.max(0,Math.min(s-h,o)),l=Math.min(r,Math.max(c,l));break;case 180:o=Math.min(s,Math.max(c,o)),l=Math.min(r,Math.max(h,l));break;case 270:o=Math.min(s,Math.max(h,o)),l=Math.max(0,Math.min(r-c,l));break}this.x=o/=s,this.y=l/=r;const[f,g]=this.getBaseTranslation();o+=f,l+=g,e.left=`${(100*o).toFixed(2)}%`,e.top=`${(100*l).toFixed(2)}%`,this.moveInDOM()}static#_(t,e,s){switch(s){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}}screenToPageTranslation(t,e){return At.#_(t,e,this.parentRotation)}pageTranslationToScreen(t,e){return At.#_(t,e,360-this.parentRotation)}#T(t){switch(t){case 90:{const[e,s]=this.pageDimensions;return[0,-e/s,s/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,s]=this.pageDimensions;return[0,e/s,-s/e,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,s]}=this;return[e*t,s*t]}setDims(t,e){const[s,r]=this.parentDimensions,{style:o}=this.div;o.width=`${(100*t/s).toFixed(2)}%`,this.#l||(o.height=`${(100*e/r).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:e,width:s}=t,r=s.endsWith("%"),o=!this.#l&&e.endsWith("%");if(r&&o)return;const[l,c]=this.parentDimensions;r||(t.width=`${(100*parseFloat(s)/l).toFixed(2)}%`),!this.#l&&!o&&(t.height=`${(100*parseFloat(e)/c).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#C(){if(this.#o)return;this.#o=document.createElement("div"),this.#o.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const s of t){const r=document.createElement("div");this.#o.append(r),r.classList.add("resizer",s),r.setAttribute("data-resizer-name",s),r.addEventListener("pointerdown",this.#M.bind(this,s),{signal:e}),r.addEventListener("contextmenu",En,{signal:e}),r.tabIndex=-1}this.div.prepend(this.#o)}#M(t,e){e.preventDefault();const{isMac:s}=Be.platform;if(e.button!==0||e.ctrlKey&&s)return;this.#n?.toggle(!1);const r=this._isDraggable;this._isDraggable=!1,this.#u=[e.screenX,e.screenY];const o=new AbortController,l=this._uiManager.combinedSignal(o);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#x.bind(this,t),{passive:!0,capture:!0,signal:l}),window.addEventListener("touchmove",an,{passive:!1,signal:l}),window.addEventListener("contextmenu",En,{signal:l}),this.#c={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const c=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const f=()=>{o.abort(),this.parent.togglePointerEvents(!0),this.#n?.toggle(!0),this._isDraggable=r,this.parent.div.style.cursor=c,this.div.style.cursor=h,this.#D()};window.addEventListener("pointerup",f,{signal:l}),window.addEventListener("blur",f,{signal:l})}#I(t,e,s,r){this.width=s,this.height=r,this.x=t,this.y=e;const[o,l]=this.parentDimensions;this.setDims(o*s,l*r),this.fixAndSetPosition(),this._onResized()}_onResized(){}#D(){if(!this.#c)return;const{savedX:t,savedY:e,savedWidth:s,savedHeight:r}=this.#c;this.#c=null;const o=this.x,l=this.y,c=this.width,h=this.height;o===t&&l===e&&c===s&&h===r||this.addCommands({cmd:this.#I.bind(this,o,l,c,h),undo:this.#I.bind(this,t,e,s,r),mustExec:!0})}static _round(t){return Math.round(t*1e4)/1e4}#x(t,e){const[s,r]=this.parentDimensions,o=this.x,l=this.y,c=this.width,h=this.height,f=At.MIN_SIZE/s,g=At.MIN_SIZE/r,v=this.#T(this.rotation),y=(Z,q)=>[v[0]*Z+v[2]*q,v[1]*Z+v[3]*q],A=this.#T(360-this.rotation),b=(Z,q)=>[A[0]*Z+A[2]*q,A[1]*Z+A[3]*q];let S,T,C=!1,I=!1;switch(t){case"topLeft":C=!0,S=(Z,q)=>[0,0],T=(Z,q)=>[Z,q];break;case"topMiddle":S=(Z,q)=>[Z/2,0],T=(Z,q)=>[Z/2,q];break;case"topRight":C=!0,S=(Z,q)=>[Z,0],T=(Z,q)=>[0,q];break;case"middleRight":I=!0,S=(Z,q)=>[Z,q/2],T=(Z,q)=>[0,q/2];break;case"bottomRight":C=!0,S=(Z,q)=>[Z,q],T=(Z,q)=>[0,0];break;case"bottomMiddle":S=(Z,q)=>[Z/2,q],T=(Z,q)=>[Z/2,0];break;case"bottomLeft":C=!0,S=(Z,q)=>[0,q],T=(Z,q)=>[Z,0];break;case"middleLeft":I=!0,S=(Z,q)=>[0,q/2],T=(Z,q)=>[Z,q/2];break}const O=S(c,h),j=T(c,h);let H=y(...j);const W=At._round(o+H[0]),V=At._round(l+H[1]);let it=1,X=1,Ct,ft;if(e.fromKeyboard)({deltaX:Ct,deltaY:ft}=e);else{const{screenX:Z,screenY:q}=e,[Y,nt]=this.#u;[Ct,ft]=this.screenToPageTranslation(Z-Y,q-nt),this.#u[0]=Z,this.#u[1]=q}if([Ct,ft]=b(Ct/s,ft/r),C){const Z=Math.hypot(c,h);it=X=Math.max(Math.min(Math.hypot(j[0]-O[0]-Ct,j[1]-O[1]-ft)/Z,1/c,1/h),f/c,g/h)}else I?it=Math.max(f,Math.min(1,Math.abs(j[0]-O[0]-Ct)))/c:X=Math.max(g,Math.min(1,Math.abs(j[1]-O[1]-ft)))/h;const Nt=At._round(c*it),Mt=At._round(h*X);H=y(...T(Nt,Mt));const Lt=W-H[0],Ut=V-H[1];this.#a||=[this.x,this.y,this.width,this.height],this.width=Nt,this.height=Mt,this.x=Lt,this.y=Ut,this.setDims(s*Nt,r*Mt),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#n?.finish()}async addEditToolbar(){return this._editToolbar||this.#m?this._editToolbar:(this._editToolbar=new Nr(this),this.div.append(this._editToolbar.render()),this.#n&&await this._editToolbar.addAltText(this.#n),this._editToolbar)}removeEditToolbar(){this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,this.#n?.destroy())}addContainer(t){const e=this._editToolbar?.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){this.#n||(Nn.initialize(At._l10n),this.#n=new Nn(this),this.#t&&(this.#n.data=this.#t,this.#t=null),await this.addEditToolbar())}get altTextData(){return this.#n?.data}set altTextData(t){this.#n&&(this.#n.data=t)}get guessedAltText(){return this.#n?.guessedText}async setGuessedAltText(t){await this.#n?.setGuessedText(t)}serializeAltText(t){return this.#n?.serialize(t)}hasAltText(){return!!this.#n&&!this.#n.isEmpty()}hasAltTextData(){return this.#n?.hasData()??!1}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=this.#i?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),this.#O();const[t,e]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*e/t).toFixed(2)}%`,this.div.style.maxHeight=`${(100*t/e).toFixed(2)}%`);const[s,r]=this.getInitialTranslation();return this.translate(s,r),lo(this,this.div,["pointerdown"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#S||=new vo({container:this.div,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#w.bind(this),onPinching:this.#N.bind(this),onPinchEnd:this.#B.bind(this),signal:this._uiManager._signal})),this._uiManager._editorUndoBar?.hide(),this.div}#w(){this.#c={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#n?.toggle(!1),this.parent.togglePointerEvents(!1)}#N(t,e,s){let o=.7*(s/e)+1-.7;if(o===1)return;const l=this.#T(this.rotation),c=(W,V)=>[l[0]*W+l[2]*V,l[1]*W+l[3]*V],[h,f]=this.parentDimensions,g=this.x,v=this.y,y=this.width,A=this.height,b=At.MIN_SIZE/h,S=At.MIN_SIZE/f;o=Math.max(Math.min(o,1/y,1/A),b/y,S/A);const T=At._round(y*o),C=At._round(A*o);if(T===y&&C===A)return;this.#a||=[g,v,y,A];const I=c(y/2,A/2),O=At._round(g+I[0]),j=At._round(v+I[1]),H=c(T/2,C/2);this.x=O-H[0],this.y=j-H[1],this.width=T,this.height=C,this.setDims(h*T,f*C),this.fixAndSetPosition(),this._onResizing()}#B(){this.#n?.toggle(!0),this.parent.togglePointerEvents(!0),this.#D()}pointerdown(t){const{isMac:e}=Be.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(this.#f=!0,this._isDraggable){this.#$(t);return}this.#U(t)}get isSelected(){return this._uiManager.isSelected(this)}#U(t){const{isMac:e}=Be.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}#$(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let s=!1;const r=new AbortController,o=this._uiManager.combinedSignal(r),l={capture:!0,passive:!1,signal:o},c=f=>{r.abort(),this.#r=null,this.#f=!1,this._uiManager.endDragSession()||this.#U(f),s&&this._onStopDragging()};e&&(this.#A=t.clientX,this.#y=t.clientY,this.#r=t.pointerId,this.#s=t.pointerType,window.addEventListener("pointermove",f=>{s||(s=!0,this._onStartDragging());const{clientX:g,clientY:v,pointerId:y}=f;if(y!==this.#r){an(f);return}const[A,b]=this.screenToPageTranslation(g-this.#A,v-this.#y);this.#A=g,this.#y=v,this._uiManager.dragSelectedEditors(A,b)},l),window.addEventListener("touchmove",an,l),window.addEventListener("pointerdown",f=>{f.pointerType===this.#s&&(this.#S||f.isPrimary)&&c(f),an(f)},l));const h=f=>{if(!this.#r||this.#r===f.pointerId){c(f);return}an(f)};window.addEventListener("pointerup",h,{signal:o}),window.addEventListener("blur",h,{signal:o})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#v&&clearTimeout(this.#v),this.#v=setTimeout(()=>{this.#v=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,e,s){t.changeParent(this),this.x=e,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,s=this.rotation){const r=this.parentScale,[o,l]=this.pageDimensions,[c,h]=this.pageTranslation,f=t/r,g=e/r,v=this.x*o,y=this.y*l,A=this.width*o,b=this.height*l;switch(s){case 0:return[v+f+c,l-y-g-b+h,v+f+A+c,l-y-g+h];case 90:return[v+g+c,l-y+f+h,v+g+b+c,l-y+f+A+h];case 180:return[v-f-A+c,l-y+g+h,v-f+c,l-y+g+b+h];case 270:return[v-g-b+c,l-y-f-A+h,v-g+c,l-y-f+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[s,r,o,l]=t,c=o-s,h=l-r;switch(this.rotation){case 0:return[s,e-l,c,h];case 90:return[s,e-r,h,c];case 180:return[o,e-r,c,h];case 270:return[o,e-l,h,c];default:throw new Error("Invalid rotation")}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){this.#m=!0}disableEditMode(){this.#m=!1}isInEditMode(){return this.#m}shouldGetKeyboardEvents(){return this.#g}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:s,right:r}=this.getClientDimensions(),{innerHeight:o,innerWidth:l}=window;return e<l&&r>0&&t<o&&s>0}#O(){if(this.#d||!this.div)return;this.#d=new AbortController;const t=this._uiManager.combinedSignal(this.#d);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#O()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,e=null){Wt("An editor must be serializable")}static async deserialize(t,e,s){const r=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:s});r.rotation=t.rotation,r.#t=t.accessibilityData;const[o,l]=r.pageDimensions,[c,h,f,g]=r.getRectInCurrentCoords(t.rect,l);return r.x=c/o,r.y=h/l,r.width=f/o,r.height=g/l,r}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#d?.abort(),this.#d=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#v&&(clearTimeout(this.#v),this.#v=null),this.#z(),this.removeEditToolbar(),this.#b){for(const t of this.#b.values())clearTimeout(t);this.#b=null}this.parent=null,this.#S?.destroy(),this.#S=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#C(),this.#o.classList.remove("hidden"),lo(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#c={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const e=this.#o.children;if(!this.#e){this.#e=Array.from(e);const l=this.#F.bind(this),c=this.#j.bind(this),h=this._uiManager._signal;for(const f of this.#e){const g=f.getAttribute("data-resizer-name");f.setAttribute("role","spinbutton"),f.addEventListener("keydown",l,{signal:h}),f.addEventListener("blur",c,{signal:h}),f.addEventListener("focus",this.#V.bind(this,g),{signal:h}),f.setAttribute("data-l10n-id",At._l10nResizer[g])}}const s=this.#e[0];let r=0;for(const l of e){if(l===s)break;r++}const o=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(o!==r){if(o<r)for(let c=0;c<r-o;c++)this.#o.append(this.#o.firstChild);else if(o>r)for(let c=0;c<o-r;c++)this.#o.firstChild.before(this.#o.lastChild);let l=0;for(const c of e){const f=this.#e[l++].getAttribute("data-resizer-name");c.setAttribute("data-l10n-id",At._l10nResizer[f])}}this.#L(0),this.#g=!0,this.#o.firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#F(t){At._resizerKeyboardManager.exec(this,t)}#j(t){this.#g&&t.relatedTarget?.parentNode!==this.#o&&this.#z()}#V(t){this.#h=this.#g?t:""}#L(t){if(this.#e)for(const e of this.#e)e.tabIndex=t}_resizeWithKeyboard(t,e){this.#g&&this.#x(this.#h,{deltaX:t,deltaY:e,fromKeyboard:!0})}#z(){this.#g=!1,this.#L(-1),this.#D()}_stopResizingWithKeyboard(){this.#z(),this.div.focus()}select(){if(this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#n?.toggleAltTextBadge(!1)}unselect(){this.#o?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#n?.toggleAltTextBadge(!0)}updateParams(t,e){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(t){this.#p=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,e){this.#l=!0;const s=t/e,{style:r}=this.div;r.aspectRatio=s,r.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){this.#b||=new Map;const{action:s}=t;let r=this.#b.get(s);r&&clearTimeout(r),r=setTimeout(()=>{this._reportTelemetry(t),this.#b.delete(s),this.#b.size===0&&(this.#b=null)},At._telemetryTimeout),this.#b.set(s,r);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#i=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#i=!0}renderAnnotationElement(t){let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const s=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),s.before(e)}return e}resetAnnotationElement(t){const{firstChild:e}=t.container;e?.nodeName==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}}class Mg extends At{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Ed=3285377520,gn=4294901760,Ln=65535;class Xd{constructor(t){this.h1=t?t&4294967295:Ed,this.h2=t?t&4294967295:Ed}update(t){let e,s;if(typeof t=="string"){e=new Uint8Array(t.length*2),s=0;for(let S=0,T=t.length;S<T;S++){const C=t.charCodeAt(S);C<=255?e[s++]=C:(e[s++]=C>>>8,e[s++]=C&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),s=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const r=s>>2,o=s-r*4,l=new Uint32Array(e.buffer,0,r);let c=0,h=0,f=this.h1,g=this.h2;const v=3432918353,y=461845907,A=v&Ln,b=y&Ln;for(let S=0;S<r;S++)S&1?(c=l[S],c=c*v&gn|c*A&Ln,c=c<<15|c>>>17,c=c*y&gn|c*b&Ln,f^=c,f=f<<13|f>>>19,f=f*5+3864292196):(h=l[S],h=h*v&gn|h*A&Ln,h=h<<15|h>>>17,h=h*y&gn|h*b&Ln,g^=h,g=g<<13|g>>>19,g=g*5+3864292196);switch(c=0,o){case 3:c^=e[r*4+2]<<16;case 2:c^=e[r*4+1]<<8;case 1:c^=e[r*4],c=c*v&gn|c*A&Ln,c=c<<15|c>>>17,c=c*y&gn|c*b&Ln,r&1?f^=c:g^=c}this.h1=f,this.h2=g}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&gn|t*36045&Ln,e=e*4283543511&gn|((e<<16|t>>>16)*2950163797&gn)>>>16,t^=e>>>1,t=t*444984403&gn|t*60499&Ln,e=e*3301882366&gn|((e<<16|t>>>16)*3120437893&gn)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const bc=Object.freeze({map:null,hash:"",transfer:void 0});class Ic{#t=!1;#e=null;#n=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const s=this.#n.get(t);return s===void 0?e:Object.assign(e,s)}getRawValue(t){return this.#n.get(t)}remove(t){if(this.#n.delete(t),this.#n.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const e of this.#n.values())if(e instanceof At)return;this.onAnnotationEditor(null)}}setValue(t,e){const s=this.#n.get(t);let r=!1;if(s!==void 0)for(const[o,l]of Object.entries(e))s[o]!==l&&(r=!0,s[o]=l);else r=!0,this.#n.set(t,e);r&&this.#i(),e instanceof At&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type)}has(t){return this.#n.has(t)}getAll(){return this.#n.size>0?kc(this.#n):null}setAll(t){for(const[e,s]of Object.entries(t))this.setValue(e,s)}get size(){return this.#n.size}#i(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new qd(this)}get serializable(){if(this.#n.size===0)return bc;const t=new Map,e=new Xd,s=[],r=Object.create(null);let o=!1;for(const[l,c]of this.#n){const h=c instanceof At?c.serialize(!1,r):c;h&&(t.set(l,h),e.update(`${l}:${JSON.stringify(h)}`),o||=!!h.bitmap)}if(o)for(const l of t.values())l.bitmap&&s.push(l.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:s}:bc}get editorStats(){let t=null;const e=new Map;for(const s of this.#n.values()){if(!(s instanceof At))continue;const r=s.telemetryFinalData;if(!r)continue;const{type:o}=r;e.has(o)||e.set(o,Object.getPrototypeOf(s).constructor),t||=Object.create(null);const l=t[o]||=new Map;for(const[c,h]of Object.entries(r)){if(c==="type")continue;let f=l.get(c);f||(f=new Map,l.set(c,f));const g=f.get(h)??0;f.set(h,g+1)}}for(const[s,r]of e)t[s]=r.computeTelemetryFinalData(t[s]);return t}resetModifiedIds(){this.#e=null}get modifiedIds(){if(this.#e)return this.#e;const t=[];for(const e of this.#n.values())!(e instanceof At)||!e.annotationElementId||!e.serialize()||t.push(e.annotationElementId);return this.#e={ids:new Set(t),hash:t.join(",")}}}class qd extends Ic{#t;constructor(t){super();const{map:e,hash:s,transfer:r}=t.serializable,o=structuredClone(e,r?{transfer:r}:null);this.#t={map:o,hash:s,transfer:r}}get print(){Wt("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return Ot(this,"modifiedIds",{ids:new Set,hash:""})}}class Lg{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,_inspectFont:e}){if(!(!t||this.#t.has(t.loadedName))){if(me(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:r,style:o}=t,l=new FontFace(s,r,o);this.addNativeFontFace(l);try{await l.load(),this.#t.add(s),e?.(t)}catch{Rt(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(l)}return}Wt("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const s=t.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(r){throw Rt(`Failed to load font '${s.family}': '${r}'.`),t.disableFontFace=!0,r}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const r=this._queueLoadingCallback(s);this._prepareFontLoadEvent(t,r)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return Ot(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){let t=!1;return(Fe||typeof navigator<"u"&&typeof navigator?.userAgent=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(t=!0),Ot(this,"isSyncFontLoadingSupported",t)}_queueLoadingCallback(t){function e(){for(me(!r.done,"completeRequest() cannot be called twice."),r.done=!0;s.length>0&&s[0].done;){const o=s.shift();setTimeout(o.callback,0)}}const{loadingRequests:s}=this,r={done:!1,complete:e,callback:t};return s.push(r),r}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Ot(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function s(j,H){return j.charCodeAt(H)<<24|j.charCodeAt(H+1)<<16|j.charCodeAt(H+2)<<8|j.charCodeAt(H+3)&255}function r(j,H,W,V){const it=j.substring(0,H),X=j.substring(H+W);return it+V+X}let o,l;const c=this._document.createElement("canvas");c.width=1,c.height=1;const h=c.getContext("2d");let f=0;function g(j,H){if(++f>30){Rt("Load test font never loaded."),H();return}if(h.font="30px "+j,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){H();return}setTimeout(g.bind(null,j,H))}const v=`lt${Date.now()}${this.loadTestFontId++}`;let y=this._loadTestFont;y=r(y,976,v.length,v);const b=16,S=1482184792;let T=s(y,b);for(o=0,l=v.length-3;o<l;o+=4)T=T-S+s(v,o)|0;o<v.length&&(T=T-S+s(v+"XXX",o)|0),y=r(y,b,4,vg(T));const C=`url(data:font/opentype;base64,${btoa(y)});`,I=`@font-face {font-family:"${v}";src:${C}}`;this.insertRule(I);const O=this._document.createElement("div");O.style.visibility="hidden",O.style.width=O.style.height="10px",O.style.position="absolute",O.style.top=O.style.left="0px";for(const j of[t.loadedName,v]){const H=this._document.createElement("span");H.textContent="Hi",H.style.fontFamily=j,O.append(H)}this._document.body.append(O),g(v,()=>{O.remove(),e.complete()})}}class Ng{constructor(t,{disableFontFace:e=!1,fontExtraProperties:s=!1,inspectFont:r=null}){this.compiledGlyphs=Object.create(null);for(const o in t)this[o]=t[o];this.disableFontFace=e===!0,this.fontExtraProperties=s===!0,this._inspectFont=r}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${Sg(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${t}}`}return this._inspectFont?.(this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const s=this.loadedName+"_path_"+e;let r;try{r=t.get(s)}catch(l){Rt(`getPathGenerator - ignoring character: "${l}".`)}const o=new Path2D(r||"");return this.fontExtraProperties||t.delete(s),this.compiledGlyphs[e]=o}}const to={DATA:1,ERROR:2},ge={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Cd(){}function Ke(p){if(p instanceof bi||p instanceof wc||p instanceof Fr||p instanceof _d||p instanceof oo||p instanceof lc)return p;switch(p instanceof Error||typeof p=="object"&&p!==null||Wt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),p.name){case"AbortException":return new bi(p.message);case"InvalidPDFException":return new wc(p.message);case"MissingPDFException":return new Fr(p.message);case"PasswordException":return new _d(p.message,p.code);case"UnexpectedResponseException":return new oo(p.message,p.status);case"UnknownErrorException":return new lc(p.message,p.details)}return new lc(p.message,p.toString())}class Mr{#t=new AbortController;constructor(t,e,s){this.sourceName=t,this.targetName=e,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){this.#i(t);return}if(t.callback){const s=t.callbackId,r=this.callbackCapabilities[s];if(!r)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],t.callback===to.DATA)r.resolve(t.data);else if(t.callback===to.ERROR)r.reject(Ke(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const s=this.sourceName,r=t.sourceName,o=this.comObj;Promise.try(e,t.data).then(function(l){o.postMessage({sourceName:s,targetName:r,callback:to.DATA,callbackId:t.callbackId,data:l})},function(l){o.postMessage({sourceName:s,targetName:r,callback:to.ERROR,callbackId:t.callbackId,reason:Ke(l)})});return}if(t.streamId){this.#n(t);return}e(t.data)}on(t,e){const s=this.actionHandler;if(s[t])throw new Error(`There is already an actionName called "${t}"`);s[t]=e}send(t,e,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},s)}sendWithPromise(t,e,s){const r=this.callbackId++,o=Promise.withResolvers();this.callbackCapabilities[r]=o;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:r,data:e},s)}catch(l){o.reject(l)}return o.promise}sendWithStream(t,e,s,r){const o=this.streamId++,l=this.sourceName,c=this.targetName,h=this.comObj;return new ReadableStream({start:f=>{const g=Promise.withResolvers();return this.streamControllers[o]={controller:f,startCall:g,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:l,targetName:c,action:t,streamId:o,data:e,desiredSize:f.desiredSize},r),g.promise},pull:f=>{const g=Promise.withResolvers();return this.streamControllers[o].pullCall=g,h.postMessage({sourceName:l,targetName:c,stream:ge.PULL,streamId:o,desiredSize:f.desiredSize}),g.promise},cancel:f=>{me(f instanceof Error,"cancel must have a valid reason");const g=Promise.withResolvers();return this.streamControllers[o].cancelCall=g,this.streamControllers[o].isClosed=!0,h.postMessage({sourceName:l,targetName:c,stream:ge.CANCEL,streamId:o,reason:Ke(f)}),g.promise}},s)}#n(t){const e=t.streamId,s=this.sourceName,r=t.sourceName,o=this.comObj,l=this,c=this.actionHandler[t.action],h={enqueue(f,g=1,v){if(this.isCancelled)return;const y=this.desiredSize;this.desiredSize-=g,y>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),o.postMessage({sourceName:s,targetName:r,stream:ge.ENQUEUE,streamId:e,chunk:f},v)},close(){this.isCancelled||(this.isCancelled=!0,o.postMessage({sourceName:s,targetName:r,stream:ge.CLOSE,streamId:e}),delete l.streamSinks[e])},error(f){me(f instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,o.postMessage({sourceName:s,targetName:r,stream:ge.ERROR,streamId:e,reason:Ke(f)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[e]=h,Promise.try(c,t.data,h).then(function(){o.postMessage({sourceName:s,targetName:r,stream:ge.START_COMPLETE,streamId:e,success:!0})},function(f){o.postMessage({sourceName:s,targetName:r,stream:ge.START_COMPLETE,streamId:e,reason:Ke(f)})})}#i(t){const e=t.streamId,s=this.sourceName,r=t.sourceName,o=this.comObj,l=this.streamControllers[e],c=this.streamSinks[e];switch(t.stream){case ge.START_COMPLETE:t.success?l.startCall.resolve():l.startCall.reject(Ke(t.reason));break;case ge.PULL_COMPLETE:t.success?l.pullCall.resolve():l.pullCall.reject(Ke(t.reason));break;case ge.PULL:if(!c){o.postMessage({sourceName:s,targetName:r,stream:ge.PULL_COMPLETE,streamId:e,success:!0});break}c.desiredSize<=0&&t.desiredSize>0&&c.sinkCapability.resolve(),c.desiredSize=t.desiredSize,Promise.try(c.onPull||Cd).then(function(){o.postMessage({sourceName:s,targetName:r,stream:ge.PULL_COMPLETE,streamId:e,success:!0})},function(f){o.postMessage({sourceName:s,targetName:r,stream:ge.PULL_COMPLETE,streamId:e,reason:Ke(f)})});break;case ge.ENQUEUE:if(me(l,"enqueue should have stream controller"),l.isClosed)break;l.controller.enqueue(t.chunk);break;case ge.CLOSE:if(me(l,"close should have stream controller"),l.isClosed)break;l.isClosed=!0,l.controller.close(),this.#r(l,e);break;case ge.ERROR:me(l,"error should have stream controller"),l.controller.error(Ke(t.reason)),this.#r(l,e);break;case ge.CANCEL_COMPLETE:t.success?l.cancelCall.resolve():l.cancelCall.reject(Ke(t.reason)),this.#r(l,e);break;case ge.CANCEL:if(!c)break;const h=Ke(t.reason);Promise.try(c.onCancel||Cd,h).then(function(){o.postMessage({sourceName:s,targetName:r,stream:ge.CANCEL_COMPLETE,streamId:e,success:!0})},function(f){o.postMessage({sourceName:s,targetName:r,stream:ge.CANCEL_COMPLETE,streamId:e,reason:Ke(f)})}),c.sinkCapability.reject(h),c.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}}async#r(t,e){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[e]}destroy(){this.#t?.abort(),this.#t=null}}class Yd{#t=!1;constructor({enableHWA:t=!1}){this.#t=t}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(t,e);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!this.#t})}}reset(t,e,s){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||s<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=s}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){Wt("Abstract method `_createCanvas` called.")}}class Ig extends Yd{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const s=this._document.createElement("canvas");return s.width=t,s.height=e,s}}class Kd{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){Wt("Abstract method `_fetch` called.")}}class Qd extends Kd{async _fetch(t){const e=await go(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):po(e)}}class Zd{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,s,r,o){return"none"}destroy(t=!1){}}class Fg extends Zd{#t;#e;#n;#i;#r;#s;#l=0;constructor({docId:t,ownerDocument:e=globalThis.document}){super(),this.#i=t,this.#r=e}get#o(){return this.#e||=new Map}get#u(){return this.#s||=new Map}get#c(){if(!this.#n){const t=this.#r.createElement("div"),{style:e}=t;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const s=this.#r.createElementNS(Xn,"svg");s.setAttribute("width",0),s.setAttribute("height",0),this.#n=this.#r.createElementNS(Xn,"defs"),t.append(s),s.append(this.#n),this.#r.body.append(t)}return this.#n}#d(t){if(t.length===1){const h=t[0],f=new Array(256);for(let v=0;v<256;v++)f[v]=h[v]/255;const g=f.join(",");return[g,g,g]}const[e,s,r]=t,o=new Array(256),l=new Array(256),c=new Array(256);for(let h=0;h<256;h++)o[h]=e[h]/255,l[h]=s[h]/255,c[h]=r[h]/255;return[o.join(","),l.join(","),c.join(",")]}#h(t){if(this.#t===void 0){this.#t="";const e=this.#r.URL;e!==this.#r.baseURI&&(mo(e)?Rt('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=e.split("#",1)[0])}return`url(${this.#t}#${t})`}addFilter(t){if(!t)return"none";let e=this.#o.get(t);if(e)return e;const[s,r,o]=this.#d(t),l=t.length===1?s:`${s}${r}${o}`;if(e=this.#o.get(l),e)return this.#o.set(t,e),e;const c=`g_${this.#i}_transfer_map_${this.#l++}`,h=this.#h(c);this.#o.set(t,h),this.#o.set(l,h);const f=this.#p(c);return this.#g(s,r,o,f),h}addHCMFilter(t,e){const s=`${t}-${e}`,r="base";let o=this.#u.get(r);if(o?.key===s||(o?(o.filter?.remove(),o.key=s,o.url="none",o.filter=null):(o={key:s,url:"none",filter:null},this.#u.set(r,o)),!t||!e))return o.url;const l=this.#A(t);t=ht.makeHexColor(...l);const c=this.#A(e);if(e=ht.makeHexColor(...c),this.#c.style.color="",t==="#000000"&&e==="#ffffff"||t===e)return o.url;const h=new Array(256);for(let A=0;A<=255;A++){const b=A/255;h[A]=b<=.03928?b/12.92:((b+.055)/1.055)**2.4}const f=h.join(","),g=`g_${this.#i}_hcm_filter`,v=o.filter=this.#p(g);this.#g(f,f,f,v),this.#a(v);const y=(A,b)=>{const S=l[A]/255,T=c[A]/255,C=new Array(b+1);for(let I=0;I<=b;I++)C[I]=S+I/b*(T-S);return C.join(",")};return this.#g(y(0,5),y(1,5),y(2,5),v),o.url=this.#h(g),o.url}addAlphaFilter(t){let e=this.#o.get(t);if(e)return e;const[s]=this.#d([t]),r=`alpha_${s}`;if(e=this.#o.get(r),e)return this.#o.set(t,e),e;const o=`g_${this.#i}_alpha_map_${this.#l++}`,l=this.#h(o);this.#o.set(t,l),this.#o.set(r,l);const c=this.#p(o);return this.#v(s,c),l}addLuminosityFilter(t){let e=this.#o.get(t||"luminosity");if(e)return e;let s,r;if(t?([s]=this.#d([t]),r=`luminosity_${s}`):r="luminosity",e=this.#o.get(r),e)return this.#o.set(t,e),e;const o=`g_${this.#i}_luminosity_map_${this.#l++}`,l=this.#h(o);this.#o.set(t,l),this.#o.set(r,l);const c=this.#p(o);return this.#f(c),t&&this.#v(s,c),l}addHighlightHCMFilter(t,e,s,r,o){const l=`${e}-${s}-${r}-${o}`;let c=this.#u.get(t);if(c?.key===l||(c?(c.filter?.remove(),c.key=l,c.url="none",c.filter=null):(c={key:l,url:"none",filter:null},this.#u.set(t,c)),!e||!s))return c.url;const[h,f]=[e,s].map(this.#A.bind(this));let g=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),v=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),[y,A]=[r,o].map(this.#A.bind(this));v<g&&([g,v,y,A]=[v,g,A,y]),this.#c.style.color="";const b=(C,I,O)=>{const j=new Array(256),H=(v-g)/O,W=C/255,V=(I-C)/(255*O);let it=0;for(let X=0;X<=O;X++){const Ct=Math.round(g+X*H),ft=W+X*V;for(let Nt=it;Nt<=Ct;Nt++)j[Nt]=ft;it=Ct+1}for(let X=it;X<256;X++)j[X]=j[it-1];return j.join(",")},S=`g_${this.#i}_hcm_${t}_filter`,T=c.filter=this.#p(S);return this.#a(T),this.#g(b(y[0],A[0],5),b(y[1],A[1],5),b(y[2],A[2],5),T),c.url=this.#h(S),c.url}destroy(t=!1){t&&this.#s?.size||(this.#n?.parentNode.parentNode.remove(),this.#n=null,this.#e?.clear(),this.#e=null,this.#s?.clear(),this.#s=null,this.#l=0)}#f(t){const e=this.#r.createElementNS(Xn,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(e)}#a(t){const e=this.#r.createElementNS(Xn,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(e)}#p(t){const e=this.#r.createElementNS(Xn,"filter");return e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("id",t),this.#c.append(e),e}#m(t,e,s){const r=this.#r.createElementNS(Xn,e);r.setAttribute("type","discrete"),r.setAttribute("tableValues",s),t.append(r)}#g(t,e,s,r){const o=this.#r.createElementNS(Xn,"feComponentTransfer");r.append(o),this.#m(o,"feFuncR",t),this.#m(o,"feFuncG",e),this.#m(o,"feFuncB",s)}#v(t,e){const s=this.#r.createElementNS(Xn,"feComponentTransfer");e.append(s),this.#m(s,"feFuncA",t)}#A(t){return this.#c.style.color=t,Mc(getComputedStyle(this.#c).getPropertyValue("color"))}}class Jd{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(s=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){Wt("Abstract method `_fetch` called.")}}class tf extends Jd{async _fetch(t){const e=await go(t,"arraybuffer");return new Uint8Array(e)}}Fe&&Rt("Please use the `legacy` build in Node.js environments.");async function ef(p){const e=await process.getBuiltinModule("fs").promises.readFile(p);return new Uint8Array(e)}class Dg extends Zd{}class Og extends Yd{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class jg extends Kd{async _fetch(t){return ef(t)}}class zg extends Jd{async _fetch(t){return ef(t)}}const Ie={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function _c(p,t){if(!t)return;const e=t[2]-t[0],s=t[3]-t[1],r=new Path2D;r.rect(t[0],t[1],e,s),p.clip(r)}class Fc{getPattern(){Wt("Abstract method `getPattern` called.")}}class Hg extends Fc{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;this._type==="axial"?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)e.addColorStop(s[0],s[1]);return e}getPattern(t,e,s,r){let o;if(r===Ie.STROKE||r===Ie.FILL){const l=e.current.getClippedPathBoundingBox(r,ie(t))||[0,0,0,0],c=Math.ceil(l[2]-l[0])||1,h=Math.ceil(l[3]-l[1])||1,f=e.cachedCanvases.getCanvas("pattern",c,h),g=f.context;g.clearRect(0,0,g.canvas.width,g.canvas.height),g.beginPath(),g.rect(0,0,g.canvas.width,g.canvas.height),g.translate(-l[0],-l[1]),s=ht.transform(s,[1,0,0,1,l[0],l[1]]),g.transform(...e.baseTransform),this.matrix&&g.transform(...this.matrix),_c(g,this._bbox),g.fillStyle=this._createGradient(g),g.fill(),o=t.createPattern(f.canvas,"no-repeat");const v=new DOMMatrix(s);o.setTransform(v)}else _c(t,this._bbox),o=this._createGradient(t);return o}}function hc(p,t,e,s,r,o,l,c){const h=t.coords,f=t.colors,g=p.data,v=p.width*4;let y;h[e+1]>h[s+1]&&(y=e,e=s,s=y,y=o,o=l,l=y),h[s+1]>h[r+1]&&(y=s,s=r,r=y,y=l,l=c,c=y),h[e+1]>h[s+1]&&(y=e,e=s,s=y,y=o,o=l,l=y);const A=(h[e]+t.offsetX)*t.scaleX,b=(h[e+1]+t.offsetY)*t.scaleY,S=(h[s]+t.offsetX)*t.scaleX,T=(h[s+1]+t.offsetY)*t.scaleY,C=(h[r]+t.offsetX)*t.scaleX,I=(h[r+1]+t.offsetY)*t.scaleY;if(b>=I)return;const O=f[o],j=f[o+1],H=f[o+2],W=f[l],V=f[l+1],it=f[l+2],X=f[c],Ct=f[c+1],ft=f[c+2],Nt=Math.round(b),Mt=Math.round(I);let Lt,Ut,Z,q,Y,nt,Q,M;for(let z=Nt;z<=Mt;z++){if(z<T){const dt=z<b?0:(b-z)/(b-T);Lt=A-(A-S)*dt,Ut=O-(O-W)*dt,Z=j-(j-V)*dt,q=H-(H-it)*dt}else{let dt;z>I?dt=1:T===I?dt=0:dt=(T-z)/(T-I),Lt=S-(S-C)*dt,Ut=W-(W-X)*dt,Z=V-(V-Ct)*dt,q=it-(it-ft)*dt}let J;z<b?J=0:z>I?J=1:J=(b-z)/(b-I),Y=A-(A-C)*J,nt=O-(O-X)*J,Q=j-(j-Ct)*J,M=H-(H-ft)*J;const vt=Math.round(Math.min(Lt,Y)),xt=Math.round(Math.max(Lt,Y));let pt=v*z+vt*4;for(let dt=vt;dt<=xt;dt++)J=(Lt-dt)/(Lt-Y),J<0?J=0:J>1&&(J=1),g[pt++]=Ut-(Ut-nt)*J|0,g[pt++]=Z-(Z-Q)*J|0,g[pt++]=q-(q-M)*J|0,g[pt++]=255}}function Bg(p,t,e){const s=t.coords,r=t.colors;let o,l;switch(t.type){case"lattice":const c=t.verticesPerRow,h=Math.floor(s.length/c)-1,f=c-1;for(o=0;o<h;o++){let g=o*c;for(let v=0;v<f;v++,g++)hc(p,e,s[g],s[g+1],s[g+c],r[g],r[g+1],r[g+c]),hc(p,e,s[g+c+1],s[g+1],s[g+c],r[g+c+1],r[g+1],r[g+c])}break;case"triangles":for(o=0,l=s.length;o<l;o+=3)hc(p,e,s[o],s[o+1],s[o+2],r[o],r[o+1],r[o+2]);break;default:throw new Error("illegal figure")}}class Ug extends Fc{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[7],this._background=t[8],this.matrix=null}_createMeshCanvas(t,e,s){const c=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),f=Math.ceil(this._bounds[2])-c,g=Math.ceil(this._bounds[3])-h,v=Math.min(Math.ceil(Math.abs(f*t[0]*1.1)),3e3),y=Math.min(Math.ceil(Math.abs(g*t[1]*1.1)),3e3),A=f/v,b=g/y,S={coords:this._coords,colors:this._colors,offsetX:-c,offsetY:-h,scaleX:1/A,scaleY:1/b},T=v+4,C=y+4,I=s.getCanvas("mesh",T,C),O=I.context,j=O.createImageData(v,y);if(e){const W=j.data;for(let V=0,it=W.length;V<it;V+=4)W[V]=e[0],W[V+1]=e[1],W[V+2]=e[2],W[V+3]=255}for(const W of this._figures)Bg(j,W,S);return O.putImageData(j,2,2),{canvas:I.canvas,offsetX:c-2*A,offsetY:h-2*b,scaleX:A,scaleY:b}}getPattern(t,e,s,r){_c(t,this._bbox);let o;if(r===Ie.SHADING)o=ht.singularValueDecompose2dScale(ie(t));else if(o=ht.singularValueDecompose2dScale(e.baseTransform),this.matrix){const c=ht.singularValueDecompose2dScale(this.matrix);o=[o[0]*c[0],o[1]*c[1]]}const l=this._createMeshCanvas(o,r===Ie.SHADING?null:this._background,e.cachedCanvases);return r!==Ie.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(l.offsetX,l.offsetY),t.scale(l.scaleX,l.scaleY),t.createPattern(l.canvas,"no-repeat")}}class $g extends Fc{getPattern(){return"hotpink"}}function Vg(p){switch(p[0]){case"RadialAxial":return new Hg(p);case"Mesh":return new Ug(p);case"Dummy":return new $g}throw new Error(`Unknown IR type: ${p[0]}`)}const kd={COLORED:1,UNCOLORED:2};class Dc{static MAX_PATTERN_SIZE=3e3;constructor(t,e,s,r,o){this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.color=e,this.ctx=s,this.canvasGraphicsFactory=r,this.baseTransform=o}createPatternCanvas(t){const{bbox:e,operatorList:s,paintType:r,tilingType:o,color:l,canvasGraphicsFactory:c}=this;let{xstep:h,ystep:f}=this;h=Math.abs(h),f=Math.abs(f),fo("TilingType: "+o);const g=e[0],v=e[1],y=e[2],A=e[3],b=y-g,S=A-v,T=ht.singularValueDecompose2dScale(this.matrix),C=ht.singularValueDecompose2dScale(this.baseTransform),I=T[0]*C[0],O=T[1]*C[1];let j=b,H=S,W=!1,V=!1;const it=Math.ceil(h*I),X=Math.ceil(f*O),Ct=Math.ceil(b*I),ft=Math.ceil(S*O);it>=Ct?j=h:W=!0,X>=ft?H=f:V=!0;const Nt=this.getSizeAndScale(j,this.ctx.canvas.width,I),Mt=this.getSizeAndScale(H,this.ctx.canvas.height,O),Lt=t.cachedCanvases.getCanvas("pattern",Nt.size,Mt.size),Ut=Lt.context,Z=c.createCanvasGraphics(Ut);if(Z.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(Z,r,l),Ut.translate(-Nt.scale*g,-Mt.scale*v),Z.transform(Nt.scale,0,0,Mt.scale,0,0),Ut.save(),this.clipBbox(Z,g,v,y,A),Z.baseTransform=ie(Z.ctx),Z.executeOperatorList(s),Z.endDrawing(),Ut.restore(),W||V){const q=Lt.canvas;W&&(j=h),V&&(H=f);const Y=this.getSizeAndScale(j,this.ctx.canvas.width,I),nt=this.getSizeAndScale(H,this.ctx.canvas.height,O),Q=Y.size,M=nt.size,z=t.cachedCanvases.getCanvas("pattern-workaround",Q,M),J=z.context,vt=W?Math.floor(b/h):0,xt=V?Math.floor(S/f):0;for(let pt=0;pt<=vt;pt++)for(let dt=0;dt<=xt;dt++)J.drawImage(q,Q*pt,M*dt,Q,M,0,0,Q,M);return{canvas:z.canvas,scaleX:Y.scale,scaleY:nt.scale,offsetX:g,offsetY:v}}return{canvas:Lt.canvas,scaleX:Nt.scale,scaleY:Mt.scale,offsetX:g,offsetY:v}}getSizeAndScale(t,e,s){const r=Math.max(Dc.MAX_PATTERN_SIZE,e);let o=Math.ceil(t*s);return o>=r?o=r:s=o/t,{scale:s,size:o}}clipBbox(t,e,s,r,o){const l=r-e,c=o-s;t.ctx.rect(e,s,l,c),t.current.updateRectMinMax(ie(t.ctx),[e,s,r,o]),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,s){const r=t.ctx,o=t.current;switch(e){case kd.COLORED:const l=this.ctx;r.fillStyle=l.fillStyle,r.strokeStyle=l.strokeStyle,o.fillColor=l.fillStyle,o.strokeColor=l.strokeStyle;break;case kd.UNCOLORED:const c=ht.makeHexColor(s[0],s[1],s[2]);r.fillStyle=c,r.strokeStyle=c,o.fillColor=c,o.strokeColor=c;break;default:throw new mg(`Unsupported paint type: ${e}`)}}getPattern(t,e,s,r){let o=s;r!==Ie.SHADING&&(o=ht.transform(o,e.baseTransform),this.matrix&&(o=ht.transform(o,this.matrix)));const l=this.createPatternCanvas(e);let c=new DOMMatrix(o);c=c.translate(l.offsetX,l.offsetY),c=c.scale(1/l.scaleX,1/l.scaleY);const h=t.createPattern(l.canvas,"repeat");return h.setTransform(c),h}}function Gg({src:p,srcPos:t=0,dest:e,width:s,height:r,nonBlackColor:o=4294967295,inverseDecode:l=!1}){const c=Be.isLittleEndian?4278190080:255,[h,f]=l?[o,c]:[c,o],g=s>>3,v=s&7,y=p.length;e=new Uint32Array(e.buffer);let A=0;for(let b=0;b<r;b++){for(const T=t+g;t<T;t++){const C=t<y?p[t]:255;e[A++]=C&128?f:h,e[A++]=C&64?f:h,e[A++]=C&32?f:h,e[A++]=C&16?f:h,e[A++]=C&8?f:h,e[A++]=C&4?f:h,e[A++]=C&2?f:h,e[A++]=C&1?f:h}if(v===0)continue;const S=t<y?p[t++]:255;for(let T=0;T<v;T++)e[A++]=S&1<<7-T?f:h}return{srcPos:t,destPos:A}}const Td=16,Pd=100,Wg=15,Rd=10,Md=1e3,Qe=16;function Xg(p,t){if(p._removeMirroring)throw new Error("Context is already forwarding operations.");p.__originalSave=p.save,p.__originalRestore=p.restore,p.__originalRotate=p.rotate,p.__originalScale=p.scale,p.__originalTranslate=p.translate,p.__originalTransform=p.transform,p.__originalSetTransform=p.setTransform,p.__originalResetTransform=p.resetTransform,p.__originalClip=p.clip,p.__originalMoveTo=p.moveTo,p.__originalLineTo=p.lineTo,p.__originalBezierCurveTo=p.bezierCurveTo,p.__originalRect=p.rect,p.__originalClosePath=p.closePath,p.__originalBeginPath=p.beginPath,p._removeMirroring=()=>{p.save=p.__originalSave,p.restore=p.__originalRestore,p.rotate=p.__originalRotate,p.scale=p.__originalScale,p.translate=p.__originalTranslate,p.transform=p.__originalTransform,p.setTransform=p.__originalSetTransform,p.resetTransform=p.__originalResetTransform,p.clip=p.__originalClip,p.moveTo=p.__originalMoveTo,p.lineTo=p.__originalLineTo,p.bezierCurveTo=p.__originalBezierCurveTo,p.rect=p.__originalRect,p.closePath=p.__originalClosePath,p.beginPath=p.__originalBeginPath,delete p._removeMirroring},p.save=function(){t.save(),this.__originalSave()},p.restore=function(){t.restore(),this.__originalRestore()},p.translate=function(s,r){t.translate(s,r),this.__originalTranslate(s,r)},p.scale=function(s,r){t.scale(s,r),this.__originalScale(s,r)},p.transform=function(s,r,o,l,c,h){t.transform(s,r,o,l,c,h),this.__originalTransform(s,r,o,l,c,h)},p.setTransform=function(s,r,o,l,c,h){t.setTransform(s,r,o,l,c,h),this.__originalSetTransform(s,r,o,l,c,h)},p.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},p.rotate=function(s){t.rotate(s),this.__originalRotate(s)},p.clip=function(s){t.clip(s),this.__originalClip(s)},p.moveTo=function(e,s){t.moveTo(e,s),this.__originalMoveTo(e,s)},p.lineTo=function(e,s){t.lineTo(e,s),this.__originalLineTo(e,s)},p.bezierCurveTo=function(e,s,r,o,l,c){t.bezierCurveTo(e,s,r,o,l,c),this.__originalBezierCurveTo(e,s,r,o,l,c)},p.rect=function(e,s,r,o){t.rect(e,s,r,o),this.__originalRect(e,s,r,o)},p.closePath=function(){t.closePath(),this.__originalClosePath()},p.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class qg{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,s){let r;return this.cache[t]!==void 0?(r=this.cache[t],this.canvasFactory.reset(r,e,s)):(r=this.canvasFactory.create(e,s),this.cache[t]=r),r}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function eo(p,t,e,s,r,o,l,c,h,f){const[g,v,y,A,b,S]=ie(p);if(v===0&&y===0){const I=l*g+b,O=Math.round(I),j=c*A+S,H=Math.round(j),W=(l+h)*g+b,V=Math.abs(Math.round(W)-O)||1,it=(c+f)*A+S,X=Math.abs(Math.round(it)-H)||1;return p.setTransform(Math.sign(g),0,0,Math.sign(A),O,H),p.drawImage(t,e,s,r,o,0,0,V,X),p.setTransform(g,v,y,A,b,S),[V,X]}if(g===0&&A===0){const I=c*y+b,O=Math.round(I),j=l*v+S,H=Math.round(j),W=(c+f)*y+b,V=Math.abs(Math.round(W)-O)||1,it=(l+h)*v+S,X=Math.abs(Math.round(it)-H)||1;return p.setTransform(0,Math.sign(v),Math.sign(y),0,O,H),p.drawImage(t,e,s,r,o,0,0,X,V),p.setTransform(g,v,y,A,b,S),[X,V]}p.drawImage(t,e,s,r,o,l,c,h,f);const T=Math.hypot(g,v),C=Math.hypot(y,A);return[T*h,C*f]}function Yg(p){const{width:t,height:e}=p;if(t>Md||e>Md)return null;const s=1e3,r=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),o=t+1;let l=new Uint8Array(o*(e+1)),c,h,f;const g=t+7&-8;let v=new Uint8Array(g*e),y=0;for(const C of p.data){let I=128;for(;I>0;)v[y++]=C&I?0:255,I>>=1}let A=0;for(y=0,v[y]!==0&&(l[0]=1,++A),h=1;h<t;h++)v[y]!==v[y+1]&&(l[h]=v[y]?2:1,++A),y++;for(v[y]!==0&&(l[h]=2,++A),c=1;c<e;c++){y=c*g,f=c*o,v[y-g]!==v[y]&&(l[f]=v[y]?1:8,++A);let C=(v[y]?4:0)+(v[y-g]?8:0);for(h=1;h<t;h++)C=(C>>2)+(v[y+1]?4:0)+(v[y-g+1]?8:0),r[C]&&(l[f+h]=r[C],++A),y++;if(v[y-g]!==v[y]&&(l[f+h]=v[y]?2:4,++A),A>s)return null}for(y=g*(e-1),f=c*o,v[y]!==0&&(l[f]=8,++A),h=1;h<t;h++)v[y]!==v[y+1]&&(l[f+h]=v[y]?4:8,++A),y++;if(v[y]!==0&&(l[f+h]=4,++A),A>s)return null;const b=new Int32Array([0,o,-1,0,-o,0,0,0,1]),S=new Path2D;for(c=0;A&&c<=e;c++){let C=c*o;const I=C+t;for(;C<I&&!l[C];)C++;if(C===I)continue;S.moveTo(C%o,c);const O=C;let j=l[C];do{const H=b[j];do C+=H;while(!l[C]);const W=l[C];W!==5&&W!==10?(j=W,l[C]=0):(j=W&51*j>>4,l[C]&=j>>2|j<<2),S.lineTo(C%o,C/o|0),l[C]||--A}while(O!==C);--c}return v=null,l=null,function(C){C.save(),C.scale(1/t,-1/e),C.translate(0,-e),C.fill(S),C.beginPath(),C.restore()}}class Ld{constructor(t,e){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=Vd,this.textMatrixScale=1,this.fontMatrix=yc,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=Ne.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,t,e])}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t}setCurrentPoint(t,e){this.x=t,this.y=e}updatePathMinMax(t,e,s){[e,s]=ht.applyTransform([e,s],t),this.minX=Math.min(this.minX,e),this.minY=Math.min(this.minY,s),this.maxX=Math.max(this.maxX,e),this.maxY=Math.max(this.maxY,s)}updateRectMinMax(t,e){const s=ht.applyTransform(e,t),r=ht.applyTransform(e.slice(2),t),o=ht.applyTransform([e[0],e[3]],t),l=ht.applyTransform([e[2],e[1]],t);this.minX=Math.min(this.minX,s[0],r[0],o[0],l[0]),this.minY=Math.min(this.minY,s[1],r[1],o[1],l[1]),this.maxX=Math.max(this.maxX,s[0],r[0],o[0],l[0]),this.maxY=Math.max(this.maxY,s[1],r[1],o[1],l[1])}updateScalingPathMinMax(t,e){ht.scaleMinMax(t,e),this.minX=Math.min(this.minX,e[0]),this.minY=Math.min(this.minY,e[1]),this.maxX=Math.max(this.maxX,e[2]),this.maxY=Math.max(this.maxY,e[3])}updateCurvePathMinMax(t,e,s,r,o,l,c,h,f,g){const v=ht.bezierBoundingBox(e,s,r,o,l,c,h,f,g);g||this.updateRectMinMax(t,v)}getPathBoundingBox(t=Ie.FILL,e=null){const s=[this.minX,this.minY,this.maxX,this.maxY];if(t===Ie.STROKE){e||Wt("Stroke bounding box must include transform.");const r=ht.singularValueDecompose2dScale(e),o=r[0]*this.lineWidth/2,l=r[1]*this.lineWidth/2;s[0]-=o,s[1]-=l,s[2]+=o,s[3]+=l}return s}updateClipFromPath(){const t=ht.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(t){this.clipBox=t,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(t=Ie.FILL,e=null){return ht.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function Nd(p,t){if(t instanceof ImageData){p.putImageData(t,0,0);return}const e=t.height,s=t.width,r=e%Qe,o=(e-r)/Qe,l=r===0?o:o+1,c=p.createImageData(s,Qe);let h=0,f;const g=t.data,v=c.data;let y,A,b,S;if(t.kind===so.GRAYSCALE_1BPP){const T=g.byteLength,C=new Uint32Array(v.buffer,0,v.byteLength>>2),I=C.length,O=s+7>>3,j=4294967295,H=Be.isLittleEndian?4278190080:255;for(y=0;y<l;y++){for(b=y<o?Qe:r,f=0,A=0;A<b;A++){const W=T-h;let V=0;const it=W>O?s:W*8-7,X=it&-8;let Ct=0,ft=0;for(;V<X;V+=8)ft=g[h++],C[f++]=ft&128?j:H,C[f++]=ft&64?j:H,C[f++]=ft&32?j:H,C[f++]=ft&16?j:H,C[f++]=ft&8?j:H,C[f++]=ft&4?j:H,C[f++]=ft&2?j:H,C[f++]=ft&1?j:H;for(;V<it;V++)Ct===0&&(ft=g[h++],Ct=128),C[f++]=ft&Ct?j:H,Ct>>=1}for(;f<I;)C[f++]=0;p.putImageData(c,0,y*Qe)}}else if(t.kind===so.RGBA_32BPP){for(A=0,S=s*Qe*4,y=0;y<o;y++)v.set(g.subarray(h,h+S)),h+=S,p.putImageData(c,0,A),A+=Qe;y<l&&(S=s*r*4,v.set(g.subarray(h,h+S)),p.putImageData(c,0,A))}else if(t.kind===so.RGB_24BPP)for(b=Qe,S=s*b,y=0;y<l;y++){for(y>=o&&(b=r,S=s*b),f=0,A=S;A--;)v[f++]=g[h++],v[f++]=g[h++],v[f++]=g[h++],v[f++]=255;p.putImageData(c,0,y*Qe)}else throw new Error(`bad image kind: ${t.kind}`)}function Id(p,t){if(t.bitmap){p.drawImage(t.bitmap,0,0);return}const e=t.height,s=t.width,r=e%Qe,o=(e-r)/Qe,l=r===0?o:o+1,c=p.createImageData(s,Qe);let h=0;const f=t.data,g=c.data;for(let v=0;v<l;v++){const y=v<o?Qe:r;({srcPos:h}=Gg({src:f,srcPos:h,dest:g,width:s,height:y,nonBlackColor:0})),p.putImageData(c,0,v*Qe)}}function kr(p,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of e)p[s]!==void 0&&(t[s]=p[s]);p.setLineDash!==void 0&&(t.setLineDash(p.getLineDash()),t.lineDashOffset=p.lineDashOffset)}function no(p){if(p.strokeStyle=p.fillStyle="#000000",p.fillRule="nonzero",p.globalAlpha=1,p.lineWidth=1,p.lineCap="butt",p.lineJoin="miter",p.miterLimit=10,p.globalCompositeOperation="source-over",p.font="10px sans-serif",p.setLineDash!==void 0&&(p.setLineDash([]),p.lineDashOffset=0),!Fe){const{filter:t}=p;t!=="none"&&t!==""&&(p.filter="none")}}function Fd(p,t){if(t)return!0;const e=ht.singularValueDecompose2dScale(p);e[0]=Math.fround(e[0]),e[1]=Math.fround(e[1]);const s=Math.fround((globalThis.devicePixelRatio||1)*zs.PDF_TO_CSS_UNITS);return e[0]<=s&&e[1]<=s}const Kg=["butt","round","square"],Qg=["miter","round","bevel"],Zg={},Dd={};class Fs{constructor(t,e,s,r,o,{optionalContentConfig:l,markedContentStack:c=null},h,f){this.ctx=t,this.current=new Ld(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=s,this.canvasFactory=r,this.filterFactory=o,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=c||[],this.optionalContentConfig=l,this.cachedCanvases=new qg(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=f,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(t,e=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):e}beginDrawing({transform:t,viewport:e,transparency:s=!1,background:r=null}){const o=this.ctx.canvas.width,l=this.ctx.canvas.height,c=this.ctx.fillStyle;if(this.ctx.fillStyle=r||"#ffffff",this.ctx.fillRect(0,0,o,l),this.ctx.fillStyle=c,s){const h=this.cachedCanvases.getCanvas("transparent",o,l);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...ie(this.compositeCtx))}this.ctx.save(),no(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=ie(this.ctx)}executeOperatorList(t,e,s,r){const o=t.argsArray,l=t.fnArray;let c=e||0;const h=o.length;if(h===c)return c;const f=h-c>Rd&&typeof s=="function",g=f?Date.now()+Wg:0;let v=0;const y=this.commonObjs,A=this.objs;let b;for(;;){if(r!==void 0&&c===r.nextBreakPoint)return r.breakIt(c,s),c;if(b=l[c],b!==xn.dependency)this[b].apply(this,o[c]);else for(const S of o[c]){const T=S.startsWith("g_")?y:A;if(!T.has(S))return T.get(S,s),c}if(c++,c===h)return c;if(f&&++v>Rd){if(Date.now()>g)return s(),c;v=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}}_scaleImage(t,e){const s=t.width??t.displayWidth,r=t.height??t.displayHeight;let o=Math.max(Math.hypot(e[0],e[1]),1),l=Math.max(Math.hypot(e[2],e[3]),1),c=s,h=r,f="prescale1",g,v;for(;o>2&&c>1||l>2&&h>1;){let y=c,A=h;o>2&&c>1&&(y=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c/2),o/=c/y),l>2&&h>1&&(A=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,l/=h/A),g=this.cachedCanvases.getCanvas(f,y,A),v=g.context,v.clearRect(0,0,y,A),v.drawImage(t,0,0,c,h,0,0,y,A),t=g.canvas,c=y,h=A,f=f==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:c,paintHeight:h}}_createMaskCanvas(t){const e=this.ctx,{width:s,height:r}=t,o=this.current.fillColor,l=this.current.patternFill,c=ie(e);let h,f,g,v;if((t.bitmap||t.data)&&t.count>1){const it=t.bitmap||t.data.buffer;f=JSON.stringify(l?c:[c.slice(0,4),o]),h=this._cachedBitmapsMap.get(it),h||(h=new Map,this._cachedBitmapsMap.set(it,h));const X=h.get(f);if(X&&!l){const Ct=Math.round(Math.min(c[0],c[2])+c[4]),ft=Math.round(Math.min(c[1],c[3])+c[5]);return{canvas:X,offsetX:Ct,offsetY:ft}}g=X}g||(v=this.cachedCanvases.getCanvas("maskCanvas",s,r),Id(v.context,t));let y=ht.transform(c,[1/s,0,0,-1/r,0,0]);y=ht.transform(y,[1,0,0,1,0,-r]);const[A,b,S,T]=ht.getAxialAlignedBoundingBox([0,0,s,r],y),C=Math.round(S-A)||1,I=Math.round(T-b)||1,O=this.cachedCanvases.getCanvas("fillCanvas",C,I),j=O.context,H=A,W=b;j.translate(-H,-W),j.transform(...y),g||(g=this._scaleImage(v.canvas,Mn(j)),g=g.img,h&&l&&h.set(f,g)),j.imageSmoothingEnabled=Fd(ie(j),t.interpolate),eo(j,g,0,0,g.width,g.height,0,0,s,r),j.globalCompositeOperation="source-in";const V=ht.transform(Mn(j),[1,0,0,1,-H,-W]);return j.fillStyle=l?o.getPattern(e,this,V,Ie.FILL):o,j.fillRect(0,0,s,r),h&&!l&&(this.cachedCanvases.delete("fillCanvas"),h.set(f,O.canvas)),{canvas:O.canvas,offsetX:Math.round(H),offsetY:Math.round(W)}}setLineWidth(t){t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(t){this.ctx.lineCap=Kg[t]}setLineJoin(t){this.ctx.lineJoin=Qg[t]}setMiterLimit(t){this.ctx.miterLimit=t}setDash(t,e){const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(t),s.lineDashOffset=e)}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[e,s]of t)switch(e){case"LW":this.setLineWidth(s);break;case"LC":this.setLineCap(s);break;case"LJ":this.setLineJoin(s);break;case"ML":this.setMiterLimit(s);break;case"D":this.setDash(s[0],s[1]);break;case"RI":this.setRenderingIntent(s);break;case"FL":this.setFlatness(s);break;case"Font":this.setFont(s[0],s[1]);break;case"CA":this.current.strokeAlpha=s;break;case"ca":this.current.fillAlpha=s,this.ctx.globalAlpha=s;break;case"BM":this.ctx.globalCompositeOperation=s;break;case"SMask":this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,e=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,r=this.cachedCanvases.getCanvas(s,t,e);this.suspendedCtx=this.ctx,this.ctx=r.context;const o=this.ctx;o.setTransform(...ie(this.suspendedCtx)),kr(this.suspendedCtx,o),Xg(o,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),kr(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,s,r){const o=r[0],l=r[1],c=r[2]-o,h=r[3]-l;c===0||h===0||(this.genericComposeSMask(e.context,s,c,h,e.subtype,e.backdrop,e.transferMap,o,l,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(s.canvas,0,0),t.restore())}genericComposeSMask(t,e,s,r,o,l,c,h,f,g,v){let y=t.canvas,A=h-g,b=f-v;if(l){const T=ht.makeHexColor(...l);if(A<0||b<0||A+s>y.width||b+r>y.height){const C=this.cachedCanvases.getCanvas("maskExtension",s,r),I=C.context;I.drawImage(y,-A,-b),I.globalCompositeOperation="destination-atop",I.fillStyle=T,I.fillRect(0,0,s,r),I.globalCompositeOperation="source-over",y=C.canvas,A=b=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const C=new Path2D;C.rect(A,b,s,r),t.clip(C),t.globalCompositeOperation="destination-atop",t.fillStyle=T,t.fillRect(A,b,s,r),t.restore()}}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),o==="Alpha"&&c?e.filter=this.filterFactory.addAlphaFilter(c):o==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(c));const S=new Path2D;S.rect(h,f,s,r),e.clip(S),e.globalCompositeOperation="destination-in",e.drawImage(y,A,b,s,r,h,f,s,r),e.restore()}save(){this.inSMaskMode?(kr(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),kr(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(t,e,s,r,o,l){this.ctx.transform(t,e,s,r,o,l),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,s){const r=this.ctx,o=this.current;let l=o.x,c=o.y,h,f;const g=ie(r),v=g[0]===0&&g[3]===0||g[1]===0&&g[2]===0,y=v?s.slice(0):null;for(let A=0,b=0,S=t.length;A<S;A++)switch(t[A]|0){case xn.rectangle:l=e[b++],c=e[b++];const T=e[b++],C=e[b++],I=l+T,O=c+C;r.moveTo(l,c),T===0||C===0?r.lineTo(I,O):(r.lineTo(I,c),r.lineTo(I,O),r.lineTo(l,O)),v||o.updateRectMinMax(g,[l,c,I,O]),r.closePath();break;case xn.moveTo:l=e[b++],c=e[b++],r.moveTo(l,c),v||o.updatePathMinMax(g,l,c);break;case xn.lineTo:l=e[b++],c=e[b++],r.lineTo(l,c),v||o.updatePathMinMax(g,l,c);break;case xn.curveTo:h=l,f=c,l=e[b+4],c=e[b+5],r.bezierCurveTo(e[b],e[b+1],e[b+2],e[b+3],l,c),o.updateCurvePathMinMax(g,h,f,e[b],e[b+1],e[b+2],e[b+3],l,c,y),b+=6;break;case xn.curveTo2:h=l,f=c,r.bezierCurveTo(l,c,e[b],e[b+1],e[b+2],e[b+3]),o.updateCurvePathMinMax(g,h,f,l,c,e[b],e[b+1],e[b+2],e[b+3],y),l=e[b+2],c=e[b+3],b+=4;break;case xn.curveTo3:h=l,f=c,l=e[b+2],c=e[b+3],r.bezierCurveTo(e[b],e[b+1],l,c,l,c),o.updateCurvePathMinMax(g,h,f,e[b],e[b+1],l,c,l,c,y),b+=4;break;case xn.closePath:r.closePath();break}v&&o.updateScalingPathMinMax(g,y),o.setCurrentPoint(l,c)}closePath(){this.ctx.closePath()}stroke(t=!0){const e=this.ctx,s=this.current.strokeColor;e.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof s=="object"&&s?.getPattern?(e.save(),e.strokeStyle=s.getPattern(e,this,Mn(e),Ie.STROKE),this.rescaleAndStroke(!1),e.restore()):this.rescaleAndStroke(!0)),t&&this.consumePath(this.current.getClippedPathBoundingBox()),e.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(t=!0){const e=this.ctx,s=this.current.fillColor,r=this.current.patternFill;let o=!1;r&&(e.save(),e.fillStyle=s.getPattern(e,this,Mn(e),Ie.FILL),o=!0);const l=this.current.getClippedPathBoundingBox();this.contentVisible&&l!==null&&(this.pendingEOFill?(e.fill("evenodd"),this.pendingEOFill=!1):e.fill()),o&&e.restore(),t&&this.consumePath(l)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Zg}eoClip(){this.pendingClip=Dd}beginText(){this.current.textMatrix=Vd,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const t=this.pendingTextPaths,e=this.ctx;if(t===void 0){e.beginPath();return}const s=new Path2D,r=e.getTransform().invertSelf();for(const{transform:o,x:l,y:c,fontSize:h,path:f}of t)s.addPath(f,new DOMMatrix(o).preMultiplySelf(r).translate(l,c).scale(h,-h));e.clip(s),e.beginPath(),delete this.pendingTextPaths}setCharSpacing(t){this.current.charSpacing=t}setWordSpacing(t){this.current.wordSpacing=t}setHScale(t){this.current.textHScale=t/100}setLeading(t){this.current.leading=-t}setFont(t,e){const s=this.commonObjs.get(t),r=this.current;if(!s)throw new Error(`Can't find font for ${t}`);if(r.fontMatrix=s.fontMatrix||yc,(r.fontMatrix[0]===0||r.fontMatrix[3]===0)&&Rt("Invalid font matrix for font "+t),e<0?(e=-e,r.fontDirection=-1):r.fontDirection=1,this.current.font=s,this.current.fontSize=e,s.isType3Font)return;const o=s.loadedName||"sans-serif",l=s.systemFontInfo?.css||`"${o}", ${s.fallbackName}`;let c="normal";s.black?c="900":s.bold&&(c="bold");const h=s.italic?"italic":"normal";let f=e;e<Td?f=Td:e>Pd&&(f=Pd),this.current.fontSizeScale=e/f,this.ctx.font=`${h} ${c} ${f}px ${l}`}setTextRenderingMode(t){this.current.textRenderingMode=t}setTextRise(t){this.current.textRise=t}moveText(t,e){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=e}setLeadingMoveText(t,e){this.setLeading(-e),this.moveText(t,e)}setTextMatrix(t,e,s,r,o,l){this.current.textMatrix=[t,e,s,r,o,l],this.current.textMatrixScale=Math.hypot(t,e),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}#n(t,e,s){const r=new Path2D;return r.addPath(t,new DOMMatrix(s).invertSelf().multiplySelf(e)),r}paintChar(t,e,s,r,o){const l=this.ctx,c=this.current,h=c.font,f=c.textRenderingMode,g=c.fontSize/c.fontSizeScale,v=f&Ne.FILL_STROKE_MASK,y=!!(f&Ne.ADD_TO_PATH_FLAG),A=c.patternFill&&!h.missingFile,b=c.patternStroke&&!h.missingFile;let S;if((h.disableFontFace||y||A||b)&&(S=h.getPathGenerator(this.commonObjs,t)),h.disableFontFace||A||b){if(l.save(),l.translate(e,s),l.scale(g,-g),v===Ne.FILL||v===Ne.FILL_STROKE)if(r){const T=l.getTransform();l.setTransform(...r),l.fill(this.#n(S,T,r))}else l.fill(S);if(v===Ne.STROKE||v===Ne.FILL_STROKE)if(o){const T=l.getTransform();l.setTransform(...o),l.stroke(this.#n(S,T,o))}else l.lineWidth/=g,l.stroke(S);l.restore()}else(v===Ne.FILL||v===Ne.FILL_STROKE)&&l.fillText(t,e,s),(v===Ne.STROKE||v===Ne.FILL_STROKE)&&l.strokeText(t,e,s);y&&(this.pendingTextPaths||=[]).push({transform:ie(l),x:e,y:s,fontSize:g,path:S})}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let s=!1;for(let r=3;r<e.length;r+=4)if(e[r]>0&&e[r]<255){s=!0;break}return Ot(this,"isFontSubpixelAAEnabled",s)}showText(t){const e=this.current,s=e.font;if(s.isType3Font)return this.showType3Text(t);const r=e.fontSize;if(r===0)return;const o=this.ctx,l=e.fontSizeScale,c=e.charSpacing,h=e.wordSpacing,f=e.fontDirection,g=e.textHScale*f,v=t.length,y=s.vertical,A=y?1:-1,b=s.defaultVMetrics,S=r*e.fontMatrix[0],T=e.textRenderingMode===Ne.FILL&&!s.disableFontFace&&!e.patternFill;o.save(),o.transform(...e.textMatrix),o.translate(e.x,e.y+e.textRise),f>0?o.scale(g,-1):o.scale(g,1);let C,I;if(e.patternFill){o.save();const V=e.fillColor.getPattern(o,this,Mn(o),Ie.FILL);C=ie(o),o.restore(),o.fillStyle=V}if(e.patternStroke){o.save();const V=e.strokeColor.getPattern(o,this,Mn(o),Ie.STROKE);I=ie(o),o.restore(),o.strokeStyle=V}let O=e.lineWidth;const j=e.textMatrixScale;if(j===0||O===0){const V=e.textRenderingMode&Ne.FILL_STROKE_MASK;(V===Ne.STROKE||V===Ne.FILL_STROKE)&&(O=this.getSinglePixelWidth())}else O/=j;if(l!==1&&(o.scale(l,l),O/=l),o.lineWidth=O,s.isInvalidPDFjsFont){const V=[];let it=0;for(const X of t)V.push(X.unicode),it+=X.width;o.fillText(V.join(""),0,0),e.x+=it*S*g,o.restore(),this.compose();return}let H=0,W;for(W=0;W<v;++W){const V=t[W];if(typeof V=="number"){H+=A*V*r/1e3;continue}let it=!1;const X=(V.isSpace?h:0)+c,Ct=V.fontChar,ft=V.accent;let Nt,Mt,Lt=V.width;if(y){const Z=V.vmetric||b,q=-(V.vmetric?Z[1]:Lt*.5)*S,Y=Z[2]*S;Lt=Z?-Z[0]:Lt,Nt=q/l,Mt=(H+Y)/l}else Nt=H/l,Mt=0;if(s.remeasure&&Lt>0){const Z=o.measureText(Ct).width*1e3/r*l;if(Lt<Z&&this.isFontSubpixelAAEnabled){const q=Lt/Z;it=!0,o.save(),o.scale(q,1),Nt/=q}else Lt!==Z&&(Nt+=(Lt-Z)/2e3*r/l)}if(this.contentVisible&&(V.isInFont||s.missingFile)){if(T&&!ft)o.fillText(Ct,Nt,Mt);else if(this.paintChar(Ct,Nt,Mt,C,I),ft){const Z=Nt+r*ft.offset.x/l,q=Mt-r*ft.offset.y/l;this.paintChar(ft.fontChar,Z,q,C,I)}}const Ut=y?Lt*S-X*f:Lt*S+X*f;H+=Ut,it&&o.restore()}y?e.y-=H:e.x+=H*g,o.restore(),this.compose()}showType3Text(t){const e=this.ctx,s=this.current,r=s.font,o=s.fontSize,l=s.fontDirection,c=r.vertical?1:-1,h=s.charSpacing,f=s.wordSpacing,g=s.textHScale*l,v=s.fontMatrix||yc,y=t.length,A=s.textRenderingMode===Ne.INVISIBLE;let b,S,T,C;if(!(A||o===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,e.save(),e.transform(...s.textMatrix),e.translate(s.x,s.y),e.scale(g,l),b=0;b<y;++b){if(S=t[b],typeof S=="number"){C=c*S*o/1e3,this.ctx.translate(C,0),s.x+=C*g;continue}const I=(S.isSpace?f:0)+h,O=r.charProcOperatorList[S.operatorListId];if(!O){Rt(`Type3 character "${S.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=S,this.save(),e.scale(o,o),e.transform(...v),this.executeOperatorList(O),this.restore()),T=ht.applyTransform([S.width,0],v)[0]*o+I,e.translate(T,0),s.x+=T*g}e.restore(),this.processingType3=null}}setCharWidth(t,e){}setCharWidthAndBounds(t,e,s,r,o,l){this.ctx.rect(s,r,o-s,l-r),this.ctx.clip(),this.endPath()}getColorN_Pattern(t){let e;if(t[0]==="TilingPattern"){const s=t[1],r=this.baseTransform||ie(this.ctx),o={createCanvasGraphics:l=>new Fs(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};e=new Dc(t,s,this.ctx,o,r)}else e=this._getPattern(t[1],t[2]);return e}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(t,e,s){this.ctx.strokeStyle=this.current.strokeColor=ht.makeHexColor(t,e,s),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,e,s){this.ctx.fillStyle=this.current.fillColor=ht.makeHexColor(t,e,s),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e=null){let s;return this.cachedPatterns.has(t)?s=this.cachedPatterns.get(t):(s=Vg(this.getObject(t)),this.cachedPatterns.set(t,s)),e&&(s.matrix=e),s}shadingFill(t){if(!this.contentVisible)return;const e=this.ctx;this.save();const s=this._getPattern(t);e.fillStyle=s.getPattern(e,this,Mn(e),Ie.SHADING);const r=Mn(e);if(r){const{width:o,height:l}=e.canvas,[c,h,f,g]=ht.getAxialAlignedBoundingBox([0,0,o,l],r);this.ctx.fillRect(c,h,f-c,g-h)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){Wt("Should not call beginInlineImage")}beginImageData(){Wt("Should not call beginImageData")}paintFormXObjectBegin(t,e){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),t&&this.transform(...t),this.baseTransform=ie(this.ctx),e)){const s=e[2]-e[0],r=e[3]-e[1];this.ctx.rect(e[0],e[1],s,r),this.current.updateRectMinMax(ie(this.ctx),e),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const e=this.ctx;t.isolated||fo("TODO: Support non-isolated groups."),t.knockout&&Rt("Knockout groups not supported.");const s=ie(e);if(t.matrix&&e.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let r=ht.getAxialAlignedBoundingBox(t.bbox,ie(e));const o=[0,0,e.canvas.width,e.canvas.height];r=ht.intersect(r,o)||[0,0,0,0];const l=Math.floor(r[0]),c=Math.floor(r[1]),h=Math.max(Math.ceil(r[2])-l,1),f=Math.max(Math.ceil(r[3])-c,1);this.current.startNewPathAndClipBox([0,0,h,f]);let g="groupAt"+this.groupLevel;t.smask&&(g+="_smask_"+this.smaskCounter++%2);const v=this.cachedCanvases.getCanvas(g,h,f),y=v.context;y.translate(-l,-c),y.transform(...s),t.smask?this.smaskStack.push({canvas:v.canvas,context:y,offsetX:l,offsetY:c,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(l,c),e.save()),kr(e,y),this.ctx=y,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++}endGroup(t){if(!this.contentVisible)return;this.groupLevel--;const e=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,t.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const r=ie(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...r);const o=ht.getAxialAlignedBoundingBox([0,0,e.canvas.width,e.canvas.height],r);this.ctx.drawImage(e.canvas,0,0),this.ctx.restore(),this.compose(o)}}beginAnnotation(t,e,s,r,o){if(this.#t(),no(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),e){const l=e[2]-e[0],c=e[3]-e[1];if(o&&this.annotationCanvasMap){s=s.slice(),s[4]-=e[0],s[5]-=e[1],e=e.slice(),e[0]=e[1]=0,e[2]=l,e[3]=c;const[h,f]=ht.singularValueDecompose2dScale(ie(this.ctx)),{viewportScale:g}=this,v=Math.ceil(l*this.outputScaleX*g),y=Math.ceil(c*this.outputScaleY*g);this.annotationCanvas=this.canvasFactory.create(v,y);const{canvas:A,context:b}=this.annotationCanvas;this.annotationCanvasMap.set(t,A),this.annotationCanvas.savedCtx=this.ctx,this.ctx=b,this.ctx.save(),this.ctx.setTransform(h,0,0,-f,0,c*f),no(this.ctx)}else no(this.ctx),this.endPath(),this.ctx.rect(e[0],e[1],l,c),this.ctx.clip(),this.ctx.beginPath()}this.current=new Ld(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...s),this.transform(...r)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t){if(!this.contentVisible)return;const e=t.count;t=this.getObject(t.data,t),t.count=e;const s=this.ctx,r=this.processingType3;if(r&&(r.compiled===void 0&&(r.compiled=Yg(t)),r.compiled)){r.compiled(s);return}const o=this._createMaskCanvas(t),l=o.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(l,o.offsetX,o.offsetY),s.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,s=0,r=0,o,l){if(!this.contentVisible)return;t=this.getObject(t.data,t);const c=this.ctx;c.save();const h=ie(c);c.transform(e,s,r,o,0,0);const f=this._createMaskCanvas(t);c.setTransform(1,0,0,1,f.offsetX-h[4],f.offsetY-h[5]);for(let g=0,v=l.length;g<v;g+=2){const y=ht.transform(h,[e,s,r,o,l[g],l[g+1]]),[A,b]=ht.applyTransform([0,0],y);c.drawImage(f.canvas,A,b)}c.restore(),this.compose()}paintImageMaskXObjectGroup(t){if(!this.contentVisible)return;const e=this.ctx,s=this.current.fillColor,r=this.current.patternFill;for(const o of t){const{data:l,width:c,height:h,transform:f}=o,g=this.cachedCanvases.getCanvas("maskCanvas",c,h),v=g.context;v.save();const y=this.getObject(l,o);Id(v,y),v.globalCompositeOperation="source-in",v.fillStyle=r?s.getPattern(v,this,Mn(e),Ie.FILL):s,v.fillRect(0,0,c,h),v.restore(),e.save(),e.transform(...f),e.scale(1,-1),eo(e,g.canvas,0,0,c,h,0,-1,1,1),e.restore()}this.compose()}paintImageXObject(t){if(!this.contentVisible)return;const e=this.getObject(t);if(!e){Rt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e)}paintImageXObjectRepeat(t,e,s,r){if(!this.contentVisible)return;const o=this.getObject(t);if(!o){Rt("Dependent image isn't ready yet");return}const l=o.width,c=o.height,h=[];for(let f=0,g=r.length;f<g;f+=2)h.push({transform:[e,0,0,s,r[f],r[f+1]],x:0,y:0,w:l,h:c});this.paintInlineImageXObjectGroup(o,h)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:s,height:r}=t,o=this.cachedCanvases.getCanvas("inlineImage",s,r),l=o.context;return l.filter=this.current.transferMaps,l.drawImage(e,0,0),l.filter="none",o.canvas}paintInlineImageXObject(t){if(!this.contentVisible)return;const e=t.width,s=t.height,r=this.ctx;if(this.save(),!Fe){const{filter:c}=r;c!=="none"&&c!==""&&(r.filter="none")}r.scale(1/e,-1/s);let o;if(t.bitmap)o=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)o=t;else{const h=this.cachedCanvases.getCanvas("inlineImage",e,s).context;Nd(h,t),o=this.applyTransferMapsToCanvas(h)}const l=this._scaleImage(o,Mn(r));r.imageSmoothingEnabled=Fd(ie(r),t.interpolate),eo(r,l.img,0,0,l.paintWidth,l.paintHeight,0,-s,e,s),this.compose(),this.restore()}paintInlineImageXObjectGroup(t,e){if(!this.contentVisible)return;const s=this.ctx;let r;if(t.bitmap)r=t.bitmap;else{const o=t.width,l=t.height,h=this.cachedCanvases.getCanvas("inlineImage",o,l).context;Nd(h,t),r=this.applyTransferMapsToCanvas(h)}for(const o of e)s.save(),s.transform(...o.transform),s.scale(1,-1),eo(s,r,o.x,o.y,o.w,o.h,0,-1,1,1),s.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t){}markPointProps(t,e){}beginMarkedContent(t){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e){t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(e)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(t){const e=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const s=this.ctx;this.pendingClip&&(e||(this.pendingClip===Dd?s.clip("evenodd"):s.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),s.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=ie(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),s=Math.hypot(t[0],t[2]),r=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(s,r)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:s,c:r,d:o}=this.ctx.getTransform();let l,c;if(s===0&&r===0){const h=Math.abs(e),f=Math.abs(o);if(h===f)if(t===0)l=c=1/h;else{const g=h*t;l=c=g<1?1/g:1}else if(t===0)l=1/h,c=1/f;else{const g=h*t,v=f*t;l=g<1?1/g:1,c=v<1?1/v:1}}else{const h=Math.abs(e*o-s*r),f=Math.hypot(e,s),g=Math.hypot(r,o);if(t===0)l=g/h,c=f/h;else{const v=t*h;l=g>v?g/v:1,c=f>v?f/v:1}}this._cachedScaleForStroking[0]=l,this._cachedScaleForStroking[1]=c}return this._cachedScaleForStroking}rescaleAndStroke(t){const{ctx:e}=this,{lineWidth:s}=this.current,[r,o]=this.getScaleForStroking();if(e.lineWidth=s||1,r===1&&o===1){e.stroke();return}const l=e.getLineDash();if(t&&e.save(),e.scale(r,o),l.length>0){const c=Math.max(r,o);e.setLineDash(l.map(h=>h/c)),e.lineDashOffset/=c}e.stroke(),t&&e.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const p in xn)Fs.prototype[p]!==void 0&&(Fs.prototype[xn[p]]=Fs.prototype[p]);class Ir{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}}class Jg{#t;#e;constructor({parsedData:t,rawData:e}){this.#t=t,this.#e=e}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}getAll(){return kc(this.#t)}has(t){return this.#t.has(t)}}const Ns=Symbol("INTERNAL");class tm{#t=!1;#e=!1;#n=!1;#i=!0;constructor(t,{name:e,intent:s,usage:r,rbGroups:o}){this.#t=!!(t&rn.DISPLAY),this.#e=!!(t&rn.PRINT),this.name=e,this.intent=s,this.usage=r,this.rbGroups=o}get visible(){if(this.#n)return this.#i;if(!this.#i)return!1;const{print:t,view:e}=this.usage;return this.#t?e?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,e,s=!1){t!==Ns&&Wt("Internal method `_setVisible` called."),this.#n=s,this.#i=e}}class em{#t=null;#e=new Map;#n=null;#i=null;constructor(t,e=rn.DISPLAY){if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#i=t.order;for(const s of t.groups)this.#e.set(s.id,new tm(e,s));if(t.baseState==="OFF")for(const s of this.#e.values())s._setVisible(Ns,!1);for(const s of t.on)this.#e.get(s)._setVisible(Ns,!0);for(const s of t.off)this.#e.get(s)._setVisible(Ns,!1);this.#n=this.getHash()}}#r(t){const e=t.length;if(e<2)return!0;const s=t[0];for(let r=1;r<e;r++){const o=t[r];let l;if(Array.isArray(o))l=this.#r(o);else if(this.#e.has(o))l=this.#e.get(o).visible;else return Rt(`Optional content group not found: ${o}`),!0;switch(s){case"And":if(!l)return!1;break;case"Or":if(l)return!0;break;case"Not":return!l;default:return!0}}return s==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return fo("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(Rt(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#r(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!this.#e.has(e))return Rt(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!this.#e.has(e))return Rt(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!this.#e.has(e))return Rt(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!this.#e.has(e))return Rt(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!1}return!0}return Rt(`Unknown optional content policy ${t.policy}.`),!0}return Rt(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,s=!0){const r=this.#e.get(t);if(!r){Rt(`Optional content group not found: ${t}`);return}if(s&&e&&r.rbGroups.length)for(const o of r.rbGroups)for(const l of o)l!==t&&this.#e.get(l)?._setVisible(Ns,!1,!0);r._setVisible(Ns,!!e,!0),this.#t=null}setOCGState({state:t,preserveRB:e}){let s;for(const r of t){switch(r){case"ON":case"OFF":case"Toggle":s=r;continue}const o=this.#e.get(r);if(o)switch(s){case"ON":this.setVisibility(r,!0,e);break;case"OFF":this.setVisibility(r,!1,e);break;case"Toggle":this.setVisibility(r,!o.visible,e);break}}this.#t=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#e.size?this.#i?this.#i.slice():[...this.#e.keys()]:null}getGroups(){return this.#e.size>0?kc(this.#e):null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new Xd;for(const[e,s]of this.#e)t.update(`${e}:${s.visible}`);return this.#t=t.hexdigest()}}class nm{constructor(t,{disableRange:e=!1,disableStream:s=!1}){me(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:r,initialData:o,progressiveDone:l,contentDispositionFilename:c}=t;if(this._queuedChunks=[],this._progressiveDone=l,this._contentDispositionFilename=c,o?.length>0){const h=o instanceof Uint8Array&&o.byteLength===o.buffer.byteLength?o.buffer:new Uint8Array(o).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!s,this._isRangeSupported=!e,this._contentLength=r,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((h,f)=>{this._onReceiveData({begin:h,chunk:f})}),t.addProgressListener((h,f)=>{this._onProgress({loaded:h,total:f})}),t.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const s=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const r=this._rangeReaders.some(function(o){return o._begin!==t?!1:(o._enqueue(s),!0)});me(r,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){t.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){me(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new im(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const s=new sm(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeReaders.slice(0))e.cancel(t);this._pdfDataRangeTransport.abort()}}class im{constructor(t,e,s=!1,r=null){this._stream=t,this._done=s||!1,this._filename=Rc(r)?r:null,this._queuedChunks=e||[],this._loaded=0;for(const o of this._queuedChunks)this._loaded+=o.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class sm{constructor(t,e,s){this._stream=t,this._begin=e,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function rm(p){let t=!0,e=s("filename\\*","i").exec(p);if(e){e=e[1];let g=c(e);return g=unescape(g),g=h(g),g=f(g),o(g)}if(e=l(p),e){const g=f(e);return o(g)}if(e=s("filename","i").exec(p),e){e=e[1];let g=c(e);return g=f(g),o(g)}function s(g,v){return new RegExp("(?:^|;)\\s*"+g+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',v)}function r(g,v){if(g){if(!/^[\x00-\xFF]+$/.test(v))return v;try{const y=new TextDecoder(g,{fatal:!0}),A=po(v);v=y.decode(A),t=!1}catch{}}return v}function o(g){return t&&/[\x80-\xff]/.test(g)&&(g=r("utf-8",g),t&&(g=r("iso-8859-1",g))),g}function l(g){const v=[];let y;const A=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(y=A.exec(g))!==null;){let[,S,T,C]=y;if(S=parseInt(S,10),S in v){if(S===0)break;continue}v[S]=[T,C]}const b=[];for(let S=0;S<v.length&&S in v;++S){let[T,C]=v[S];C=c(C),T&&(C=unescape(C),S===0&&(C=h(C))),b.push(C)}return b.join("")}function c(g){if(g.startsWith('"')){const v=g.slice(1).split('\\"');for(let y=0;y<v.length;++y){const A=v[y].indexOf('"');A!==-1&&(v[y]=v[y].slice(0,A),v.length=y+1),v[y]=v[y].replaceAll(/\\(.)/g,"$1")}g=v.join('"')}return g}function h(g){const v=g.indexOf("'");if(v===-1)return g;const y=g.slice(0,v),b=g.slice(v+1).replace(/^[^']*'/,"");return r(y,b)}function f(g){return!g.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(g)?g:g.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(v,y,A,b){if(A==="q"||A==="Q")return b=b.replaceAll("_"," "),b=b.replaceAll(/=([0-9a-fA-F]{2})/g,function(S,T){return String.fromCharCode(parseInt(T,16))}),r(y,b);try{b=atob(b)}catch{}return r(y,b)})}return""}function nf(p,t){const e=new Headers;if(!p||!t||typeof t!="object")return e;for(const s in t){const r=t[s];r!==void 0&&e.append(s,r)}return e}function yo(p){try{return new URL(p).origin}catch{}return null}function sf({responseHeaders:p,isHttp:t,rangeChunkSize:e,disableRange:s}){const r={allowRangeRequests:!1,suggestedLength:void 0},o=parseInt(p.get("Content-Length"),10);return!Number.isInteger(o)||(r.suggestedLength=o,o<=2*e)||s||!t||p.get("Accept-Ranges")!=="bytes"||(p.get("Content-Encoding")||"identity")!=="identity"||(r.allowRangeRequests=!0),r}function rf(p){const t=p.get("Content-Disposition");if(t){let e=rm(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(Rc(e))return e}return null}function wo(p,t){return p===404||p===0&&t.startsWith("file:")?new Fr('Missing PDF "'+t+'".'):new oo(`Unexpected server response (${p}) while retrieving PDF "${t}".`,p)}function af(p){return p===200||p===206}function of(p,t,e){return{method:"GET",headers:p,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function lf(p){return p instanceof Uint8Array?p.buffer:p instanceof ArrayBuffer?p:(Rt(`getArrayBuffer - unexpected data format: ${p}`),new Uint8Array(p).buffer)}class Od{_responseOrigin=null;constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=nf(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return me(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new am(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const s=new om(this,t,e);return this._rangeRequestReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class am{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const s=new Headers(t.headers),r=e.url;fetch(r,of(s,this._withCredentials,this._abortController)).then(o=>{if(t._responseOrigin=yo(o.url),!af(o.status))throw wo(o.status,r);this._reader=o.body.getReader(),this._headersCapability.resolve();const l=o.headers,{allowRangeRequests:c,suggestedLength:h}=sf({responseHeaders:l,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=c,this._contentLength=h||this._contentLength,this._filename=rf(l),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new bi("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:lf(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class om{constructor(t,e,s){this._stream=t,this._reader=null,this._loaded=0;const r=t.source;this._withCredentials=r.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!r.disableStream,this._abortController=new AbortController;const o=new Headers(t.headers);o.append("Range",`bytes=${e}-${s-1}`);const l=r.url;fetch(l,of(o,this._withCredentials,this._abortController)).then(c=>{const h=yo(c.url);if(h!==t._responseOrigin)throw new Error(`Expected range response-origin "${h}" to match "${t._responseOrigin}".`);if(!af(c.status))throw wo(c.status,l);this._readCapability.resolve(),this._reader=c.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded}),{value:lf(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const dc=200,fc=206;function lm(p){const t=p.response;return typeof t!="string"?t:po(t).buffer}class cm{_responseOrigin=null;constructor({url:t,httpHeaders:e,withCredentials:s}){this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=nf(this.isHttp,e),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const e=new XMLHttpRequest,s=this.currXhrId++,r=this.pendingRequests[s]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[o,l]of this.headers)e.setRequestHeader(o,l);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),r.expectedStatus=fc):r.expectedStatus=dc,e.responseType="arraybuffer",me(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>{t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,s),e.onprogress=this.onProgress.bind(this,s),r.onHeadersReceived=t.onHeadersReceived,r.onDone=t.onDone,r.onError=t.onError,r.onProgress=t.onProgress,e.send(null),s}onProgress(t,e){const s=this.pendingRequests[t];s&&s.onProgress?.(e)}onStateChange(t,e){const s=this.pendingRequests[t];if(!s)return;const r=s.xhr;if(r.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),r.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],r.status===0&&this.isHttp){s.onError(r.status);return}const o=r.status||dc;if(!(o===dc&&s.expectedStatus===fc)&&o!==s.expectedStatus){s.onError(r.status);return}const c=lm(r);if(o===fc){const h=r.getResponseHeader("Content-Range"),f=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);f?s.onDone({begin:parseInt(f[1],10),chunk:c}):(Rt('Missing or invalid "Content-Range" header.'),s.onError(0))}else c?s.onDone({begin:0,chunk:c}):s.onError(r.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class um{constructor(t){this._source=t,this._manager=new cm(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return me(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new hm(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const s=new dm(this._manager,t,e);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class hm{constructor(t,e){this._manager=t,this._url=e.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=yo(e.responseURL);const s=e.getAllResponseHeaders(),r=new Headers(s?s.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(c=>{const[h,...f]=c.split(": ");return[h,f.join(": ")]}):[]),{allowRangeRequests:o,suggestedLength:l}=sf({responseHeaders:r,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});o&&(this._isRangeSupported=!0),this._contentLength=l||this._contentLength,this._filename=rf(r),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=wo(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class dm{constructor(t,e,s){this._manager=t,this._url=t.url,this._requestId=t.request({begin:e,end:s,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const t=yo(this._manager.getRequestXhr(this._requestId)?.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??=wo(t,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const fm=/^[a-z][a-z0-9\-+.]+:/i;function pm(p){if(fm.test(p))return new URL(p);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(p))}class gm{constructor(t){this.source=t,this.url=pm(t.url),me(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return me(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new mm(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const s=new vm(this,t,e);return this._rangeRequestReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class mm{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then(r=>{this._contentLength=r.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()},r=>{r.code==="ENOENT"&&(r=new Fr(`Missing PDF "${this._url}".`)),this._storedError=r,this._headersCapability.reject(r)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new bi("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class vm{constructor(t,e,s){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const r=t.source;this._isStreamingSupported=!r.disableStream;const o=process.getBuiltinModule("fs");this._setReadableStream(o.createReadStream(this._url,{start:e,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const ym=1e5,Ye=30,wm=.8;class He{#t=Promise.withResolvers();#e=null;#n=!1;#i=!!globalThis.FontInspector?.enabled;#r=null;#s=null;#l=0;#o=0;#u=null;#c=null;#d=0;#h=0;#f=Object.create(null);#a=[];#p=null;#m=[];#g=new WeakMap;#v=null;static#A=new Map;static#y=new Map;static#b=new WeakMap;static#S=null;static#E=new Set;constructor({textContentSource:t,container:e,viewport:s}){if(t instanceof ReadableStream)this.#p=t;else if(typeof t=="object")this.#p=new ReadableStream({start(h){h.enqueue(t),h.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#c=e,this.#h=s.scale*(globalThis.devicePixelRatio||1),this.#d=s.rotation,this.#s={div:null,properties:null,ctx:null};const{pageWidth:r,pageHeight:o,pageX:l,pageY:c}=s.rawDims;this.#v=[1,0,0,-1,-l,c+o],this.#o=r,this.#l=o,He.#M(),Qi(e,s),this.#t.promise.finally(()=>{He.#E.delete(this),this.#s=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=Be.platform;return Ot(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{this.#u.read().then(({value:e,done:s})=>{if(s){this.#t.resolve();return}this.#r??=e.lang,Object.assign(this.#f,e.styles),this.#k(e.items),t()},this.#t.reject)};return this.#u=this.#p.getReader(),He.#E.add(this),t(),this.#t.promise}update({viewport:t,onBefore:e=null}){const s=t.scale*(globalThis.devicePixelRatio||1),r=t.rotation;if(r!==this.#d&&(e?.(),this.#d=r,Qi(this.#c,{rotation:r})),s!==this.#h){e?.(),this.#h=s;const o={div:null,properties:null,ctx:He.#T(this.#r)};for(const l of this.#m)o.properties=this.#g.get(l),o.div=l,this.#_(o)}}cancel(){const t=new bi("TextLayer task cancelled.");this.#u?.cancel(t).catch(()=>{}),this.#u=null,this.#t.reject(t)}get textDivs(){return this.#m}get textContentItemsStr(){return this.#a}#k(t){if(this.#n)return;this.#s.ctx??=He.#T(this.#r);const e=this.#m,s=this.#a;for(const r of t){if(e.length>ym){Rt("Ignoring additional textDivs for performance reasons."),this.#n=!0;return}if(r.str===void 0){if(r.type==="beginMarkedContentProps"||r.type==="beginMarkedContent"){const o=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),r.id!==null&&this.#e.setAttribute("id",`${r.id}`),o.append(this.#e)}else r.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}s.push(r.str),this.#P(r)}}#P(t){const e=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#m.push(e);const r=ht.transform(this.#v,t.transform);let o=Math.atan2(r[1],r[0]);const l=this.#f[t.fontName];l.vertical&&(o+=Math.PI/2);let c=this.#i&&l.fontSubstitution||l.fontFamily;c=He.fontFamilyMap.get(c)||c;const h=Math.hypot(r[2],r[3]),f=h*He.#I(c,this.#r);let g,v;o===0?(g=r[4],v=r[5]-f):(g=r[4]+f*Math.sin(o),v=r[5]-f*Math.cos(o));const y="calc(var(--scale-factor)*",A=e.style;this.#e===this.#c?(A.left=`${(100*g/this.#o).toFixed(2)}%`,A.top=`${(100*v/this.#l).toFixed(2)}%`):(A.left=`${y}${g.toFixed(2)}px)`,A.top=`${y}${v.toFixed(2)}px)`),A.fontSize=`${y}${(He.#S*h).toFixed(2)}px)`,A.fontFamily=c,s.fontSize=h,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,this.#i&&(e.dataset.fontName=l.fontSubstitutionLoadedName||t.fontName),o!==0&&(s.angle=o*(180/Math.PI));let b=!1;if(t.str.length>1)b=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const S=Math.abs(t.transform[0]),T=Math.abs(t.transform[3]);S!==T&&Math.max(S,T)/Math.min(S,T)>1.5&&(b=!0)}if(b&&(s.canvasWidth=l.vertical?t.height:t.width),this.#g.set(e,s),this.#s.div=e,this.#s.properties=s,this.#_(this.#s),s.hasText&&this.#e.append(e),s.hasEOL){const S=document.createElement("br");S.setAttribute("role","presentation"),this.#e.append(S)}}#_(t){const{div:e,properties:s,ctx:r}=t,{style:o}=e;let l="";if(He.#S>1&&(l=`scale(${1/He.#S})`),s.canvasWidth!==0&&s.hasText){const{fontFamily:c}=o,{canvasWidth:h,fontSize:f}=s;He.#C(r,f*this.#h,c);const{width:g}=r.measureText(e.textContent);g>0&&(l=`scaleX(${h*this.#h/g}) ${l}`)}s.angle!==0&&(l=`rotate(${s.angle}deg) ${l}`),l.length>0&&(o.transform=l)}static cleanup(){if(!(this.#E.size>0)){this.#A.clear();for(const{canvas:t}of this.#y.values())t.remove();this.#y.clear()}}static#T(t=null){let e=this.#y.get(t||="");if(!e){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=t,document.body.append(s),e=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#y.set(t,e),this.#b.set(e,{size:0,family:""})}return e}static#C(t,e,s){const r=this.#b.get(t);e===r.size&&s===r.family||(t.font=`${e}px ${s}`,r.size=e,r.family=s)}static#M(){if(this.#S!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#S=t.getBoundingClientRect().height,t.remove()}static#I(t,e){const s=this.#A.get(t);if(s)return s;const r=this.#T(e);r.canvas.width=r.canvas.height=Ye,this.#C(r,Ye,t);const o=r.measureText("");let l=o.fontBoundingBoxAscent,c=Math.abs(o.fontBoundingBoxDescent);if(l){const g=l/(l+c);return this.#A.set(t,g),r.canvas.width=r.canvas.height=0,g}r.strokeStyle="red",r.clearRect(0,0,Ye,Ye),r.strokeText("g",0,0);let h=r.getImageData(0,0,Ye,Ye).data;c=0;for(let g=h.length-1-3;g>=0;g-=4)if(h[g]>0){c=Math.ceil(g/4/Ye);break}r.clearRect(0,0,Ye,Ye),r.strokeText("A",0,Ye),h=r.getImageData(0,0,Ye,Ye).data,l=0;for(let g=0,v=h.length;g<v;g+=4)if(h[g]>0){l=Ye-Math.floor(g/4/Ye);break}r.canvas.width=r.canvas.height=0;const f=l?l/(l+c):wm;return this.#A.set(t,f),f}}class Dr{static textContent(t){const e=[],s={items:e,styles:Object.create(null)};function r(o){if(!o)return;let l=null;const c=o.name;if(c==="#text")l=o.value;else if(Dr.shouldBuildText(c))o?.attributes?.textContent?l=o.attributes.textContent:o.value&&(l=o.value);else return;if(l!==null&&e.push({str:l}),!!o.children)for(const h of o.children)r(h)}return r(t),s}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}const Am=65536,bm=100,_m=5e3,Sm=Fe?Og:Ig,xm=Fe?jg:Qd,Em=Fe?Dg:Fg,Cm=Fe?zg:tf;function km(p={}){typeof p=="string"||p instanceof URL?p={url:p}:(p instanceof ArrayBuffer||ArrayBuffer.isView(p))&&(p={data:p});const t=new Oc,{docId:e}=t,s=p.url?Tm(p.url):null,r=p.data?Pm(p.data):null,o=p.httpHeaders||null,l=p.withCredentials===!0,c=p.password??null,h=p.range instanceof cf?p.range:null,f=Number.isInteger(p.rangeChunkSize)&&p.rangeChunkSize>0?p.rangeChunkSize:Am;let g=p.worker instanceof Ds?p.worker:null;const v=p.verbosity,y=typeof p.docBaseUrl=="string"&&!mo(p.docBaseUrl)?p.docBaseUrl:null,A=typeof p.cMapUrl=="string"?p.cMapUrl:null,b=p.cMapPacked!==!1,S=p.CMapReaderFactory||xm,T=typeof p.standardFontDataUrl=="string"?p.standardFontDataUrl:null,C=p.StandardFontDataFactory||Cm,I=p.stopAtErrors!==!0,O=Number.isInteger(p.maxImageSize)&&p.maxImageSize>-1?p.maxImageSize:-1,j=p.isEvalSupported!==!1,H=typeof p.isOffscreenCanvasSupported=="boolean"?p.isOffscreenCanvasSupported:!Fe,W=typeof p.isImageDecoderSupported=="boolean"?p.isImageDecoderSupported:!Fe&&(Be.platform.isFirefox||!globalThis.chrome),V=Number.isInteger(p.canvasMaxAreaInBytes)?p.canvasMaxAreaInBytes:-1,it=typeof p.disableFontFace=="boolean"?p.disableFontFace:Fe,X=p.fontExtraProperties===!0,Ct=p.enableXfa===!0,ft=p.ownerDocument||globalThis.document,Nt=p.disableRange===!0,Mt=p.disableStream===!0,Lt=p.disableAutoFetch===!0,Ut=p.pdfBug===!0,Z=p.CanvasFactory||Sm,q=p.FilterFactory||Em,Y=p.enableHWA===!0,nt=h?h.length:p.length??NaN,Q=typeof p.useSystemFonts=="boolean"?p.useSystemFonts:!Fe&&!it,M=typeof p.useWorkerFetch=="boolean"?p.useWorkerFetch:S===Qd&&C===tf&&A&&T&&Rr(A,document.baseURI)&&Rr(T,document.baseURI),z=null;dg(v);const J={canvasFactory:new Z({ownerDocument:ft,enableHWA:Y}),filterFactory:new q({docId:e,ownerDocument:ft}),cMapReaderFactory:M?null:new S({baseUrl:A,isCompressed:b}),standardFontDataFactory:M?null:new C({baseUrl:T})};if(!g){const pt={verbosity:v,port:Ir.workerPort};g=pt.port?Ds.fromPort(pt):new Ds(pt),t._worker=g}const vt={docId:e,apiVersion:"4.10.38",data:r,password:c,disableAutoFetch:Lt,rangeChunkSize:f,length:nt,docBaseUrl:y,enableXfa:Ct,evaluatorOptions:{maxImageSize:O,disableFontFace:it,ignoreErrors:I,isEvalSupported:j,isOffscreenCanvasSupported:H,isImageDecoderSupported:W,canvasMaxAreaInBytes:V,fontExtraProperties:X,useSystemFonts:Q,cMapUrl:M?A:null,standardFontDataUrl:M?T:null}},xt={disableFontFace:it,fontExtraProperties:X,ownerDocument:ft,pdfBug:Ut,styleElement:z,loadingParams:{disableAutoFetch:Lt,enableXfa:Ct}};return g.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(g.destroyed)throw new Error("Worker was destroyed");const pt=g.messageHandler.sendWithPromise("GetDocRequest",vt,r?[r.buffer]:null);let dt;if(h)dt=new nm(h,{disableRange:Nt,disableStream:Mt});else if(!r){if(!s)throw new Error("getDocument - no `url` parameter provided.");let Et;if(Fe)if(Rr(s)){if(typeof fetch>"u"||typeof Response>"u"||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");Et=Od}else Et=gm;else Et=Rr(s)?Od:um;dt=new Et({url:s,length:nt,httpHeaders:o,withCredentials:l,rangeChunkSize:f,disableRange:Nt,disableStream:Mt})}return pt.then(Et=>{if(t.destroyed)throw new Error("Loading aborted");if(g.destroyed)throw new Error("Worker was destroyed");const Tt=new Mr(e,Et,g.port),fe=new Nm(Tt,t,dt,xt,J);t._transport=fe,Tt.send("Ready",null)})}).catch(t._capability.reject),t}function Tm(p){if(p instanceof URL)return p.href;try{return new URL(p,window.location).href}catch{if(Fe&&typeof p=="string")return p}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function Pm(p){if(Fe&&typeof Buffer<"u"&&p instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(p instanceof Uint8Array&&p.byteLength===p.buffer.byteLength)return p;if(typeof p=="string")return po(p);if(p instanceof ArrayBuffer||ArrayBuffer.isView(p)||typeof p=="object"&&!isNaN(p?.length))return new Uint8Array(p);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function jd(p){return typeof p=="object"&&Number.isInteger(p?.num)&&p.num>=0&&Number.isInteger(p?.gen)&&p.gen>=0}class Oc{static#t=0;constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${Oc.#t++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}}class cf{constructor(t,e,s=!1,r=null){this.length=t,this.initialData=e,this.progressiveDone=s,this.contentDispositionFilename=r,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,e){for(const s of this._rangeListeners)s(t,e)}onDataProgress(t,e){this._readyCapability.promise.then(()=>{for(const s of this._progressListeners)s(t,e)})}onDataProgressiveRead(t){this._readyCapability.promise.then(()=>{for(const e of this._progressiveReadListeners)e(t)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const t of this._progressiveDoneListeners)t()})}transportReady(){this._readyCapability.resolve()}requestDataRange(t,e){Wt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class Rm{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Ot(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class Mm{#t=null;#e=!1;constructor(t,e,s,r=!1){this._pageIndex=t,this._pageInfo=e,this._transport=s,this._stats=r?new xd:null,this._pdfBug=r,this.commonObjs=s.commonObjs,this.objs=new uf,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:s=0,offsetY:r=0,dontFlip:o=!1}={}){return new Or({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:s,offsetY:r,dontFlip:o})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Ot(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,viewport:e,intent:s="display",annotationMode:r=wi.ENABLE,transform:o=null,background:l=null,optionalContentConfigPromise:c=null,annotationCanvasMap:h=null,pageColors:f=null,printAnnotationStorage:g=null,isEditing:v=!1}){this._stats?.time("Overall");const y=this._transport.getRenderingIntent(s,r,g,v),{renderingIntent:A,cacheKey:b}=y;this.#e=!1,this.#i(),c||=this._transport.getOptionalContentConfig(A);let S=this._intentStates.get(b);S||(S=Object.create(null),this._intentStates.set(b,S)),S.streamReaderCancelTimeout&&(clearTimeout(S.streamReaderCancelTimeout),S.streamReaderCancelTimeout=null);const T=!!(A&rn.PRINT);S.displayReadyCapability||(S.displayReadyCapability=Promise.withResolvers(),S.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(y));const C=j=>{S.renderTasks.delete(I),(this._maybeCleanupAfterRender||T)&&(this.#e=!0),this.#n(!T),j?(I.capability.reject(j),this._abortOperatorList({intentState:S,reason:j instanceof Error?j:new Error(j)})):I.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},I=new Is({callback:C,params:{canvasContext:t,viewport:e,transform:o,background:l},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:h,operatorList:S.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!T,pdfBug:this._pdfBug,pageColors:f});(S.renderTasks||=new Set).add(I);const O=I.task;return Promise.all([S.displayReadyCapability.promise,c]).then(([j,H])=>{if(this.destroyed){C();return}if(this._stats?.time("Rendering"),!(H.renderingIntent&A))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");I.initializeGraphics({transparency:j,optionalContentConfig:H}),I.operatorListChanged()}).catch(C),O}getOperatorList({intent:t="display",annotationMode:e=wi.ENABLE,printAnnotationStorage:s=null,isEditing:r=!1}={}){function o(){c.operatorList.lastChunk&&(c.opListReadCapability.resolve(c.operatorList),c.renderTasks.delete(h))}const l=this._transport.getRenderingIntent(t,e,s,r,!0);let c=this._intentStates.get(l.cacheKey);c||(c=Object.create(null),this._intentStates.set(l.cacheKey,c));let h;return c.opListReadCapability||(h=Object.create(null),h.operatorListChanged=o,c.opListReadCapability=Promise.withResolvers(),(c.renderTasks||=new Set).add(h),c.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(l)),c.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(r){return r.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>Dr.textContent(s));const e=this.streamTextContent(t);return new Promise(function(s,r){function o(){l.read().then(function({value:h,done:f}){if(f){s(c);return}c.lang??=h.lang,Object.assign(c.styles,h.styles),c.items.push(...h.items),o()},r)}const l=e.getReader(),c={items:[],styles:Object.create(null),lang:null};o()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const s of e.renderTasks)t.push(s.completed),s.cancel();return this.objs.clear(),this.#e=!1,this.#i(),Promise.all(t)}cleanup(t=!1){this.#e=!0;const e=this.#n(!1);return t&&e&&(this._stats&&=new xd),e}#n(t=!1){if(this.#i(),!this.#e||this.destroyed)return!1;if(t)return this.#t=setTimeout(()=>{this.#t=null,this.#n(!1)},_m),!1;for(const{renderTasks:e,operatorList:s}of this._intentStates.values())if(e.size>0||!s.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#e=!1,!0}#i(){this.#t&&(clearTimeout(this.#t),this.#t=null)}_startRenderPage(t,e){const s=this._intentStates.get(e);s&&(this._stats?.timeEnd("Page Request"),s.displayReadyCapability?.resolve(t))}_renderPageChunk(t,e){for(let s=0,r=t.length;s<r;s++)e.operatorList.fnArray.push(t.fnArray[s]),e.operatorList.argsArray.push(t.argsArray[s]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const s of e.renderTasks)s.operatorListChanged();t.lastChunk&&this.#n(!0)}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:s,modifiedIds:r}){const{map:o,transfer:l}=s,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:o,modifiedIds:r},l).getReader(),f=this._intentStates.get(e);f.streamReader=h;const g=()=>{h.read().then(({value:v,done:y})=>{if(y){f.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(v,f),g())},v=>{if(f.streamReader=null,!this._transport.destroyed){if(f.operatorList){f.operatorList.lastChunk=!0;for(const y of f.renderTasks)y.operatorListChanged();this.#n(!0)}if(f.displayReadyCapability)f.displayReadyCapability.reject(v);else if(f.opListReadCapability)f.opListReadCapability.reject(v);else throw v}})};g()}_abortOperatorList({intentState:t,reason:e,force:s=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!s){if(t.renderTasks.size>0)return;if(e instanceof Pc){let r=bm;e.extraDelay>0&&e.extraDelay<1e3&&(r+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},r);return}}if(t.streamReader.cancel(new bi(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[r,o]of this._intentStates)if(o===t){this._intentStates.delete(r);break}this.cleanup()}}}get stats(){return this._stats}}class Lm{#t=new Map;#e=Promise.resolve();postMessage(t,e){const s={data:structuredClone(t,e?{transfer:e}:null)};this.#e.then(()=>{for(const[r]of this.#t)r.call(this,s)})}addEventListener(t,e,s=null){let r=null;if(s?.signal instanceof AbortSignal){const{signal:o}=s;if(o.aborted){Rt("LoopbackPort - cannot use an `aborted` signal.");return}const l=()=>this.removeEventListener(t,e);r=()=>o.removeEventListener("abort",l),o.addEventListener("abort",l)}this.#t.set(e,r)}removeEventListener(t,e){this.#t.get(e)?.(),this.#t.delete(e)}terminate(){for(const[,t]of this.#t)t?.();this.#t.clear()}}var co,Yi,Ki,Os,ro,js,ao;const ne=class ne{constructor({name:t=null,port:e=null,verbosity:s=fg()}={}){Ls(this,Os);if(this.name=t,this.destroyed=!1,this.verbosity=s,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,e){if(Sn(ne,Ki)?.has(e))throw new Error("Cannot use more than one PDFWorker per port.");(Sn(ne,Ki)||xr(ne,Ki,new WeakMap)).set(e,this),this._initializeFromPort(e);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(t){this._port=t,this._messageHandler=new Mr("main","worker",t),this._messageHandler.on("ready",function(){}),Za(this,Os,ro).call(this)}_initialize(){if(Sn(ne,Yi)||Sn(ne,js,ao)){this._setupFakeWorker();return}let{workerSrc:t}=ne;try{ne._isSameOrigin(window.location.href,t)||(t=ne._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),s=new Mr("main","worker",e),r=()=>{o.abort(),s.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},o=new AbortController;e.addEventListener("error",()=>{this._webWorker||r()},{signal:o.signal}),s.on("test",c=>{if(o.abort(),this.destroyed||!c){r();return}this._messageHandler=s,this._port=e,this._webWorker=e,Za(this,Os,ro).call(this)}),s.on("ready",c=>{if(o.abort(),this.destroyed){r();return}try{l()}catch{this._setupFakeWorker()}});const l=()=>{const c=new Uint8Array;s.send("test",c,[c.buffer])};l();return}catch{fo("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){Sn(ne,Yi)||(Rt("Setting up fake worker."),xr(ne,Yi,!0)),ne._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const e=new Lm;this._port=e;const s=`fake${dd(ne,co)._++}`,r=new Mr(s+"_worker",s,e);t.setup(r,e),this._messageHandler=new Mr(s,s+"_worker",e),Za(this,Os,ro).call(this)}).catch(t=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${t.message}".`))})}destroy(){this.destroyed=!0,this._webWorker?.terminate(),this._webWorker=null,Sn(ne,Ki)?.delete(this._port),this._port=null,this._messageHandler?.destroy(),this._messageHandler=null}static fromPort(t){if(!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");const e=Sn(this,Ki)?.get(t.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new ne(t)}static get workerSrc(){if(Ir.workerSrc)return Ir.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Ot(this,"_setupFakeWorkerGlobal",(async()=>Sn(this,js,ao)?Sn(this,js,ao):(await import(this.workerSrc)).WorkerMessageHandler)())}};co=new WeakMap,Yi=new WeakMap,Ki=new WeakMap,Os=new WeakSet,ro=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},js=new WeakSet,ao=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},Ls(ne,js),Ls(ne,co,0),Ls(ne,Yi,!1),Ls(ne,Ki),Fe&&(xr(ne,Yi,!0),Ir.workerSrc||="./pdf.worker.mjs"),ne._isSameOrigin=(t,e)=>{let s;try{if(s=new URL(t),!s.origin||s.origin==="null")return!1}catch{return!1}const r=new URL(e,s);return s.origin===r.origin},ne._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))};let Ds=ne;class Nm{#t=new Map;#e=new Map;#n=new Map;#i=new Map;#r=null;constructor(t,e,s,r,o){this.messageHandler=t,this.loadingTask=e,this.commonObjs=new uf,this.fontLoader=new Lg({ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this.loadingParams=r.loadingParams,this._params=r,this.canvasFactory=o.canvasFactory,this.filterFactory=o.filterFactory,this.cMapReaderFactory=o.cMapReaderFactory,this.standardFontDataFactory=o.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}#s(t,e=null){const s=this.#t.get(t);if(s)return s;const r=this.messageHandler.sendWithPromise(t,e);return this.#t.set(t,r),r}get annotationStorage(){return Ot(this,"annotationStorage",new Ic)}getRenderingIntent(t,e=wi.ENABLE,s=null,r=!1,o=!1){let l=rn.DISPLAY,c=bc;switch(t){case"any":l=rn.ANY;break;case"display":break;case"print":l=rn.PRINT;break;default:Rt(`getRenderingIntent - invalid intent: ${t}`)}const h=l&rn.PRINT&&s instanceof qd?s:this.annotationStorage;switch(e){case wi.DISABLE:l+=rn.ANNOTATIONS_DISABLE;break;case wi.ENABLE:break;case wi.ENABLE_FORMS:l+=rn.ANNOTATIONS_FORMS;break;case wi.ENABLE_STORAGE:l+=rn.ANNOTATIONS_STORAGE,c=h.serializable;break;default:Rt(`getRenderingIntent - invalid annotationMode: ${e}`)}r&&(l+=rn.IS_EDITING),o&&(l+=rn.OPLIST);const{ids:f,hash:g}=h.modifiedIds,v=[l,c.hash,g];return{renderingIntent:l,cacheKey:v.join("_"),annotationStorageSerializable:c,modifiedIds:f}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#r?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const s of this.#e.values())t.push(s._destroy());this.#e.clear(),this.#n.clear(),this.#i.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),He.cleanup(),this._networkStream?.cancelAllRequests(new bi("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(s,r)=>{me(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=o=>{this._lastProgress={loaded:o.loaded,total:o.total}},r.onPull=()=>{this._fullReader.read().then(function({value:o,done:l}){if(l){r.close();return}me(o instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{r.error(o)})},r.onCancel=o=>{this._fullReader.cancel(o),r.ready.catch(l=>{if(!this.destroyed)throw l})}}),t.on("ReaderHeadersReady",async s=>{await this._fullReader.headersReady;const{isStreamingSupported:r,isRangeSupported:o,contentLength:l}=this._fullReader;return(!r||!o)&&(this._lastProgress&&e.onProgress?.(this._lastProgress),this._fullReader.onProgress=c=>{e.onProgress?.({loaded:c.loaded,total:c.total})}),{isStreamingSupported:r,isRangeSupported:o,contentLength:l}}),t.on("GetRangeReader",(s,r)=>{me(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const o=this._networkStream.getRangeReader(s.begin,s.end);if(!o){r.close();return}r.onPull=()=>{o.read().then(function({value:l,done:c}){if(c){r.close();return}me(l instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{r.error(l)})},r.onCancel=l=>{o.cancel(l),r.ready.catch(c=>{if(!this.destroyed)throw c})}}),t.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,e._capability.resolve(new Rm(s,this))}),t.on("DocException",s=>{e._capability.reject(Ke(s))}),t.on("PasswordRequest",s=>{this.#r=Promise.withResolvers();try{if(!e.onPassword)throw Ke(s);const r=o=>{o instanceof Error?this.#r.reject(o):this.#r.resolve({password:o})};e.onPassword(r,s.code)}catch(r){this.#r.reject(r)}return this.#r.promise}),t.on("DataLoaded",s=>{e.onProgress?.({loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),t.on("StartRenderPage",s=>{if(this.destroyed)return;this.#e.get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),t.on("commonobj",([s,r,o])=>{if(this.destroyed||this.commonObjs.has(s))return null;switch(r){case"Font":const{disableFontFace:l,fontExtraProperties:c,pdfBug:h}=this._params;if("error"in o){const y=o.error;Rt(`Error during font loading: ${y}`),this.commonObjs.resolve(s,y);break}const f=h&&globalThis.FontInspector?.enabled?(y,A)=>globalThis.FontInspector.fontAdded(y,A):null,g=new Ng(o,{disableFontFace:l,fontExtraProperties:c,inspectFont:f});this.fontLoader.bind(g).catch(()=>t.sendWithPromise("FontFallback",{id:s})).finally(()=>{!c&&g.data&&(g.data=null),this.commonObjs.resolve(s,g)});break;case"CopyLocalImage":const{imageRef:v}=o;me(v,"The imageRef must be defined.");for(const y of this.#e.values())for(const[,A]of y.objs)if(A?.ref===v)return A.dataLen?(this.commonObjs.resolve(s,structuredClone(A)),A.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(s,o);break;default:throw new Error(`Got unknown common object type ${r}`)}return null}),t.on("obj",([s,r,o,l])=>{if(this.destroyed)return;const c=this.#e.get(r);if(!c.objs.has(s)){if(c._intentStates.size===0){l?.bitmap?.close();return}switch(o){case"Image":c.objs.resolve(s,l),l?.dataLen>lg&&(c._maybeCleanupAfterRender=!0);break;case"Pattern":c.objs.resolve(s,l);break;default:throw new Error(`Got unknown object type ${o}`)}}}),t.on("DocProgress",s=>{this.destroyed||e.onProgress?.({loaded:s.loaded,total:s.total})}),t.on("FetchBuiltInCMap",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(s)}),t.on("FetchStandardFontData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&Rt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},e).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,s=this.#n.get(e);if(s)return s;const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(o=>{if(this.destroyed)throw new Error("Transport destroyed");o.refStr&&this.#i.set(o.refStr,t);const l=new Mm(e,o,this,this._params.pdfBug);return this.#e.set(e,l),l});return this.#n.set(e,r),r}getPageIndex(t){return jd(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return this.#s("GetFieldObjects")}hasJSActions(){return this.#s("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#s("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#s("GetOptionalContentConfig").then(e=>new em(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=this.#t.get(t);if(e)return e;const s=this.messageHandler.sendWithPromise(t,null).then(r=>({info:r[0],metadata:r[1]?new Jg(r[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#t.set(t,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of this.#e.values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0),He.cleanup()}}cachedPageNumber(t){if(!jd(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return this.#i.get(e)??null}}const Tr=Symbol("INITIAL_DATA");class uf{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:Tr}}get(t,e=null){if(e){const r=this.#e(t);return r.promise.then(()=>e(r.data)),null}const s=this.#t[t];if(!s||s.data===Tr)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return s.data}has(t){const e=this.#t[t];return!!e&&e.data!==Tr}delete(t){const e=this.#t[t];return!e||e.data===Tr?!1:(delete this.#t[t],!0)}resolve(t,e=null){const s=this.#e(t);s.data=e,s.resolve()}clear(){for(const t in this.#t){const{data:e}=this.#t[t];e?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:e}=this.#t[t];e!==Tr&&(yield[t,e])}}}class Im{#t=null;constructor(t){this.#t=t,this.onContinue=null}get promise(){return this.#t.capability.promise}cancel(t=0){this.#t.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#t.operatorList;if(!t)return!1;const{annotationCanvasMap:e}=this.#t;return t.form||t.canvas&&e?.size>0}}class Is{#t=null;static#e=new WeakSet;constructor({callback:t,params:e,objs:s,commonObjs:r,annotationCanvasMap:o,operatorList:l,pageIndex:c,canvasFactory:h,filterFactory:f,useRequestAnimationFrame:g=!1,pdfBug:v=!1,pageColors:y=null}){this.callback=t,this.params=e,this.objs=s,this.commonObjs=r,this.annotationCanvasMap=o,this.operatorListIdx=null,this.operatorList=l,this._pageIndex=c,this.canvasFactory=h,this.filterFactory=f,this._pdfBug=v,this.pageColors=y,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=g===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new Im(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){if(this.cancelled)return;if(this._canvas){if(Is.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");Is.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:s,viewport:r,transform:o,background:l}=this.params;this.gfx=new Fs(s,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:o,viewport:r,transparency:t,background:l}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,e=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),Is.#e.delete(this._canvas),this.callback(t||new Pc(`Rendering cancelled, page ${this._pageIndex+1}`,e))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),Is.#e.delete(this._canvas),this.callback())))}}const Fm="4.10.38",Dm="f9bea397f";function zd(p){return Math.floor(Math.max(0,Math.min(1,p))*255).toString(16).padStart(2,"0")}function Pr(p){return Math.max(0,Math.min(255,255*p))}class Hd{static CMYK_G([t,e,s,r]){return["G",1-Math.min(1,.3*t+.59*s+.11*e+r)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=Pr(t),[t,t,t]}static G_HTML([t]){const e=zd(t);return`#${e}${e}${e}`}static RGB_G([t,e,s]){return["G",.3*t+.59*e+.11*s]}static RGB_rgb(t){return t.map(Pr)}static RGB_HTML(t){return`#${t.map(zd).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,s,r]){return["RGB",1-Math.min(1,t+r),1-Math.min(1,s+r),1-Math.min(1,e+r)]}static CMYK_rgb([t,e,s,r]){return[Pr(1-Math.min(1,t+r)),Pr(1-Math.min(1,s+r)),Pr(1-Math.min(1,e+r))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,s]){const r=1-t,o=1-e,l=1-s,c=Math.min(r,o,l);return["CMYK",r,o,l,c]}}class Om{create(t,e,s=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const r=this._createSVG("svg:svg");return r.setAttribute("version","1.1"),s||(r.setAttribute("width",`${t}px`),r.setAttribute("height",`${e}px`)),r.setAttribute("preserveAspectRatio","none"),r.setAttribute("viewBox",`0 0 ${t} ${e}`),r}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){Wt("Abstract method `_createSVG` called.")}}class jc extends Om{_createSVG(t){return document.createElementNS(Xn,t)}}class hf{static setupStorage(t,e,s,r,o){const l=r.getValue(e,{value:null});switch(s.name){case"textarea":if(l.value!==null&&(t.textContent=l.value),o==="print")break;t.addEventListener("input",c=>{r.setValue(e,{value:c.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(l.value===s.attributes.xfaOn?t.setAttribute("checked",!0):l.value===s.attributes.xfaOff&&t.removeAttribute("checked"),o==="print")break;t.addEventListener("change",c=>{r.setValue(e,{value:c.target.checked?c.target.getAttribute("xfaOn"):c.target.getAttribute("xfaOff")})})}else{if(l.value!==null&&t.setAttribute("value",l.value),o==="print")break;t.addEventListener("input",c=>{r.setValue(e,{value:c.target.value})})}break;case"select":if(l.value!==null){t.setAttribute("value",l.value);for(const c of s.children)c.attributes.value===l.value?c.attributes.selected=!0:c.attributes.hasOwnProperty("selected")&&delete c.attributes.selected}t.addEventListener("input",c=>{const h=c.target.options,f=h.selectedIndex===-1?"":h[h.selectedIndex].value;r.setValue(e,{value:f})});break}}static setAttributes({html:t,element:e,storage:s=null,intent:r,linkService:o}){const{attributes:l}=e,c=t instanceof HTMLAnchorElement;l.type==="radio"&&(l.name=`${l.name}-${r}`);for(const[h,f]of Object.entries(l))if(f!=null)switch(h){case"class":f.length&&t.setAttribute(h,f.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",f);break;case"style":Object.assign(t.style,f);break;case"textContent":t.textContent=f;break;default:(!c||h!=="href"&&h!=="newWindow")&&t.setAttribute(h,f)}c&&o.addLinkAttributes(t,l.href,l.newWindow),s&&l.dataId&&this.setupStorage(t,l.dataId,e,s)}static render(t){const e=t.annotationStorage,s=t.linkService,r=t.xfaHtml,o=t.intent||"display",l=document.createElement(r.name);r.attributes&&this.setAttributes({html:l,element:r,intent:o,linkService:s});const c=o!=="richText",h=t.div;if(h.append(l),t.viewport){const v=`matrix(${t.viewport.transform.join(",")})`;h.style.transform=v}c&&h.setAttribute("class","xfaLayer xfaFont");const f=[];if(r.children.length===0){if(r.value){const v=document.createTextNode(r.value);l.append(v),c&&Dr.shouldBuildText(r.name)&&f.push(v)}return{textDivs:f}}const g=[[r,-1,l]];for(;g.length>0;){const[v,y,A]=g.at(-1);if(y+1===v.children.length){g.pop();continue}const b=v.children[++g.at(-1)[1]];if(b===null)continue;const{name:S}=b;if(S==="#text"){const C=document.createTextNode(b.value);f.push(C),A.append(C);continue}const T=b?.attributes?.xmlns?document.createElementNS(b.attributes.xmlns,S):document.createElement(S);if(A.append(T),b.attributes&&this.setAttributes({html:T,element:b,storage:e,intent:o,linkService:s}),b.children?.length>0)g.push([b,-1,T]);else if(b.value){const C=document.createTextNode(b.value);c&&Dr.shouldBuildText(S)&&f.push(C),T.append(C)}}for(const v of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))v.setAttribute("readOnly",!0);return{textDivs:f}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const zr=1e3,jm=9,Zi=new WeakSet;function Ai(p){return{width:p[2]-p[0],height:p[3]-p[1]}}class zm{static create(t){switch(t.data.annotationType){case we.LINK:return new df(t);case we.TEXT:return new Hm(t);case we.WIDGET:switch(t.data.fieldType){case"Tx":return new Bm(t);case"Btn":return t.data.radioButton?new ff(t):t.data.checkBox?new $m(t):new Vm(t);case"Ch":return new Gm(t);case"Sig":return new Um(t)}return new Ji(t);case we.POPUP:return new Sc(t);case we.FREETEXT:return new pf(t);case we.LINE:return new Xm(t);case we.SQUARE:return new qm(t);case we.CIRCLE:return new Ym(t);case we.POLYLINE:return new gf(t);case we.CARET:return new Qm(t);case we.INK:return new zc(t);case we.POLYGON:return new Km(t);case we.HIGHLIGHT:return new mf(t);case we.UNDERLINE:return new Zm(t);case we.SQUIGGLY:return new Jm(t);case we.STRIKEOUT:return new tv(t);case we.STAMP:return new vf(t);case we.FILEATTACHMENT:return new ev(t);default:return new de(t)}}}class de{#t=null;#e=!1;#n=null;constructor(t,{isRenderable:e=!1,ignoreBorder:s=!1,createQuadrilaterals:r=!1}={}){this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(s)),r&&this._createQuadrilaterals()}static _hasPopupData({titleObj:t,contentsObj:e,richText:s}){return!!(t?.str||e?.str||s?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return de._hasPopupData(this.data)}updateEdited(t){if(!this.container)return;this.#t||={rect:this.data.rect.slice(0)};const{rect:e}=t;e&&this.#i(e),this.#n?.popup.updateEdited(t)}resetEdited(){this.#t&&(this.#i(this.#t.rect),this.#n?.popup.resetEdited(),this.#t=null)}#i(t){const{container:{style:e},data:{rect:s,rotation:r},parent:{viewport:{rawDims:{pageWidth:o,pageHeight:l,pageX:c,pageY:h}}}}=this;s?.splice(0,4,...t);const{width:f,height:g}=Ai(t);e.left=`${100*(t[0]-c)/o}%`,e.top=`${100*(l-t[3]+h)/l}%`,r===0?(e.width=`${100*f/o}%`,e.height=`${100*g/l}%`):this.setRotation(r)}_createContainer(t){const{data:e,parent:{page:s,viewport:r}}=this,o=document.createElement("section");o.setAttribute("data-annotation-id",e.id),this instanceof Ji||(o.tabIndex=zr);const{style:l}=o;if(l.zIndex=this.parent.zIndex++,e.alternativeText&&(o.title=e.alternativeText),e.noRotate&&o.classList.add("norotate"),!e.rect||this instanceof Sc){const{rotation:S}=e;return!e.hasOwnCanvas&&S!==0&&this.setRotation(S,o),o}const{width:c,height:h}=Ai(e.rect);if(!t&&e.borderStyle.width>0){l.borderWidth=`${e.borderStyle.width}px`;const S=e.borderStyle.horizontalCornerRadius,T=e.borderStyle.verticalCornerRadius;if(S>0||T>0){const I=`calc(${S}px * var(--scale-factor)) / calc(${T}px * var(--scale-factor))`;l.borderRadius=I}else if(this instanceof ff){const I=`calc(${c}px * var(--scale-factor)) / calc(${h}px * var(--scale-factor))`;l.borderRadius=I}switch(e.borderStyle.style){case Cr.SOLID:l.borderStyle="solid";break;case Cr.DASHED:l.borderStyle="dashed";break;case Cr.BEVELED:Rt("Unimplemented border style: beveled");break;case Cr.INSET:Rt("Unimplemented border style: inset");break;case Cr.UNDERLINE:l.borderBottomStyle="solid";break}const C=e.borderColor||null;C?(this.#e=!0,l.borderColor=ht.makeHexColor(C[0]|0,C[1]|0,C[2]|0)):l.borderWidth=0}const f=ht.normalizeRect([e.rect[0],s.view[3]-e.rect[1]+s.view[1],e.rect[2],s.view[3]-e.rect[3]+s.view[1]]),{pageWidth:g,pageHeight:v,pageX:y,pageY:A}=r.rawDims;l.left=`${100*(f[0]-y)/g}%`,l.top=`${100*(f[1]-A)/v}%`;const{rotation:b}=e;return e.hasOwnCanvas||b===0?(l.width=`${100*c/g}%`,l.height=`${100*h/v}%`):this.setRotation(b,o),o}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:r}=this.parent.viewport.rawDims,{width:o,height:l}=Ai(this.data.rect);let c,h;t%180===0?(c=100*o/s,h=100*l/r):(c=100*l/s,h=100*o/r),e.style.width=`${c}%`,e.style.height=`${h}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,s,r)=>{const o=r.detail[e],l=o[0],c=o.slice(1);r.target.style[s]=Hd[`${l}_HTML`](c),this.annotationStorage.setValue(this.data.id,{[s]:Hd[`${l}_rgb`](c)})};return Ot(this,"_commonActions",{display:e=>{const{display:s}=e.detail,r=s%2===1;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:r,noPrint:s===1||s===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:s}=e.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const s=e.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(t,e){const s=this._commonActions;for(const r of Object.keys(e.detail))(t[r]||s[r])?.(e)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const s=this._commonActions;for(const[r,o]of Object.entries(e)){const l=s[r];if(l){const c={detail:{[r]:o},target:t};l(c),delete e[r]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,s,r,o]=this.data.rect.map(S=>Math.fround(S));if(t.length===8){const[S,T,C,I]=t.subarray(2,6);if(r===S&&o===T&&e===C&&s===I)return}const{style:l}=this.container;let c;if(this.#e){const{borderColor:S,borderWidth:T}=l;l.borderWidth=0,c=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${S}" stroke-width="${T}">`],this.container.classList.add("hasBorder")}const h=r-e,f=o-s,{svgFactory:g}=this,v=g.createElement("svg");v.classList.add("quadrilateralsContainer"),v.setAttribute("width",0),v.setAttribute("height",0);const y=g.createElement("defs");v.append(y);const A=g.createElement("clipPath"),b=`clippath_${this.data.id}`;A.setAttribute("id",b),A.setAttribute("clipPathUnits","objectBoundingBox"),y.append(A);for(let S=2,T=t.length;S<T;S+=8){const C=t[S],I=t[S+1],O=t[S+2],j=t[S+3],H=g.createElement("rect"),W=(O-e)/h,V=(o-I)/f,it=(C-O)/h,X=(I-j)/f;H.setAttribute("x",W),H.setAttribute("y",V),H.setAttribute("width",it),H.setAttribute("height",X),A.append(H),c?.push(`<rect vector-effect="non-scaling-stroke" x="${W}" y="${V}" width="${it}" height="${X}"/>`)}this.#e&&(c.push("</g></svg>')"),l.backgroundImage=c.join("")),this.container.append(v),this.container.style.clipPath=`url(#${b})`}_createPopup(){const{data:t}=this,e=this.#n=new Sc({data:{color:t.color,titleObj:t.titleObj,modificationDate:t.modificationDate,contentsObj:t.contentsObj,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation},parent:this.parent,elements:[this]});this.parent.div.append(e.render())}render(){Wt("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const s=[];if(this._fieldObjects){const r=this._fieldObjects[t];if(r)for(const{page:o,id:l,exportValues:c}of r){if(o===-1||l===e)continue;const h=typeof c=="string"?c:null,f=document.querySelector(`[data-element-id="${l}"]`);if(f&&!Zi.has(f)){Rt(`_getElementsByName - element not allowed: ${l}`);continue}s.push({id:l,exportValue:h,domElement:f})}return s}for(const r of document.getElementsByName(t)){const{exportValue:o}=r,l=r.getAttribute("data-element-id");l!==e&&Zi.has(r)&&s.push({id:l,exportValue:o,domElement:r})}return s}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e})})}}class df extends de{constructor(t,e=null){super(t,{isRenderable:!0,ignoreBorder:!!e?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:e}=this,s=document.createElement("a");s.setAttribute("data-element-id",t.id);let r=!1;return t.url?(e.addLinkAttributes(s,t.url,t.newWindow),r=!0):t.action?(this._bindNamedAction(s,t.action),r=!0):t.attachment?(this.#e(s,t.attachment,t.attachmentDest),r=!0):t.setOCGState?(this.#n(s,t.setOCGState),r=!0):t.dest?(this._bindLink(s,t.dest),r=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,t),r=!0),t.resetForm?(this._bindResetFormAction(s,t.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(s,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&this.container.append(s),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,e){t.href=this.linkService.getDestinationHash(e),t.onclick=()=>(e&&this.linkService.goToDestination(e),!1),(e||e==="")&&this.#t()}_bindNamedAction(t,e){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(e),!1),this.#t()}#e(t,e,s=null){t.href=this.linkService.getAnchorUrl(""),e.description&&(t.title=e.description),t.onclick=()=>(this.downloadManager?.openOrDownloadData(e.content,e.filename,s),!1),this.#t()}#n(t,e){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(e),!1),this.#t()}_bindJSAction(t,e){t.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(e.actions)){const o=s.get(r);o&&(t[o]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e.id,name:r}}),!1))}t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,e){const s=t.onclick;if(s||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){Rt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(t.onclick=()=>!1);return}t.onclick=()=>{s?.();const{fields:r,refs:o,include:l}=e,c=[];if(r.length!==0||o.length!==0){const g=new Set(o);for(const v of r){const y=this._fieldObjects[v]||[];for(const{id:A}of y)g.add(A)}for(const v of Object.values(this._fieldObjects))for(const y of v)g.has(y.id)===l&&c.push(y)}else for(const g of Object.values(this._fieldObjects))c.push(...g);const h=this.annotationStorage,f=[];for(const g of c){const{id:v}=g;switch(f.push(v),g.type){case"text":{const A=g.defaultValue||"";h.setValue(v,{value:A});break}case"checkbox":case"radiobutton":{const A=g.defaultValue===g.exportValues;h.setValue(v,{value:A});break}case"combobox":case"listbox":{const A=g.defaultValue||"";h.setValue(v,{value:A});break}default:continue}const y=document.querySelector(`[data-element-id="${v}"]`);if(y){if(!Zi.has(y)){Rt(`_bindResetFormAction - element not allowed: ${v}`);continue}}else continue;y.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:f,name:"ResetForm"}}),!1}}}class Hm extends de{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class Ji extends de{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return Be.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,s,r,o){s.includes("mouse")?t.addEventListener(s,l=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:o(l),shift:l.shiftKey,modifier:this._getKeyModifier(l)}})}):t.addEventListener(s,l=>{if(s==="blur"){if(!e.focused||!l.relatedTarget)return;e.focused=!1}else if(s==="focus"){if(e.focused)return;e.focused=!0}o&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:o(l)}})})}_setEventListeners(t,e,s,r){for(const[o,l]of s)(l==="Action"||this.data.actions?.[l])&&((l==="Focus"||l==="Blur")&&(e||={focused:!1}),this._setEventListener(t,e,o,l,r),l==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,e,"blur","Blur",null):l==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":ht.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,r=this.data.defaultAppearanceData.fontSize||jm,o=t.style;let l;const c=2,h=f=>Math.round(10*f)/10;if(this.data.multiLine){const f=Math.abs(this.data.rect[3]-this.data.rect[1]-c),g=Math.round(f/(oc*r))||1,v=f/g;l=Math.min(r,h(v/oc))}else{const f=Math.abs(this.data.rect[3]-this.data.rect[1]-c);l=Math.min(r,h(f/oc))}o.fontSize=`calc(${l}px * var(--scale-factor))`,o.color=ht.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(o.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class Bm extends Ji{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,s,r){const o=this.annotationStorage;for(const l of this._getElementsByName(t.name,t.id))l.domElement&&(l.domElement[e]=s),o.setValue(l.id,{[r]:s})}render(){const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const r=t.getValue(e,{value:this.data.fieldValue});let o=r.value||"";const l=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;l&&o.length>l&&(o=o.slice(0,l));let c=r.formattedValue||this.data.textContent?.join(`
`)||null;c&&this.data.comb&&(c=c.replaceAll(/\s+/g,""));const h={userValue:o,formattedValue:c,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=c??o,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type="text",s.setAttribute("value",c??o),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),Zi.add(s),s.setAttribute("data-element-id",e),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=zr,this._setRequired(s,this.data.required),l&&(s.maxLength=l),s.addEventListener("input",g=>{t.setValue(e,{value:g.target.value}),this.setPropertyOnSiblings(s,"value",g.target.value,"value"),h.formattedValue=null}),s.addEventListener("resetform",g=>{const v=this.data.defaultFieldValue??"";s.value=h.userValue=v,h.formattedValue=null});let f=g=>{const{formattedValue:v}=h;v!=null&&(g.target.value=v),g.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",v=>{if(h.focused)return;const{target:y}=v;h.userValue&&(y.value=h.userValue),h.lastCommittedValue=y.value,h.commitKey=1,this.data.actions?.Focus||(h.focused=!0)}),s.addEventListener("updatefromsandbox",v=>{this.showElementAndHideCanvas(v.target);const y={value(A){h.userValue=A.detail.value??"",t.setValue(e,{value:h.userValue.toString()}),A.target.value=h.userValue},formattedValue(A){const{formattedValue:b}=A.detail;h.formattedValue=b,b!=null&&A.target!==document.activeElement&&(A.target.value=b),t.setValue(e,{formattedValue:b})},selRange(A){A.target.setSelectionRange(...A.detail.selRange)},charLimit:A=>{const{charLimit:b}=A.detail,{target:S}=A;if(b===0){S.removeAttribute("maxLength");return}S.setAttribute("maxLength",b);let T=h.userValue;!T||T.length<=b||(T=T.slice(0,b),S.value=h.userValue=T,t.setValue(e,{value:T}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:T,willCommit:!0,commitKey:1,selStart:S.selectionStart,selEnd:S.selectionEnd}}))}};this._dispatchEventFromSandbox(y,v)}),s.addEventListener("keydown",v=>{h.commitKey=1;let y=-1;if(v.key==="Escape"?y=0:v.key==="Enter"&&!this.data.multiLine?y=2:v.key==="Tab"&&(h.commitKey=3),y===-1)return;const{value:A}=v.target;h.lastCommittedValue!==A&&(h.lastCommittedValue=A,h.userValue=A,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:A,willCommit:!0,commitKey:y,selStart:v.target.selectionStart,selEnd:v.target.selectionEnd}}))});const g=f;f=null,s.addEventListener("blur",v=>{if(!h.focused||!v.relatedTarget)return;this.data.actions?.Blur||(h.focused=!1);const{value:y}=v.target;h.userValue=y,h.lastCommittedValue!==y&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:y,willCommit:!0,commitKey:h.commitKey,selStart:v.target.selectionStart,selEnd:v.target.selectionEnd}}),g(v)}),this.data.actions?.Keystroke&&s.addEventListener("beforeinput",v=>{h.lastCommittedValue=null;const{data:y,target:A}=v,{value:b,selectionStart:S,selectionEnd:T}=A;let C=S,I=T;switch(v.inputType){case"deleteWordBackward":{const O=b.substring(0,S).match(/\w*[^\w]*$/);O&&(C-=O[0].length);break}case"deleteWordForward":{const O=b.substring(S).match(/^[^\w]*\w*/);O&&(I+=O[0].length);break}case"deleteContentBackward":S===T&&(C-=1);break;case"deleteContentForward":S===T&&(I+=1);break}v.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:b,change:y||"",willCommit:!1,selStart:C,selEnd:I}})}),this._setEventListeners(s,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],v=>v.target.value)}if(f&&s.addEventListener("blur",f),this.data.comb){const v=(this.data.rect[2]-this.data.rect[0])/l;s.classList.add("comb"),s.style.letterSpacing=`calc(${v}px * var(--scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class Um extends Ji{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class $m extends Ji{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,s=e.id;let r=t.getValue(s,{value:e.exportValue===e.fieldValue}).value;typeof r=="string"&&(r=r!=="Off",t.setValue(s,{value:r})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const o=document.createElement("input");return Zi.add(o),o.setAttribute("data-element-id",s),o.disabled=e.readOnly,this._setRequired(o,this.data.required),o.type="checkbox",o.name=e.fieldName,r&&o.setAttribute("checked",!0),o.setAttribute("exportValue",e.exportValue),o.tabIndex=zr,o.addEventListener("change",l=>{const{name:c,checked:h}=l.target;for(const f of this._getElementsByName(c,s)){const g=h&&f.exportValue===e.exportValue;f.domElement&&(f.domElement.checked=g),t.setValue(f.id,{value:g})}t.setValue(s,{value:h})}),o.addEventListener("resetform",l=>{const c=e.defaultFieldValue||"Off";l.target.checked=c===e.exportValue}),this.enableScripting&&this.hasJSActions&&(o.addEventListener("updatefromsandbox",l=>{const c={value(h){h.target.checked=h.detail.value!=="Off",t.setValue(s,{value:h.target.checked})}};this._dispatchEventFromSandbox(c,l)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)),this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class ff extends Ji{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,s=e.id;let r=t.getValue(s,{value:e.fieldValue===e.buttonValue}).value;if(typeof r=="string"&&(r=r!==e.buttonValue,t.setValue(s,{value:r})),r)for(const l of this._getElementsByName(e.fieldName,s))t.setValue(l.id,{value:!1});const o=document.createElement("input");if(Zi.add(o),o.setAttribute("data-element-id",s),o.disabled=e.readOnly,this._setRequired(o,this.data.required),o.type="radio",o.name=e.fieldName,r&&o.setAttribute("checked",!0),o.tabIndex=zr,o.addEventListener("change",l=>{const{name:c,checked:h}=l.target;for(const f of this._getElementsByName(c,s))t.setValue(f.id,{value:!1});t.setValue(s,{value:h})}),o.addEventListener("resetform",l=>{const c=e.defaultFieldValue;l.target.checked=c!=null&&c===e.buttonValue}),this.enableScripting&&this.hasJSActions){const l=e.buttonValue;o.addEventListener("updatefromsandbox",c=>{const h={value:f=>{const g=l===f.detail.value;for(const v of this._getElementsByName(f.target.name)){const y=g&&v.id===s;v.domElement&&(v.domElement.checked=y),t.setValue(v.id,{value:y})}}};this._dispatchEventFromSandbox(h,c)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)}return this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class Vm extends df{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),t}}class Gm extends Ji{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,s=t.getValue(e,{value:this.data.fieldValue}),r=document.createElement("select");Zi.add(r),r.setAttribute("data-element-id",e),r.disabled=this.data.readOnly,this._setRequired(r,this.data.required),r.name=this.data.fieldName,r.tabIndex=zr;let o=this.data.combo&&this.data.options.length>0;this.data.combo||(r.size=this.data.options.length,this.data.multiSelect&&(r.multiple=!0)),r.addEventListener("resetform",g=>{const v=this.data.defaultFieldValue;for(const y of r.options)y.selected=y.value===v});for(const g of this.data.options){const v=document.createElement("option");v.textContent=g.displayValue,v.value=g.exportValue,s.value.includes(g.exportValue)&&(v.setAttribute("selected",!0),o=!1),r.append(v)}let l=null;if(o){const g=document.createElement("option");g.value=" ",g.setAttribute("hidden",!0),g.setAttribute("selected",!0),r.prepend(g),l=()=>{g.remove(),r.removeEventListener("input",l),l=null},r.addEventListener("input",l)}const c=g=>{const v=g?"value":"textContent",{options:y,multiple:A}=r;return A?Array.prototype.filter.call(y,b=>b.selected).map(b=>b[v]):y.selectedIndex===-1?null:y[y.selectedIndex][v]};let h=c(!1);const f=g=>{const v=g.target.options;return Array.prototype.map.call(v,y=>({displayValue:y.textContent,exportValue:y.value}))};return this.enableScripting&&this.hasJSActions?(r.addEventListener("updatefromsandbox",g=>{const v={value(y){l?.();const A=y.detail.value,b=new Set(Array.isArray(A)?A:[A]);for(const S of r.options)S.selected=b.has(S.value);t.setValue(e,{value:c(!0)}),h=c(!1)},multipleSelection(y){r.multiple=!0},remove(y){const A=r.options,b=y.detail.remove;A[b].selected=!1,r.remove(b),A.length>0&&Array.prototype.findIndex.call(A,T=>T.selected)===-1&&(A[0].selected=!0),t.setValue(e,{value:c(!0),items:f(y)}),h=c(!1)},clear(y){for(;r.length!==0;)r.remove(0);t.setValue(e,{value:null,items:[]}),h=c(!1)},insert(y){const{index:A,displayValue:b,exportValue:S}=y.detail.insert,T=r.children[A],C=document.createElement("option");C.textContent=b,C.value=S,T?T.before(C):r.append(C),t.setValue(e,{value:c(!0),items:f(y)}),h=c(!1)},items(y){const{items:A}=y.detail;for(;r.length!==0;)r.remove(0);for(const b of A){const{displayValue:S,exportValue:T}=b,C=document.createElement("option");C.textContent=S,C.value=T,r.append(C)}r.options.length>0&&(r.options[0].selected=!0),t.setValue(e,{value:c(!0),items:f(y)}),h=c(!1)},indices(y){const A=new Set(y.detail.indices);for(const b of y.target.options)b.selected=A.has(b.index);t.setValue(e,{value:c(!0)}),h=c(!1)},editable(y){y.target.disabled=!y.detail.editable}};this._dispatchEventFromSandbox(v,g)}),r.addEventListener("input",g=>{const v=c(!0),y=c(!1);t.setValue(e,{value:v}),g.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:h,change:y,changeEx:v,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(r,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],g=>g.target.value)):r.addEventListener("input",function(g){t.setValue(e,{value:c(!0)})}),this.data.combo&&this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class Sc extends de{constructor(t){const{data:e,elements:s}=t;super(t,{isRenderable:de._hasPopupData(e)}),this.elements=s,this.popup=null}render(){this.container.classList.add("popupAnnotation");const t=this.popup=new Wm({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),e=[];for(const s of this.elements)s.popup=t,s.container.ariaHasPopup="dialog",e.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",e.map(s=>`${Tc}${s}`).join(",")),this.container}}class Wm{#t=this.#k.bind(this);#e=this.#C.bind(this);#n=this.#T.bind(this);#i=this.#_.bind(this);#r=null;#s=null;#l=null;#o=null;#u=null;#c=null;#d=null;#h=!1;#f=null;#a=null;#p=null;#m=null;#g=null;#v=null;#A=!1;constructor({container:t,color:e,elements:s,titleObj:r,modificationDate:o,contentsObj:l,richText:c,parent:h,rect:f,parentRect:g,open:v}){this.#s=t,this.#g=r,this.#l=l,this.#m=c,this.#c=h,this.#r=e,this.#p=f,this.#d=g,this.#u=s,this.#o=Wd.toDateObject(o),this.trigger=s.flatMap(y=>y.getElementsToTriggerPopup());for(const y of this.trigger)y.addEventListener("click",this.#i),y.addEventListener("mouseenter",this.#n),y.addEventListener("mouseleave",this.#e),y.classList.add("popupTriggerArea");for(const y of s)y.container?.addEventListener("keydown",this.#t);this.#s.hidden=!0,v&&this.#_()}render(){if(this.#f)return;const t=this.#f=document.createElement("div");if(t.className="popup",this.#r){const o=t.style.outlineColor=ht.makeHexColor(...this.#r);CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?t.style.backgroundColor=`color-mix(in srgb, ${o} 30%, white)`:t.style.backgroundColor=ht.makeHexColor(...this.#r.map(c=>Math.floor(.7*(255-c)+c)))}const e=document.createElement("span");e.className="header";const s=document.createElement("h1");if(e.append(s),{dir:s.dir,str:s.textContent}=this.#g,t.append(e),this.#o){const o=document.createElement("span");o.classList.add("popupDate"),o.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),o.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#o.valueOf()})),e.append(o)}const r=this.#y;if(r)hf.render({xfaHtml:r,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const o=this._formatContents(this.#l);t.append(o)}this.#s.append(t)}get#y(){const t=this.#m,e=this.#l;return t?.str&&(!e?.str||e.str===t.str)&&this.#m.html||null}get#b(){return this.#y?.attributes?.style?.fontSize||0}get#S(){return this.#y?.attributes?.style?.color||null}#E(t){const e=[],s={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},r={style:{color:this.#S,fontSize:this.#b?`calc(${this.#b}px * var(--scale-factor))`:""}};for(const o of t.split(`
`))e.push({name:"span",value:o,attributes:r});return s}_formatContents({str:t,dir:e}){const s=document.createElement("p");s.classList.add("popupContent"),s.dir=e;const r=t.split(/(?:\r\n?|\n)/);for(let o=0,l=r.length;o<l;++o){const c=r[o];s.append(document.createTextNode(c)),o<l-1&&s.append(document.createElement("br"))}return s}#k(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#h)&&this.#_()}updateEdited({rect:t,popupContent:e}){this.#v||={contentsObj:this.#l,richText:this.#m},t&&(this.#a=null),e&&(this.#m=this.#E(e),this.#l=null),this.#f?.remove(),this.#f=null}resetEdited(){this.#v&&({contentsObj:this.#l,richText:this.#m}=this.#v,this.#v=null,this.#f?.remove(),this.#f=null,this.#a=null)}#P(){if(this.#a!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:s,pageX:r,pageY:o}}}=this.#c;let l=!!this.#d,c=l?this.#d:this.#p;for(const b of this.#u)if(!c||ht.intersect(b.data.rect,c)!==null){c=b.data.rect,l=!0;break}const h=ht.normalizeRect([c[0],t[3]-c[1]+t[1],c[2],t[3]-c[3]+t[1]]),g=l?c[2]-c[0]+5:0,v=h[0]+g,y=h[1];this.#a=[100*(v-r)/e,100*(y-o)/s];const{style:A}=this.#s;A.left=`${this.#a[0]}%`,A.top=`${this.#a[1]}%`}#_(){this.#h=!this.#h,this.#h?(this.#T(),this.#s.addEventListener("click",this.#i),this.#s.addEventListener("keydown",this.#t)):(this.#C(),this.#s.removeEventListener("click",this.#i),this.#s.removeEventListener("keydown",this.#t))}#T(){this.#f||this.render(),this.isVisible?this.#h&&this.#s.classList.add("focused"):(this.#P(),this.#s.hidden=!1,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)+1e3)}#C(){this.#s.classList.remove("focused"),!(this.#h||!this.isVisible)&&(this.#s.hidden=!0,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)-1e3)}forceHide(){this.#A=this.isVisible,this.#A&&(this.#s.hidden=!0)}maybeShow(){this.#A&&(this.#f||this.#T(),this.#A=!1,this.#s.hidden=!1)}get isVisible(){return this.#s.hidden===!1}}class pf extends de{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=Pt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const s=document.createElement("span");s.textContent=e,t.append(s)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class Xm extends de{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const t=this.data,{width:e,height:s}=Ai(t.rect),r=this.svgFactory.create(e,s,!0),o=this.#t=this.svgFactory.createElement("svg:line");return o.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),o.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),o.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),o.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),o.setAttribute("stroke-width",t.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class qm extends de{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const t=this.data,{width:e,height:s}=Ai(t.rect),r=this.svgFactory.create(e,s,!0),o=t.borderStyle.width,l=this.#t=this.svgFactory.createElement("svg:rect");return l.setAttribute("x",o/2),l.setAttribute("y",o/2),l.setAttribute("width",e-o),l.setAttribute("height",s-o),l.setAttribute("stroke-width",o||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),r.append(l),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Ym extends de{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const t=this.data,{width:e,height:s}=Ai(t.rect),r=this.svgFactory.create(e,s,!0),o=t.borderStyle.width,l=this.#t=this.svgFactory.createElement("svg:ellipse");return l.setAttribute("cx",e/2),l.setAttribute("cy",s/2),l.setAttribute("rx",e/2-o/2),l.setAttribute("ry",s/2-o/2),l.setAttribute("stroke-width",o||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),r.append(l),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class gf extends de{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:e,borderStyle:s,popupRef:r}}=this;if(!e)return this.container;const{width:o,height:l}=Ai(t),c=this.svgFactory.create(o,l,!0);let h=[];for(let g=0,v=e.length;g<v;g+=2){const y=e[g]-t[0],A=t[3]-e[g+1];h.push(`${y},${A}`)}h=h.join(" ");const f=this.#t=this.svgFactory.createElement(this.svgElementName);return f.setAttribute("points",h),f.setAttribute("stroke-width",s.width||1),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),c.append(f),this.container.append(c),!r&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Km extends gf{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Qm extends de{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class zc extends de{#t=null;#e=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Pt.HIGHLIGHT:Pt.INK}#n(t,e){switch(t){case 90:return{transform:`rotate(90) translate(${-e[0]},${e[1]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};case 180:return{transform:`rotate(180) translate(${-e[2]},${e[1]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]};case 270:return{transform:`rotate(270) translate(${-e[2]},${e[3]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};default:return{transform:`translate(${-e[0]},${e[3]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:e,inkLists:s,borderStyle:r,popupRef:o}}=this,{transform:l,width:c,height:h}=this.#n(e,t),f=this.svgFactory.create(c,h,!0),g=this.#t=this.svgFactory.createElement("svg:g");f.append(g),g.setAttribute("stroke-width",r.width||1),g.setAttribute("stroke-linecap","round"),g.setAttribute("stroke-linejoin","round"),g.setAttribute("stroke-miterlimit",10),g.setAttribute("stroke","transparent"),g.setAttribute("fill","transparent"),g.setAttribute("transform",l);for(let v=0,y=s.length;v<y;v++){const A=this.svgFactory.createElement(this.svgElementName);this.#e.push(A),A.setAttribute("points",s[v].join(",")),g.append(A)}return!o&&this.hasPopupData&&this._createPopup(),this.container.append(f),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:e,points:s,rect:r}=t,o=this.#t;if(e>=0&&o.setAttribute("stroke-width",e||1),s)for(let l=0,c=this.#e.length;l<c;l++)this.#e[l].setAttribute("points",s[l].join(","));if(r){const{transform:l,width:c,height:h}=this.#n(this.data.rotation,r);o.parentElement.setAttribute("viewBox",`0 0 ${c} ${h}`),o.setAttribute("transform",l)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class mf extends de{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Pt.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class Zm extends de{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class Jm extends de{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class tv extends de{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class vf extends de{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Pt.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class ev extends de{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:e}=this.data;this.filename=e.filename,this.content=e.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...e})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:e}=this;let s;e.hasAppearance||e.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(e.name)?"paperclip":"pushpin"}.svg`,e.fillAlpha&&e.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(e.fillAlpha*100)}%);`)),s.addEventListener("dblclick",this.#e.bind(this)),this.#t=s;const{isMac:r}=Be.platform;return t.addEventListener("keydown",o=>{o.key==="Enter"&&(r?o.metaKey:o.ctrlKey)&&this.#e()}),!e.popupRef&&this.hasPopupData?this._createPopup():s.classList.add("popupTriggerArea"),t.append(s),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class nv{#t=null;#e=null;#n=new Map;#i=null;constructor({div:t,accessibilityManager:e,annotationCanvasMap:s,annotationEditorUIManager:r,page:o,viewport:l,structTreeLayer:c}){this.div=t,this.#t=e,this.#e=s,this.#i=c||null,this.page=o,this.viewport=l,this.zIndex=0,this._annotationEditorUIManager=r}hasEditableAnnotations(){return this.#n.size>0}async#r(t,e){const s=t.firstChild||t,r=s.id=`${Tc}${e}`,o=await this.#i?.getAriaAttributes(r);if(o)for(const[l,c]of o)s.setAttribute(l,c);this.div.append(t),this.#t?.moveElementInDOM(this.div,t,s,!1)}async render(t){const{annotations:e}=t,s=this.div;Qi(s,this.viewport);const r=new Map,o={data:null,layer:s,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new jc,annotationStorage:t.annotationStorage||new Ic,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const l of e){if(l.noHTML)continue;const c=l.annotationType===we.POPUP;if(c){const g=r.get(l.id);if(!g)continue;o.elements=g}else{const{width:g,height:v}=Ai(l.rect);if(g<=0||v<=0)continue}o.data=l;const h=zm.create(o);if(!h.isRenderable)continue;if(!c&&l.popupRef){const g=r.get(l.popupRef);g?g.push(h):r.set(l.popupRef,[h])}const f=h.render();l.hidden&&(f.style.visibility="hidden"),await this.#r(f,l.id),h._isEditable&&(this.#n.set(h.data.id,h),this._annotationEditorUIManager?.renderAnnotationElement(h))}this.#s()}update({viewport:t}){const e=this.div;this.viewport=t,Qi(e,{rotation:t.rotation}),this.#s(),e.hidden=!1}#s(){if(!this.#e)return;const t=this.div;for(const[e,s]of this.#e){const r=t.querySelector(`[data-annotation-id="${e}"]`);if(!r)continue;s.className="annotationContent";const{firstChild:o}=r;o?o.nodeName==="CANVAS"?o.replaceWith(s):o.classList.contains("annotationContent")?o.after(s):o.before(s):r.append(s)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(t){return this.#n.get(t)}}const io=/\r\n?|\n/g;class Ae extends At{#t;#e="";#n=`${this.id}-editor`;#i=null;#r;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=Ae.prototype,e=o=>o.isEmpty(),s=_i.TRANSLATE_SMALL,r=_i.TRANSLATE_BIG;return Ot(this,"_keyboardManager",new jr([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[s,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:e}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,s],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:e}]]))}static _type="freetext";static _editorType=Pt.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.#t=t.color||Ae._defaultColor||At._defaultLineColor,this.#r=t.fontSize||Ae._defaultFontSize}static initialize(t,e){At.initialize(t,e);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,e){switch(t){case zt.FREETEXT_SIZE:Ae._defaultFontSize=e;break;case zt.FREETEXT_COLOR:Ae._defaultColor=e;break}}updateParams(t,e){switch(t){case zt.FREETEXT_SIZE:this.#s(e);break;case zt.FREETEXT_COLOR:this.#l(e);break}}static get defaultPropertiesToUpdate(){return[[zt.FREETEXT_SIZE,Ae._defaultFontSize],[zt.FREETEXT_COLOR,Ae._defaultColor||At._defaultLineColor]]}get propertiesToUpdate(){return[[zt.FREETEXT_SIZE,this.#r],[zt.FREETEXT_COLOR,this.#t]]}#s(t){const e=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--scale-factor))`,this.translate(0,-(r-this.#r)*this.parentScale),this.#r=r,this.#u()},s=this.#r;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:zt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#l(t){const e=r=>{this.#t=this.editorDiv.style.color=r},s=this.#t;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:zt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,e){this._uiManager.translateSelectedEditors(t,e,!0)}getInitialTranslation(){const t=this.parentScale;return[-Ae._internalPadding*t,-(Ae._internalPadding+this.#r)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(Pt.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#i=new AbortController;const t=this._uiManager.combinedSignal(this.#i);this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t})}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#n),this._isDraggable=!0,this.#i?.abort(),this.#i=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#o(){const t=[];this.editorDiv.normalize();let e=null;for(const s of this.editorDiv.childNodes)e?.nodeType===Node.TEXT_NODE&&s.nodeName==="BR"||(t.push(Ae.#c(s)),e=s);return t.join(`
`)}#u(){const[t,e]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:r,div:o}=this,l=o.style.display,c=o.classList.contains("hidden");o.classList.remove("hidden"),o.style.display="hidden",r.div.append(this.div),s=o.getBoundingClientRect(),o.remove(),o.style.display=l,o.classList.toggle("hidden",c)}this.rotation%180===this.parentRotation%180?(this.width=s.width/t,this.height=s.height/e):(this.width=s.height/t,this.height=s.width/e),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#e,e=this.#e=this.#o().trimEnd();if(t===e)return;const s=r=>{if(this.#e=r,!r){this.remove();return}this.#d(),this._uiManager.rebuild(this),this.#u()};this.addCommands({cmd:()=>{s(e)},undo:()=>{s(t)},mustExec:!1}),this.#u()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(t){this.enterInEditMode()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Ae._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let t,e;this.width&&(t=this.x,e=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#n),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${this.#r}px * var(--scale-factor))`,s.color=this.#t,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),lo(this,this.div,["dblclick","keydown"]),this.width){const[r,o]=this.parentDimensions;if(this.annotationElementId){const{position:l}=this._initialData;let[c,h]=this.getInitialTranslation();[c,h]=this.pageTranslationToScreen(c,h);const[f,g]=this.pageDimensions,[v,y]=this.pageTranslation;let A,b;switch(this.rotation){case 0:A=t+(l[0]-v)/f,b=e+this.height-(l[1]-y)/g;break;case 90:A=t+(l[0]-v)/f,b=e-(l[1]-y)/g,[c,h]=[h,-c];break;case 180:A=t-this.width+(l[0]-v)/f,b=e-(l[1]-y)/g,[c,h]=[-c,-h];break;case 270:A=t+(l[0]-v-this.height*g)/f,b=e+(l[1]-y-this.width*f)/g,[c,h]=[-h,c];break}this.setAt(A*r,b*o,c,h)}else this.setAt(t*r,e*o,this.width*r,this.height*o);this.#d(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(io,"")}editorDivPaste(t){const e=t.clipboardData||window.clipboardData,{types:s}=e;if(s.length===1&&s[0]==="text/plain")return;t.preventDefault();const r=Ae.#f(e.getData("text")||"").replaceAll(io,`
`);if(!r)return;const o=window.getSelection();if(!o.rangeCount)return;this.editorDiv.normalize(),o.deleteFromDocument();const l=o.getRangeAt(0);if(!r.includes(`
`)){l.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),o.collapseToStart();return}const{startContainer:c,startOffset:h}=l,f=[],g=[];if(c.nodeType===Node.TEXT_NODE){const A=c.parentElement;if(g.push(c.nodeValue.slice(h).replaceAll(io,"")),A!==this.editorDiv){let b=f;for(const S of this.editorDiv.childNodes){if(S===A){b=g;continue}b.push(Ae.#c(S))}}f.push(c.nodeValue.slice(0,h).replaceAll(io,""))}else if(c===this.editorDiv){let A=f,b=0;for(const S of this.editorDiv.childNodes)b++===h&&(A=g),A.push(Ae.#c(S))}this.#e=`${f.join(`
`)}${r}${g.join(`
`)}`,this.#d();const v=new Range;let y=f.reduce((A,b)=>A+b.length,0);for(const{firstChild:A}of this.editorDiv.childNodes)if(A.nodeType===Node.TEXT_NODE){const b=A.nodeValue.length;if(y<=b){v.setStart(A,y),v.setEnd(A,y);break}y-=b}o.removeAllRanges(),o.addRange(v)}#d(){if(this.editorDiv.replaceChildren(),!!this.#e)for(const t of this.#e.split(`
`)){const e=document.createElement("div");e.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(e)}}#h(){return this.#e.replaceAll(""," ")}static#f(t){return t.replaceAll(" ","")}get contentDiv(){return this.editorDiv}static async deserialize(t,e,s){let r=null;if(t instanceof pf){const{data:{defaultAppearanceData:{fontSize:l,fontColor:c},rect:h,rotation:f,id:g,popupRef:v},textContent:y,textPosition:A,parent:{page:{pageNumber:b}}}=t;if(!y||y.length===0)return null;r=t={annotationType:Pt.FREETEXT,color:Array.from(c),fontSize:l,value:y.join(`
`),position:A,pageIndex:b-1,rect:h.slice(0),rotation:f,id:g,deleted:!1,popupRef:v}}const o=await super.deserialize(t,e,s);return o.#r=t.fontSize,o.#t=ht.makeHexColor(...t.color),o.#e=Ae.#f(t.value),o.annotationElementId=t.id||null,o._initialData=r,o}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const e=Ae._internalPadding*this.parentScale,s=this.getRect(e,e),r=At._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#t),o={annotationType:Pt.FREETEXT,color:r,fontSize:this.#r,value:this.#h(),pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?o:this.annotationElementId&&!this.#a(o)?null:(o.id=this.annotationElementId,o)}#a(t){const{value:e,fontSize:s,color:r,pageIndex:o}=this._initialData;return this._hasBeenMoved||t.value!==e||t.fontSize!==s||t.color.some((l,c)=>l!==r[c])||t.pageIndex!==o}renderAnnotationElement(t){const e=super.renderAnnotationElement(t);if(this.deleted)return e;const{style:s}=e;s.fontSize=`calc(${this.#r}px * var(--scale-factor))`,s.color=this.#t,e.replaceChildren();for(const o of this.#e.split(`
`)){const l=document.createElement("div");l.append(o?document.createTextNode(o):document.createElement("br")),e.append(l)}const r=Ae._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(r,r),popupContent:this.#e}),e}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class at{static PRECISION=1e-4;toSVGPath(){Wt("Abstract method `toSVGPath` must be implemented.")}get box(){Wt("Abstract getter `box` must be implemented.")}serialize(t,e){Wt("Abstract method `serialize` must be implemented.")}static _rescale(t,e,s,r,o,l){l||=new Float32Array(t.length);for(let c=0,h=t.length;c<h;c+=2)l[c]=e+t[c]*r,l[c+1]=s+t[c+1]*o;return l}static _rescaleAndSwap(t,e,s,r,o,l){l||=new Float32Array(t.length);for(let c=0,h=t.length;c<h;c+=2)l[c]=e+t[c+1]*r,l[c+1]=s+t[c]*o;return l}static _translate(t,e,s,r){r||=new Float32Array(t.length);for(let o=0,l=t.length;o<l;o+=2)r[o]=e+t[o],r[o+1]=s+t[o+1];return r}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,s,r,o){switch(o){case 90:return[1-e/s,t/r];case 180:return[1-t/s,1-e/r];case 270:return[e/s,1-t/r];default:return[t/s,e/r]}}static _normalizePagePoint(t,e,s){switch(s){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,s,r,o,l){return[(t+5*s)/6,(e+5*r)/6,(5*s+o)/6,(5*r+l)/6,(s+o)/2,(r+l)/2]}}class qi{#t;#e=[];#n;#i;#r=[];#s=new Float32Array(18);#l;#o;#u;#c;#d;#h;#f=[];static#a=8;static#p=2;static#m=qi.#a+qi.#p;constructor({x:t,y:e},s,r,o,l,c=0){this.#t=s,this.#h=o*r,this.#i=l,this.#s.set([NaN,NaN,NaN,NaN,t,e],6),this.#n=c,this.#c=qi.#a*r,this.#u=qi.#m*r,this.#d=r,this.#f.push(t,e)}isEmpty(){return isNaN(this.#s[8])}#g(){const t=this.#s.subarray(4,6),e=this.#s.subarray(16,18),[s,r,o,l]=this.#t;return[(this.#l+(t[0]-e[0])/2-s)/o,(this.#o+(t[1]-e[1])/2-r)/l,(this.#l+(e[0]-t[0])/2-s)/o,(this.#o+(e[1]-t[1])/2-r)/l]}add({x:t,y:e}){this.#l=t,this.#o=e;const[s,r,o,l]=this.#t;let[c,h,f,g]=this.#s.subarray(8,12);const v=t-f,y=e-g,A=Math.hypot(v,y);if(A<this.#u)return!1;const b=A-this.#c,S=b/A,T=S*v,C=S*y;let I=c,O=h;c=f,h=g,f+=T,g+=C,this.#f?.push(t,e);const j=-C/b,H=T/b,W=j*this.#h,V=H*this.#h;return this.#s.set(this.#s.subarray(2,8),0),this.#s.set([f+W,g+V],4),this.#s.set(this.#s.subarray(14,18),12),this.#s.set([f-W,g-V],16),isNaN(this.#s[6])?(this.#r.length===0&&(this.#s.set([c+W,h+V],2),this.#r.push(NaN,NaN,NaN,NaN,(c+W-s)/o,(h+V-r)/l),this.#s.set([c-W,h-V],14),this.#e.push(NaN,NaN,NaN,NaN,(c-W-s)/o,(h-V-r)/l)),this.#s.set([I,O,c,h,f,g],6),!this.isEmpty()):(this.#s.set([I,O,c,h,f,g],6),Math.abs(Math.atan2(O-h,I-c)-Math.atan2(C,T))<Math.PI/2?([c,h,f,g]=this.#s.subarray(2,6),this.#r.push(NaN,NaN,NaN,NaN,((c+f)/2-s)/o,((h+g)/2-r)/l),[c,h,I,O]=this.#s.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((I+c)/2-s)/o,((O+h)/2-r)/l),!0):([I,O,c,h,f,g]=this.#s.subarray(0,6),this.#r.push(((I+5*c)/6-s)/o,((O+5*h)/6-r)/l,((5*c+f)/6-s)/o,((5*h+g)/6-r)/l,((c+f)/2-s)/o,((h+g)/2-r)/l),[f,g,c,h,I,O]=this.#s.subarray(12,18),this.#e.push(((I+5*c)/6-s)/o,((O+5*h)/6-r)/l,((5*c+f)/6-s)/o,((5*h+g)/6-r)/l,((c+f)/2-s)/o,((h+g)/2-r)/l),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#r,e=this.#e;if(isNaN(this.#s[6])&&!this.isEmpty())return this.#v();const s=[];s.push(`M${t[4]} ${t[5]}`);for(let r=6;r<t.length;r+=6)isNaN(t[r])?s.push(`L${t[r+4]} ${t[r+5]}`):s.push(`C${t[r]} ${t[r+1]} ${t[r+2]} ${t[r+3]} ${t[r+4]} ${t[r+5]}`);this.#y(s);for(let r=e.length-6;r>=6;r-=6)isNaN(e[r])?s.push(`L${e[r+4]} ${e[r+5]}`):s.push(`C${e[r]} ${e[r+1]} ${e[r+2]} ${e[r+3]} ${e[r+4]} ${e[r+5]}`);return this.#A(s),s.join(" ")}#v(){const[t,e,s,r]=this.#t,[o,l,c,h]=this.#g();return`M${(this.#s[2]-t)/s} ${(this.#s[3]-e)/r} L${(this.#s[4]-t)/s} ${(this.#s[5]-e)/r} L${o} ${l} L${c} ${h} L${(this.#s[16]-t)/s} ${(this.#s[17]-e)/r} L${(this.#s[14]-t)/s} ${(this.#s[15]-e)/r} Z`}#A(t){const e=this.#e;t.push(`L${e[4]} ${e[5]} Z`)}#y(t){const[e,s,r,o]=this.#t,l=this.#s.subarray(4,6),c=this.#s.subarray(16,18),[h,f,g,v]=this.#g();t.push(`L${(l[0]-e)/r} ${(l[1]-s)/o} L${h} ${f} L${g} ${v} L${(c[0]-e)/r} ${(c[1]-s)/o}`)}newFreeDrawOutline(t,e,s,r,o,l){return new yf(t,e,s,r,o,l)}getOutlines(){const t=this.#r,e=this.#e,s=this.#s,[r,o,l,c]=this.#t,h=new Float32Array((this.#f?.length??0)+2);for(let v=0,y=h.length-2;v<y;v+=2)h[v]=(this.#f[v]-r)/l,h[v+1]=(this.#f[v+1]-o)/c;if(h[h.length-2]=(this.#l-r)/l,h[h.length-1]=(this.#o-o)/c,isNaN(s[6])&&!this.isEmpty())return this.#b(h);const f=new Float32Array(this.#r.length+24+this.#e.length);let g=t.length;for(let v=0;v<g;v+=2){if(isNaN(t[v])){f[v]=f[v+1]=NaN;continue}f[v]=t[v],f[v+1]=t[v+1]}g=this.#E(f,g);for(let v=e.length-6;v>=6;v-=6)for(let y=0;y<6;y+=2){if(isNaN(e[v+y])){f[g]=f[g+1]=NaN,g+=2;continue}f[g]=e[v+y],f[g+1]=e[v+y+1],g+=2}return this.#S(f,g),this.newFreeDrawOutline(f,h,this.#t,this.#d,this.#n,this.#i)}#b(t){const e=this.#s,[s,r,o,l]=this.#t,[c,h,f,g]=this.#g(),v=new Float32Array(36);return v.set([NaN,NaN,NaN,NaN,(e[2]-s)/o,(e[3]-r)/l,NaN,NaN,NaN,NaN,(e[4]-s)/o,(e[5]-r)/l,NaN,NaN,NaN,NaN,c,h,NaN,NaN,NaN,NaN,f,g,NaN,NaN,NaN,NaN,(e[16]-s)/o,(e[17]-r)/l,NaN,NaN,NaN,NaN,(e[14]-s)/o,(e[15]-r)/l],0),this.newFreeDrawOutline(v,t,this.#t,this.#d,this.#n,this.#i)}#S(t,e){const s=this.#e;return t.set([NaN,NaN,NaN,NaN,s[4],s[5]],e),e+=6}#E(t,e){const s=this.#s.subarray(4,6),r=this.#s.subarray(16,18),[o,l,c,h]=this.#t,[f,g,v,y]=this.#g();return t.set([NaN,NaN,NaN,NaN,(s[0]-o)/c,(s[1]-l)/h,NaN,NaN,NaN,NaN,f,g,NaN,NaN,NaN,NaN,v,y,NaN,NaN,NaN,NaN,(r[0]-o)/c,(r[1]-l)/h],e),e+=24}}class yf extends at{#t;#e=new Float32Array(4);#n;#i;#r;#s;#l;constructor(t,e,s,r,o,l){super(),this.#l=t,this.#r=e,this.#t=s,this.#s=r,this.#n=o,this.#i=l,this.lastPoint=[NaN,NaN],this.#o(l);const[c,h,f,g]=this.#e;for(let v=0,y=t.length;v<y;v+=2)t[v]=(t[v]-c)/f,t[v+1]=(t[v+1]-h)/g;for(let v=0,y=e.length;v<y;v+=2)e[v]=(e[v]-c)/f,e[v+1]=(e[v+1]-h)/g}toSVGPath(){const t=[`M${this.#l[4]} ${this.#l[5]}`];for(let e=6,s=this.#l.length;e<s;e+=6){if(isNaN(this.#l[e])){t.push(`L${this.#l[e+4]} ${this.#l[e+5]}`);continue}t.push(`C${this.#l[e]} ${this.#l[e+1]} ${this.#l[e+2]} ${this.#l[e+3]} ${this.#l[e+4]} ${this.#l[e+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,e,s,r],o){const l=s-t,c=r-e;let h,f;switch(o){case 0:h=at._rescale(this.#l,t,r,l,-c),f=at._rescale(this.#r,t,r,l,-c);break;case 90:h=at._rescaleAndSwap(this.#l,t,e,l,c),f=at._rescaleAndSwap(this.#r,t,e,l,c);break;case 180:h=at._rescale(this.#l,s,e,-l,c),f=at._rescale(this.#r,s,e,-l,c);break;case 270:h=at._rescaleAndSwap(this.#l,s,r,-l,-c),f=at._rescaleAndSwap(this.#r,s,r,-l,-c);break}return{outline:Array.from(h),points:[Array.from(f)]}}#o(t){const e=this.#l;let s=e[4],r=e[5],o=s,l=r,c=s,h=r,f=s,g=r;const v=t?Math.max:Math.min;for(let A=6,b=e.length;A<b;A+=6){if(isNaN(e[A]))o=Math.min(o,e[A+4]),l=Math.min(l,e[A+5]),c=Math.max(c,e[A+4]),h=Math.max(h,e[A+5]),g<e[A+5]?(f=e[A+4],g=e[A+5]):g===e[A+5]&&(f=v(f,e[A+4]));else{const S=ht.bezierBoundingBox(s,r,...e.slice(A,A+6));o=Math.min(o,S[0]),l=Math.min(l,S[1]),c=Math.max(c,S[2]),h=Math.max(h,S[3]),g<S[3]?(f=S[2],g=S[3]):g===S[3]&&(f=v(f,S[2]))}s=e[A+4],r=e[A+5]}const y=this.#e;y[0]=o-this.#n,y[1]=l-this.#n,y[2]=c-o+2*this.#n,y[3]=h-l+2*this.#n,this.lastPoint=[f,g]}get box(){return this.#e}newOutliner(t,e,s,r,o,l=0){return new qi(t,e,s,r,o,l)}getNewOutline(t,e){const[s,r,o,l]=this.#e,[c,h,f,g]=this.#t,v=o*f,y=l*g,A=s*f+c,b=r*g+h,S=this.newOutliner({x:this.#r[0]*v+A,y:this.#r[1]*y+b},this.#t,this.#s,t,this.#i,e??this.#n);for(let T=2;T<this.#r.length;T+=2)S.add({x:this.#r[T]*v+A,y:this.#r[T+1]*y+b});return S.getOutlines()}}class xc{#t;#e;#n=[];#i=[];constructor(t,e=0,s=0,r=!0){let o=1/0,l=-1/0,c=1/0,h=-1/0;const f=10**-4;for(const{x:T,y:C,width:I,height:O}of t){const j=Math.floor((T-e)/f)*f,H=Math.ceil((T+I+e)/f)*f,W=Math.floor((C-e)/f)*f,V=Math.ceil((C+O+e)/f)*f,it=[j,W,V,!0],X=[H,W,V,!1];this.#n.push(it,X),o=Math.min(o,j),l=Math.max(l,H),c=Math.min(c,W),h=Math.max(h,V)}const g=l-o+2*s,v=h-c+2*s,y=o-s,A=c-s,b=this.#n.at(r?-1:-2),S=[b[0],b[2]];for(const T of this.#n){const[C,I,O]=T;T[0]=(C-y)/g,T[1]=(I-A)/v,T[2]=(O-A)/v}this.#t=new Float32Array([y,A,g,v]),this.#e=S}getOutlines(){this.#n.sort((e,s)=>e[0]-s[0]||e[1]-s[1]||e[2]-s[2]);const t=[];for(const e of this.#n)e[3]?(t.push(...this.#u(e)),this.#l(e)):(this.#o(e),t.push(...this.#u(e)));return this.#r(t)}#r(t){const e=[],s=new Set;for(const l of t){const[c,h,f]=l;e.push([c,h,l],[c,f,l])}e.sort((l,c)=>l[1]-c[1]||l[0]-c[0]);for(let l=0,c=e.length;l<c;l+=2){const h=e[l][2],f=e[l+1][2];h.push(f),f.push(h),s.add(h),s.add(f)}const r=[];let o;for(;s.size>0;){const l=s.values().next().value;let[c,h,f,g,v]=l;s.delete(l);let y=c,A=h;for(o=[c,f],r.push(o);;){let b;if(s.has(g))b=g;else if(s.has(v))b=v;else break;s.delete(b),[c,h,f,g,v]=b,y!==c&&(o.push(y,A,c,A===h?h:f),y=c),A=A===h?f:h}o.push(y,A)}return new iv(r,this.#t,this.#e)}#s(t){const e=this.#i;let s=0,r=e.length-1;for(;s<=r;){const o=s+r>>1,l=e[o][0];if(l===t)return o;l<t?s=o+1:r=o-1}return r+1}#l([,t,e]){const s=this.#s(t);this.#i.splice(s,0,[t,e])}#o([,t,e]){const s=this.#s(t);for(let r=s;r<this.#i.length;r++){const[o,l]=this.#i[r];if(o!==t)break;if(o===t&&l===e){this.#i.splice(r,1);return}}for(let r=s-1;r>=0;r--){const[o,l]=this.#i[r];if(o!==t)break;if(o===t&&l===e){this.#i.splice(r,1);return}}}#u(t){const[e,s,r]=t,o=[[e,s,r]],l=this.#s(r);for(let c=0;c<l;c++){const[h,f]=this.#i[c];for(let g=0,v=o.length;g<v;g++){const[,y,A]=o[g];if(!(f<=y||A<=h)){if(y>=h){if(A>f)o[g][1]=f;else{if(v===1)return[];o.splice(g,1),g--,v--}continue}o[g][2]=h,A>f&&o.push([e,f,A])}}}return o}}class iv extends at{#t;#e;constructor(t,e,s){super(),this.#e=t,this.#t=e,this.lastPoint=s}toSVGPath(){const t=[];for(const e of this.#e){let[s,r]=e;t.push(`M${s} ${r}`);for(let o=2;o<e.length;o+=2){const l=e[o],c=e[o+1];l===s?(t.push(`V${c}`),r=c):c===r&&(t.push(`H${l}`),s=l)}t.push("Z")}return t.join(" ")}serialize([t,e,s,r],o){const l=[],c=s-t,h=r-e;for(const f of this.#e){const g=new Array(f.length);for(let v=0;v<f.length;v+=2)g[v]=t+f[v]*c,g[v+1]=r-f[v+1]*h;l.push(g)}return l}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}}class Ec extends qi{newFreeDrawOutline(t,e,s,r,o,l){return new sv(t,e,s,r,o,l)}}class sv extends yf{newOutliner(t,e,s,r,o,l=0){return new Ec(t,e,s,r,o,l)}}class mn{#t=null;#e=null;#n;#i=null;#r=!1;#s=!1;#l=null;#o;#u=null;#c=null;#d;static#h=null;static get _keyboardManager(){return Ot(this,"_keyboardManager",new jr([[["Escape","mac+Escape"],mn.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],mn.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],mn.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],mn.prototype._moveToPrevious],[["Home","mac+Home"],mn.prototype._moveToBeginning],[["End","mac+End"],mn.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:e=null}){t?(this.#s=!1,this.#d=zt.HIGHLIGHT_COLOR,this.#l=t):(this.#s=!0,this.#d=zt.HIGHLIGHT_DEFAULT_COLOR),this.#c=t?._uiManager||e,this.#o=this.#c._eventBus,this.#n=t?.color||this.#c?.highlightColors.values().next().value||"#FFFF98",mn.#h||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#t=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.setAttribute("aria-haspopup",!0);const e=this.#c._signal;t.addEventListener("click",this.#m.bind(this),{signal:e}),t.addEventListener("keydown",this.#p.bind(this),{signal:e});const s=this.#e=document.createElement("span");return s.className="swatch",s.setAttribute("aria-hidden",!0),s.style.backgroundColor=this.#n,t.append(s),t}renderMainDropdown(){const t=this.#i=this.#f();return t.setAttribute("aria-orientation","horizontal"),t.setAttribute("aria-labelledby","highlightColorPickerLabel"),t}#f(){const t=document.createElement("div"),e=this.#c._signal;t.addEventListener("contextmenu",En,{signal:e}),t.className="dropdown",t.role="listbox",t.setAttribute("aria-multiselectable",!1),t.setAttribute("aria-orientation","vertical"),t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[s,r]of this.#c.highlightColors){const o=document.createElement("button");o.tabIndex="0",o.role="option",o.setAttribute("data-color",r),o.title=s,o.setAttribute("data-l10n-id",mn.#h[s]);const l=document.createElement("span");o.append(l),l.className="swatch",l.style.backgroundColor=r,o.setAttribute("aria-selected",r===this.#n),o.addEventListener("click",this.#a.bind(this,r),{signal:e}),t.append(o)}return t.addEventListener("keydown",this.#p.bind(this),{signal:e}),t}#a(t,e){e.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:this.#d,value:t})}_colorSelectFromKeyboard(t){if(t.target===this.#t){this.#m(t);return}const e=t.target.getAttribute("data-color");e&&this.#a(e,t)}_moveToNext(t){if(!this.#v){this.#m(t);return}if(t.target===this.#t){this.#i.firstChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#i?.firstChild||t.target===this.#t){this.#v&&this._hideDropdownFromKeyboard();return}this.#v||this.#m(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#v){this.#m(t);return}this.#i.firstChild?.focus()}_moveToEnd(t){if(!this.#v){this.#m(t);return}this.#i.lastChild?.focus()}#p(t){mn._keyboardManager.exec(this,t)}#m(t){if(this.#v){this.hideDropdown();return}if(this.#r=t.detail===0,this.#u||(this.#u=new AbortController,window.addEventListener("pointerdown",this.#g.bind(this),{signal:this.#c.combinedSignal(this.#u)})),this.#i){this.#i.classList.remove("hidden");return}const e=this.#i=this.#f();this.#t.append(e)}#g(t){this.#i?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#i?.classList.add("hidden"),this.#u?.abort(),this.#u=null}get#v(){return this.#i&&!this.#i.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#s){if(!this.#v){this.#l?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#r})}}updateColor(t){if(this.#e&&(this.#e.style.backgroundColor=t),!this.#i)return;const e=this.#c.highlightColors.values();for(const s of this.#i.children)s.setAttribute("aria-selected",e.next().value===t)}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#i?.remove(),this.#i=null}}class he extends At{#t=null;#e=0;#n;#i=null;#r=null;#s=null;#l=null;#o=0;#u=null;#c=null;#d=null;#h=!1;#f=null;#a;#p=null;#m="";#g;#v="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=Pt.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=he.prototype;return Ot(this,"_keyboardManager",new jr([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||he._defaultColor,this.#g=t.thickness||he._defaultThickness,this.#a=t.opacity||he._defaultOpacity,this.#n=t.boxes||null,this.#v=t.methodOfCreation||"",this.#m=t.text||"",this._isDraggable=!1,t.highlightId>-1?(this.#h=!0,this.#y(t),this.#P()):this.#n&&(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#l=t.focusNode,this.#o=t.focusOffset,this.#A(),this.#P(),this.rotate(this.rotation))}get telemetryInitialData(){return{action:"added",type:this.#h?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:this.#g,methodOfCreation:this.#v}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#A(){const t=new xc(this.#n,.001);this.#c=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#c.box;const e=new xc(this.#n,.0025,.001,this._uiManager.direction==="ltr");this.#s=e.getOutlines();const{lastPoint:s}=this.#s;this.#f=[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height]}#y({highlightOutlines:t,highlightId:e,clipPathId:s}){this.#c=t;const r=1.5;if(this.#s=t.getNewOutline(this.#g/2+r,.0025),e>=0)this.#d=e,this.#i=s,this.parent.drawLayer.finalizeDraw(e,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#p=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#s.box,path:{d:this.#s.toSVGPath()}},!0);else if(this.parent){const g=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#d,{bbox:he.#_(this.#c.box,(g-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#p,{bbox:he.#_(this.#s.box,g),path:{d:this.#s.toSVGPath()}})}const[o,l,c,h]=t.box;switch(this.rotation){case 0:this.x=o,this.y=l,this.width=c,this.height=h;break;case 90:{const[g,v]=this.parentDimensions;this.x=l,this.y=1-o,this.width=c*v/g,this.height=h*g/v;break}case 180:this.x=1-o,this.y=1-l,this.width=c,this.height=h;break;case 270:{const[g,v]=this.parentDimensions;this.x=1-l,this.y=o,this.width=c*v/g,this.height=h*g/v;break}}const{lastPoint:f}=this.#s;this.#f=[(f[0]-o)/c,(f[1]-l)/h]}static initialize(t,e){At.initialize(t,e),he._defaultColor||=e.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,e){switch(t){case zt.HIGHLIGHT_DEFAULT_COLOR:he._defaultColor=e;break;case zt.HIGHLIGHT_THICKNESS:he._defaultThickness=e;break}}translateInPage(t,e){}get toolbarPosition(){return this.#f}updateParams(t,e){switch(t){case zt.HIGHLIGHT_COLOR:this.#b(e);break;case zt.HIGHLIGHT_THICKNESS:this.#S(e);break}}static get defaultPropertiesToUpdate(){return[[zt.HIGHLIGHT_DEFAULT_COLOR,he._defaultColor],[zt.HIGHLIGHT_THICKNESS,he._defaultThickness]]}get propertiesToUpdate(){return[[zt.HIGHLIGHT_COLOR,this.color||he._defaultColor],[zt.HIGHLIGHT_THICKNESS,this.#g||he._defaultThickness],[zt.HIGHLIGHT_FREE,this.#h]]}#b(t){const e=(o,l)=>{this.color=o,this.#a=l,this.parent?.drawLayer.updateProperties(this.#d,{root:{fill:o,"fill-opacity":l}}),this.#r?.updateColor(o)},s=this.color,r=this.#a;this.addCommands({cmd:e.bind(this,t,he._defaultOpacity),undo:e.bind(this,s,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:zt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)}#S(t){const e=this.#g,s=r=>{this.#g=r,this.#E(r)};this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:zt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(this.#r=new mn({editor:this}),t.addColorPicker(this.#r)),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#M())}getBaseTranslation(){return[0,0]}getRect(t,e){return super.getRect(t,e,this.#M())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#k(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#P(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?this.#k():t&&(this.#P(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),e&&this.select()}#E(t){if(!this.#h)return;this.#y({highlightOutlines:this.#c.getNewOutline(t/2)}),this.fixAndSetPosition();const[e,s]=this.parentDimensions;this.setDims(this.width*e,this.height*s)}#k(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#p),this.#p=null)}#P(t=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#i}=t.drawLayer.draw({bbox:this.#c.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.#a},rootClass:{highlight:!0,free:this.#h},path:{d:this.#c.toSVGPath()}},!1,!0),this.#p=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#h},bbox:this.#s.box,path:{d:this.#s.toSVGPath()}},this.#h),this.#u&&(this.#u.style.clipPath=this.#i))}static#_([t,e,s,r],o){switch(o){case 90:return[1-e-r,t,r,s];case 180:return[1-t-s,1-e-r,s,r];case 270:return[e,1-t-s,r,s]}return[t,e,s,r]}rotate(t){const{drawLayer:e}=this.parent;let s;this.#h?(t=(t-this.rotation+360)%360,s=he.#_(this.#c.box,t)):s=he.#_([this.x,this.y,this.width,this.height],t),e.updateProperties(this.#d,{bbox:s,root:{"data-main-rotation":t}}),e.updateProperties(this.#p,{bbox:he.#_(this.#s.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#m&&(t.setAttribute("aria-label",this.#m),t.setAttribute("role","mark")),this.#h?t.classList.add("free"):this.div.addEventListener("keydown",this.#T.bind(this),{signal:this._uiManager._signal});const e=this.#u=document.createElement("div");t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal",e.style.clipPath=this.#i;const[s,r]=this.parentDimensions;return this.setDims(this.width*s,this.height*r),lo(this,this.#u,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1}})}#T(t){he._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#C(!0);break;case 1:case 3:this.#C(!1);break}}#C(t){if(!this.#t)return;const e=window.getSelection();t?e.setPosition(this.#t,this.#e):e.setPosition(this.#l,this.#o)}select(){super.select(),this.#p&&this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#p&&(this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{selected:!1}}),this.#h||this.#C(!1))}get _mustFixPosition(){return!this.#h}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#d,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#p,{rootClass:{hidden:!t}}))}#M(){return this.#h?this.rotation:0}#I(){if(this.#h)return null;const[t,e]=this.pageDimensions,[s,r]=this.pageTranslation,o=this.#n,l=new Float32Array(o.length*8);let c=0;for(const{x:h,y:f,width:g,height:v}of o){const y=h*t+s,A=(1-f)*e+r;l[c]=l[c+4]=y,l[c+1]=l[c+3]=A,l[c+2]=l[c+6]=y+g*t,l[c+5]=l[c+7]=A-v*e,c+=8}return l}#D(t){return this.#c.serialize(t,this.#M())}static startHighlighting(t,e,{target:s,x:r,y:o}){const{x:l,y:c,width:h,height:f}=s.getBoundingClientRect(),g=new AbortController,v=t.combinedSignal(g),y=A=>{g.abort(),this.#w(t,A)};window.addEventListener("blur",y,{signal:v}),window.addEventListener("pointerup",y,{signal:v}),window.addEventListener("pointerdown",an,{capture:!0,passive:!1,signal:v}),window.addEventListener("contextmenu",En,{signal:v}),s.addEventListener("pointermove",this.#x.bind(this,t),{signal:v}),this._freeHighlight=new Ec({x:r,y:o},[l,c,h,f],t.scale,this._defaultThickness/2,e,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#x(t,e){this._freeHighlight.add(e)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#w(t,e){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(e,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,e,s){let r=null;if(t instanceof mf){const{data:{quadPoints:b,rect:S,rotation:T,id:C,color:I,opacity:O,popupRef:j},parent:{page:{pageNumber:H}}}=t;r=t={annotationType:Pt.HIGHLIGHT,color:Array.from(I),opacity:O,quadPoints:b,boxes:null,pageIndex:H-1,rect:S.slice(0),rotation:T,id:C,deleted:!1,popupRef:j}}else if(t instanceof zc){const{data:{inkLists:b,rect:S,rotation:T,id:C,color:I,borderStyle:{rawWidth:O},popupRef:j},parent:{page:{pageNumber:H}}}=t;r=t={annotationType:Pt.HIGHLIGHT,color:Array.from(I),thickness:O,inkLists:b,boxes:null,pageIndex:H-1,rect:S.slice(0),rotation:T,id:C,deleted:!1,popupRef:j}}const{color:o,quadPoints:l,inkLists:c,opacity:h}=t,f=await super.deserialize(t,e,s);f.color=ht.makeHexColor(...o),f.#a=h||1,c&&(f.#g=t.thickness),f.annotationElementId=t.id||null,f._initialData=r;const[g,v]=f.pageDimensions,[y,A]=f.pageTranslation;if(l){const b=f.#n=[];for(let S=0;S<l.length;S+=8)b.push({x:(l[S]-y)/g,y:1-(l[S+1]-A)/v,width:(l[S+2]-l[S])/g,height:(l[S+1]-l[S+5])/v});f.#A(),f.#P(),f.rotate(f.rotation)}else if(c){f.#h=!0;const b=c[0],S={x:b[0]-y,y:v-(b[1]-A)},T=new Ec(S,[0,0,g,v],1,f.#g/2,!0,.001);for(let O=0,j=b.length;O<j;O+=2)S.x=b[O]-y,S.y=v-(b[O+1]-A),T.add(S);const{id:C,clipPathId:I}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:f.color,"fill-opacity":f._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:T.toSVGPath()}},!0,!0);f.#y({highlightOutlines:T.getOutlines(),highlightId:C,clipPathId:I}),f.#P()}return f}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const e=this.getRect(0,0),s=At._colorManager.convert(this.color),r={annotationType:Pt.HIGHLIGHT,color:s,opacity:this.#a,thickness:this.#g,quadPoints:this.#I(),outlines:this.#D(e),pageIndex:this.pageIndex,rect:e,rotation:this.#M(),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!this.#N(r)?null:(r.id=this.annotationElementId,r)}#N(t){const{color:e}=this._initialData;return t.color.some((s,r)=>s!==e[r])}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class rv{#t=Object.create(null);updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,s]of Object.entries(t))this.updateProperty(e,s)}updateSVGProperty(t,e){this.#t[t]=e}toSVGProperties(){const t=this.#t;return this.#t=Object.create(null),{root:t}}reset(){this.#t=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){Wt("Not implemented")}}class wt extends At{#t=null;#e;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#n=null;static#i=null;static#r=null;static#s=NaN;static#l=null;static#o=null;static#u=NaN;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,t.drawOutlines&&(this.#c(t),this.#f())}#c({drawOutlines:t,drawId:e,drawingOptions:s}){this.#t=t,this._drawingOptions||=s,e>=0?(this._drawId=e,this.parent.drawLayer.finalizeDraw(e,t.defaultProperties)):this._drawId=this.#d(t,this.parent),this.#m(t.box)}#d(t,e){const{id:s}=e.drawLayer.draw(wt._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return s}static _mergeSVGProperties(t,e){const s=new Set(Object.keys(t));for(const[r,o]of Object.entries(e))s.has(r)?Object.assign(t[r],o):t[r]=o;return t}static getDefaultDrawingOptions(t){Wt("Not implemented")}static get typesMap(){Wt("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,e){const s=this.typesMap.get(t);s&&this._defaultDrawingOptions.updateProperty(s,e),this._currentParent&&(wt.#n.updateProperty(s,e),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,e){const s=this.constructor.typesMap.get(t);s&&this._updateProperty(t,s,e)}static get defaultPropertiesToUpdate(){const t=[],e=this._defaultDrawingOptions;for(const[s,r]of this.typesMap)t.push([s,e[r]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:e}=this;for(const[s,r]of this.constructor.typesMap)t.push([s,e[r]]);return t}_updateProperty(t,e,s){const r=this._drawingOptions,o=r[e],l=c=>{r.updateProperty(e,c);const h=this.#t.updateProperty(e,c);h&&this.#m(h),this.parent?.drawLayer.updateProperties(this._drawId,r.toSVGProperties())};this.addCommands({cmd:l.bind(this,s),undo:l.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,wt._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#p()),{bbox:this.#g()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,wt._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#p()),{bbox:this.#g()}))}_onTranslating(t,e){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#g(t,e)})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,wt._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#p(),this.parentDimensions),{bbox:this.#g()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#h(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#f(),this.#m(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#h()):t&&(this._uiManager.addShouldRescale(this),this.#f(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),e&&this.select()}#h(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#f(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#d(this.#t,t)}}#a([t,e,s,r]){const{parentDimensions:[o,l],rotation:c}=this;switch(c){case 90:return[e,1-t,s*(l/o),r*(o/l)];case 180:return[1-t,1-e,s,r];case 270:return[1-e,t,s*(l/o),r*(o/l)];default:return[t,e,s,r]}}#p(){const{x:t,y:e,width:s,height:r,parentDimensions:[o,l],rotation:c}=this;switch(c){case 90:return[1-e,t,s*(o/l),r*(l/o)];case 180:return[1-t,1-e,s,r];case 270:return[e,1-t,s*(o/l),r*(l/o)];default:return[t,e,s,r]}}#m(t){if([this.x,this.y,this.width,this.height]=this.#a(t),this.div){this.fixAndSetPosition();const[e,s]=this.parentDimensions;this.setDims(this.width*e,this.height*s)}this._onResized()}#g(){const{x:t,y:e,width:s,height:r,rotation:o,parentRotation:l,parentDimensions:[c,h]}=this;switch((o*4+l)/90){case 1:return[1-e-r,t,r,s];case 2:return[1-t-s,1-e-r,s,r];case 3:return[e,1-t-s,r,s];case 4:return[t,e-s*(c/h),r*(h/c),s*(c/h)];case 5:return[1-e,t,s*(c/h),r*(h/c)];case 6:return[1-t-r*(h/c),1-e,r*(h/c),s*(c/h)];case 7:return[e-s*(c/h),1-t-r*(h/c),s*(c/h),r*(h/c)];case 8:return[t-s,e-r,s,r];case 9:return[1-e,t-s,r,s];case 10:return[1-t,1-e,s,r];case 11:return[e-r,1-t,r,s];case 12:return[t-r*(h/c),e,r*(h/c),s*(c/h)];case 13:return[1-e-s*(c/h),t-r*(h/c),s*(c/h),r*(h/c)];case 14:return[1-t,1-e-s*(c/h),r*(h/c),s*(c/h)];case 15:return[e,1-t,s*(c/h),r*(h/c)];default:return[t,e,s,r]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,wt._mergeSVGProperties({bbox:this.#g()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#m(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;const t=super.render();t.classList.add("draw");const e=document.createElement("div");t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal";const[s,r]=this.parentDimensions;return this.setDims(this.width*s,this.height*r),this._uiManager.addShouldRescale(this),this.disableEditing(),t}static createDrawerInstance(t,e,s,r,o){Wt("Not implemented")}static startDrawing(t,e,s,r){const{target:o,offsetX:l,offsetY:c,pointerId:h,pointerType:f}=r;if(wt.#l&&wt.#l!==f)return;const{viewport:{rotation:g}}=t,{width:v,height:y}=o.getBoundingClientRect(),A=wt.#i=new AbortController,b=t.combinedSignal(A);if(wt.#s||=h,wt.#l??=f,window.addEventListener("pointerup",S=>{wt.#s===S.pointerId?this._endDraw(S):wt.#o?.delete(S.pointerId)},{signal:b}),window.addEventListener("pointercancel",S=>{wt.#s===S.pointerId?this._currentParent.endDrawingSession():wt.#o?.delete(S.pointerId)},{signal:b}),window.addEventListener("pointerdown",S=>{wt.#l===S.pointerType&&((wt.#o||=new Set).add(S.pointerId),wt.#n.isCancellable()&&(wt.#n.removeLastElement(),wt.#n.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:b}),window.addEventListener("contextmenu",En,{signal:b}),o.addEventListener("pointermove",this._drawMove.bind(this),{signal:b}),o.addEventListener("touchmove",S=>{S.timeStamp===wt.#u&&an(S)},{signal:b}),t.toggleDrawing(),e._editorUndoBar?.hide(),wt.#n){t.drawLayer.updateProperties(this._currentDrawId,wt.#n.startNew(l,c,v,y,g));return}e.updateUIForDefaultProperties(this),wt.#n=this.createDrawerInstance(l,c,v,y,g),wt.#r=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(wt.#r.toSVGProperties(),wt.#n.defaultSVGProperties),!0,!1)}static _drawMove(t){if(wt.#u=-1,!wt.#n)return;const{offsetX:e,offsetY:s,pointerId:r}=t;if(wt.#s===r){if(wt.#o?.size>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,wt.#n.add(e,s)),wt.#u=t.timeStamp,an(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,wt.#n=null,wt.#r=null,wt.#l=null,wt.#u=NaN),wt.#i&&(wt.#i.abort(),wt.#i=null,wt.#s=NaN,wt.#o=null)}static _endDraw(t){const e=this._currentParent;if(e){if(e.toggleDrawing(!0),this._cleanup(!1),t&&e.drawLayer.updateProperties(this._currentDrawId,wt.#n.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const s=wt.#n,r=this._currentDrawId,o=s.getLastElement();e.addCommands({cmd:()=>{e.drawLayer.updateProperties(r,s.setLastElement(o))},undo:()=>{e.drawLayer.updateProperties(r,s.removeLastElement())},mustExec:!1,type:zt.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const e=this._currentParent;if(!e)return null;if(e.toggleDrawing(!0),e.cleanUndoStack(zt.DRAW_STEP),!wt.#n.isEmpty()){const{pageDimensions:[s,r],scale:o}=e,l=e.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:wt.#n.getOutlines(s*o,r*o,o,this._INNER_MARGIN),drawingOptions:wt.#r,mustBeCommitted:!t});return this._cleanup(!0),l}return e.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,e,s,r,o,l){Wt("Not implemented")}static async deserialize(t,e,s){const{rawDims:{pageWidth:r,pageHeight:o,pageX:l,pageY:c}}=e.viewport,h=this.deserializeDraw(l,c,r,o,this._INNER_MARGIN,t),f=await super.deserialize(t,e,s);return f.createDrawingOptions(t),f.#c({drawOutlines:h}),f.#f(),f.onScaleChanging(),f.rotate(),f}serializeDraw(t){const[e,s]=this.pageTranslation,[r,o]=this.pageDimensions;return this.#t.serialize([e,s,r,o],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class av{#t=new Float64Array(6);#e;#n;#i;#r;#s;#l="";#o=0;#u=new Ao;#c;#d;constructor(t,e,s,r,o,l){this.#c=s,this.#d=r,this.#i=o,this.#r=l,[t,e]=this.#h(t,e);const c=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#s=[t,e],this.#n=[{line:c,points:this.#s}],this.#t.set(c,0)}updateProperty(t,e){t==="stroke-width"&&(this.#r=e)}#h(t,e){return at._normalizePoint(t,e,this.#c,this.#d,this.#i)}isEmpty(){return!this.#n||this.#n.length===0}isCancellable(){return this.#s.length<=10}add(t,e){[t,e]=this.#h(t,e);const[s,r,o,l]=this.#t.subarray(2,6),c=t-o,h=e-l;return Math.hypot(this.#c*c,this.#d*h)<=2?null:(this.#s.push(t,e),isNaN(s)?(this.#t.set([o,l,t,e],2),this.#e.push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([s,r,o,l,t,e],0),this.#e.push(...at.createBezierPoints(s,r,o,l,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const s=this.add(t,e);return s||(this.#s.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,s,r,o){this.#c=s,this.#d=r,this.#i=o,[t,e]=this.#h(t,e);const l=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#s=[t,e];const c=this.#n.at(-1);return c&&(c.line=new Float32Array(c.line),c.points=new Float32Array(c.points)),this.#n.push({line:l,points:this.#s}),this.#t.set(l,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#n.at(-1)}setLastElement(t){return this.#n?(this.#n.push(t),this.#e=t.line,this.#s=t.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#u.setLastElement(t)}removeLastElement(){if(!this.#n)return this.#u.removeLastElement();this.#n.pop(),this.#l="";for(let t=0,e=this.#n.length;t<e;t++){const{line:s,points:r}=this.#n[t];this.#e=s,this.#s=r,this.#o=0,this.toSVGPath()}return{path:{d:this.#l}}}toSVGPath(){const t=at.svgRound(this.#e[4]),e=at.svgRound(this.#e[5]);if(this.#s.length===2)return this.#l=`${this.#l} M ${t} ${e} Z`,this.#l;if(this.#s.length<=6){const r=this.#l.lastIndexOf("M");this.#l=`${this.#l.slice(0,r)} M ${t} ${e}`,this.#o=6}if(this.#s.length===4){const r=at.svgRound(this.#e[10]),o=at.svgRound(this.#e[11]);return this.#l=`${this.#l} L ${r} ${o}`,this.#o=12,this.#l}const s=[];this.#o===0&&(s.push(`M ${t} ${e}`),this.#o=6);for(let r=this.#o,o=this.#e.length;r<o;r+=6){const[l,c,h,f,g,v]=this.#e.slice(r,r+6).map(at.svgRound);s.push(`C${l} ${c} ${h} ${f} ${g} ${v}`)}return this.#l+=s.join(" "),this.#o=this.#e.length,this.#l}getOutlines(t,e,s,r){const o=this.#n.at(-1);return o.line=new Float32Array(o.line),o.points=new Float32Array(o.points),this.#u.build(this.#n,t,e,s,this.#i,this.#r,r),this.#t=null,this.#e=null,this.#n=null,this.#l=null,this.#u}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class Ao extends at{#t;#e=0;#n;#i;#r;#s;#l;#o;#u;build(t,e,s,r,o,l,c){this.#r=e,this.#s=s,this.#l=r,this.#o=o,this.#u=l,this.#n=c??0,this.#i=t,this.#h()}setLastElement(t){return this.#i.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#i.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:e}of this.#i){if(t.push(`M${at.svgRound(e[4])} ${at.svgRound(e[5])}`),e.length===6){t.push("Z");continue}if(e.length===12){t.push(`L${at.svgRound(e[10])} ${at.svgRound(e[11])}`);continue}for(let s=6,r=e.length;s<r;s+=6){const[o,l,c,h,f,g]=e.subarray(s,s+6).map(at.svgRound);t.push(`C${o} ${l} ${c} ${h} ${f} ${g}`)}}return t.join("")}serialize([t,e,s,r],o){const l=[],c=[],[h,f,g,v]=this.#d();let y,A,b,S,T,C,I,O,j;switch(this.#o){case 0:j=at._rescale,y=t,A=e+r,b=s,S=-r,T=t+h*s,C=e+(1-f-v)*r,I=t+(h+g)*s,O=e+(1-f)*r;break;case 90:j=at._rescaleAndSwap,y=t,A=e,b=s,S=r,T=t+f*s,C=e+h*r,I=t+(f+v)*s,O=e+(h+g)*r;break;case 180:j=at._rescale,y=t+s,A=e,b=-s,S=r,T=t+(1-h-g)*s,C=e+f*r,I=t+(1-h)*s,O=e+(f+v)*r;break;case 270:j=at._rescaleAndSwap,y=t+s,A=e+r,b=-s,S=-r,T=t+(1-f-v)*s,C=e+(1-h-g)*r,I=t+(1-f)*s,O=e+(1-h)*r;break}for(const{line:H,points:W}of this.#i)l.push(j(H,y,A,b,S,o?new Array(H.length):null)),c.push(j(W,y,A,b,S,o?new Array(W.length):null));return{lines:l,points:c,rect:[T,C,I,O]}}static deserialize(t,e,s,r,o,{paths:{lines:l,points:c},rotation:h,thickness:f}){const g=[];let v,y,A,b,S;switch(h){case 0:S=at._rescale,v=-t/s,y=e/r+1,A=1/s,b=-1/r;break;case 90:S=at._rescaleAndSwap,v=-e/r,y=-t/s,A=1/r,b=1/s;break;case 180:S=at._rescale,v=t/s+1,y=-e/r,A=-1/s,b=1/r;break;case 270:S=at._rescaleAndSwap,v=e/r+1,y=t/s+1,A=-1/r,b=-1/s;break}if(!l){l=[];for(const C of c){const I=C.length;if(I===2){l.push(new Float32Array([NaN,NaN,NaN,NaN,C[0],C[1]]));continue}if(I===4){l.push(new Float32Array([NaN,NaN,NaN,NaN,C[0],C[1],NaN,NaN,NaN,NaN,C[2],C[3]]));continue}const O=new Float32Array(3*(I-2));l.push(O);let[j,H,W,V]=C.subarray(0,4);O.set([NaN,NaN,NaN,NaN,j,H],0);for(let it=4;it<I;it+=2){const X=C[it],Ct=C[it+1];O.set(at.createBezierPoints(j,H,W,V,X,Ct),(it-2)*3),[j,H,W,V]=[W,V,X,Ct]}}}for(let C=0,I=l.length;C<I;C++)g.push({line:S(l[C].map(O=>O??NaN),v,y,A,b),points:S(c[C].map(O=>O??NaN),v,y,A,b)});const T=new Ao;return T.build(g,s,r,1,h,f,o),T}#c(t=this.#u){const e=this.#n+t/2*this.#l;return this.#o%180===0?[e/this.#r,e/this.#s]:[e/this.#s,e/this.#r]}#d(){const[t,e,s,r]=this.#t,[o,l]=this.#c(0);return[t+o,e+l,s-2*o,r-2*l]}#h(){const t=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:r}of this.#i){if(r.length<=12){for(let c=4,h=r.length;c<h;c+=6){const[f,g]=r.subarray(c,c+2);t[0]=Math.min(t[0],f),t[1]=Math.min(t[1],g),t[2]=Math.max(t[2],f),t[3]=Math.max(t[3],g)}continue}let o=r[4],l=r[5];for(let c=6,h=r.length;c<h;c+=6){const[f,g,v,y,A,b]=r.subarray(c,c+6);ht.bezierBoundingBox(o,l,f,g,v,y,A,b,t),o=A,l=b}}const[e,s]=this.#c();t[0]=Math.min(1,Math.max(0,t[0]-e)),t[1]=Math.min(1,Math.max(0,t[1]-s)),t[2]=Math.min(1,Math.max(0,t[2]+e)),t[3]=Math.min(1,Math.max(0,t[3]+s)),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#t}updateProperty(t,e){return t==="stroke-width"?this.#f(e):null}#f(t){const[e,s]=this.#c();this.#u=t;const[r,o]=this.#c(),[l,c]=[r-e,o-s],h=this.#t;return h[0]-=l,h[1]-=c,h[2]+=2*l,h[3]+=2*c,h}updateParentDimensions([t,e],s){const[r,o]=this.#c();this.#r=t,this.#s=e,this.#l=s;const[l,c]=this.#c(),h=l-r,f=c-o,g=this.#t;return g[0]-=h,g[1]-=f,g[2]+=2*h,g[3]+=2*f,g}updateRotation(t){return this.#e=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(at.svgRound).join(" ")}get defaultProperties(){const[t,e]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${at.svgRound(t)} ${at.svgRound(e)}`}}}get rotationTransform(){const[,,t,e]=this.#t;let s=0,r=0,o=0,l=0,c=0,h=0;switch(this.#e){case 90:r=e/t,o=-t/e,c=t;break;case 180:s=-1,l=-1,c=t,h=e;break;case 270:r=-e/t,o=t/e,h=e;break;default:return""}return`matrix(${s} ${r} ${o} ${l} ${at.svgRound(c)} ${at.svgRound(h)})`}getPathResizingSVGProperties([t,e,s,r]){const[o,l]=this.#c(),[c,h,f,g]=this.#t;if(Math.abs(f-o)<=at.PRECISION||Math.abs(g-l)<=at.PRECISION){const S=t+s/2-(c+f/2),T=e+r/2-(h+g/2);return{path:{"transform-origin":`${at.svgRound(t)} ${at.svgRound(e)}`,transform:`${this.rotationTransform} translate(${S} ${T})`}}}const v=(s-2*o)/(f-2*o),y=(r-2*l)/(g-2*l),A=f/s,b=g/r;return{path:{"transform-origin":`${at.svgRound(c)} ${at.svgRound(h)}`,transform:`${this.rotationTransform} scale(${A} ${b}) translate(${at.svgRound(o)} ${at.svgRound(l)}) scale(${v} ${y}) translate(${at.svgRound(-o)} ${at.svgRound(-l)})`}}}getPathResizedSVGProperties([t,e,s,r]){const[o,l]=this.#c(),c=this.#t,[h,f,g,v]=c;if(c[0]=t,c[1]=e,c[2]=s,c[3]=r,Math.abs(g-o)<=at.PRECISION||Math.abs(v-l)<=at.PRECISION){const T=t+s/2-(h+g/2),C=e+r/2-(f+v/2);for(const{line:I,points:O}of this.#i)at._translate(I,T,C,I),at._translate(O,T,C,O);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${at.svgRound(t)} ${at.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const y=(s-2*o)/(g-2*o),A=(r-2*l)/(v-2*l),b=-y*(h+o)+t+o,S=-A*(f+l)+e+l;if(y!==1||A!==1||b!==0||S!==0)for(const{line:T,points:C}of this.#i)at._rescale(T,b,S,y,A,T),at._rescale(C,b,S,y,A,C);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${at.svgRound(t)} ${at.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,e],s){const[r,o]=s,l=this.#t,c=t-l[0],h=e-l[1];if(this.#r===r&&this.#s===o)for(const{line:f,points:g}of this.#i)at._translate(f,c,h,f),at._translate(g,c,h,g);else{const f=this.#r/r,g=this.#s/o;this.#r=r,this.#s=o;for(const{line:v,points:y}of this.#i)at._rescale(v,c,h,f,g,v),at._rescale(y,c,h,f,g,y);l[2]*=f,l[3]*=g}return l[0]=t,l[1]=e,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${at.svgRound(t)} ${at.svgRound(e)}`}}}get defaultSVGProperties(){const t=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${at.svgRound(t[0])} ${at.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}class Hc extends rv{#t;constructor(t){super(),this.#t=t,super.updateProperties({fill:"none",stroke:At._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,e){t==="stroke-width"&&(e??=this["stroke-width"],e*=this.#t.realScale),super.updateSVGProperty(t,e)}clone(){const t=new Hc(this.#t);return t.updateAll(this),t}}class Bc extends wt{static _type="ink";static _editorType=Pt.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0}static initialize(t,e){At.initialize(t,e),this._defaultDrawingOptions=new Hc(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!0}static get typesMap(){return Ot(this,"typesMap",new Map([[zt.INK_THICKNESS,"stroke-width"],[zt.INK_COLOR,"stroke"],[zt.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,e,s,r,o){return new av(t,e,s,r,o,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,e,s,r,o,l){return Ao.deserialize(t,e,s,r,o,l)}static async deserialize(t,e,s){let r=null;if(t instanceof zc){const{data:{inkLists:l,rect:c,rotation:h,id:f,color:g,opacity:v,borderStyle:{rawWidth:y},popupRef:A},parent:{page:{pageNumber:b}}}=t;r=t={annotationType:Pt.INK,color:Array.from(g),thickness:y,opacity:v,paths:{points:l},boxes:null,pageIndex:b-1,rect:c.slice(0),rotation:h,id:f,deleted:!1,popupRef:A}}const o=await super.deserialize(t,e,s);return o.annotationElementId=t.id||null,o._initialData=r,o}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:e,parent:s}=this;e.updateSVGProperty("stroke-width"),s.drawLayer.updateProperties(t,e.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:e,opacity:s}){this._drawingOptions=Bc.getDefaultDrawingOptions({stroke:ht.makeHexColor(...t),"stroke-width":e,"stroke-opacity":s})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:e,points:s,rect:r}=this.serializeDraw(t),{_drawingOptions:{stroke:o,"stroke-opacity":l,"stroke-width":c}}=this,h={annotationType:Pt.INK,color:At._colorManager.convert(o),opacity:l,thickness:c,paths:{lines:e,points:s},pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?h:this.annotationElementId&&!this.#t(h)?null:(h.id=this.annotationElementId,h)}#t(t){const{color:e,thickness:s,opacity:r,pageIndex:o}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||t.color.some((l,c)=>l!==e[c])||t.thickness!==s||t.opacity!==r||t.pageIndex!==o}renderAnnotationElement(t){const{points:e,rect:s}=this.serializeDraw(!1);return t.updateEdited({rect:s,thickness:this._drawingOptions["stroke-width"],points:e}),null}}class Uc extends At{#t=null;#e=null;#n=null;#i=null;#r=null;#s="";#l=null;#o=null;#u=!1;#c=!1;static _type="stamp";static _editorType=Pt.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#i=t.bitmapUrl,this.#r=t.bitmapFile}static initialize(t,e){At.initialize(t,e)}static get supportedTypes(){return Ot(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(e=>`image/${e}`))}static get supportedTypesStr(){return Ot(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(t){return this.supportedTypes.includes(t)}static paste(t,e){e.pasteEditor(Pt.STAMP,{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const e=t.get("hasAltText");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}#d(t,e=!1){if(!t){this.remove();return}this.#t=t.bitmap,e||(this.#e=t.id,this.#u=t.isSvg),t.file&&(this.#s=t.file.name),this.#a()}#h(){if(this.#n=null,this._uiManager.enableWaiting(!1),!!this.#l){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,e=!0){if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:o,height:l}=t||this.copyCanvas(null,null,!0).imageData,c=await s.guess({name:"altText",request:{data:r,width:o,height:l,channels:r.length/(o*l)}});if(!c)throw new Error("No response from the AI service.");if(c.error)throw new Error("Error from the AI service.");if(c.cancel)return null;if(!c.output)throw new Error("No valid response from the AI service.");const h=c.output;return await this.setGuessedAltText(h),e&&!this.hasAltTextData()&&(this.altTextData={alt:h,decorative:!1}),h}#f(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(s=>this.#d(s,!0)).finally(()=>this.#h());return}if(this.#i){const s=this.#i;this.#i=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(s).then(r=>this.#d(r)).finally(()=>this.#h());return}if(this.#r){const s=this.#r;this.#r=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(s).then(r=>this.#d(r)).finally(()=>this.#h());return}const t=document.createElement("input");t.type="file",t.accept=Uc.supportedTypesStr;const e=this._uiManager._signal;this.#n=new Promise(s=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#d(r)}s()},{signal:e}),t.addEventListener("cancel",()=>{this.remove(),s()},{signal:e})}).finally(()=>this.#h()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#l?.remove(),this.#l=null,this.#o&&(clearTimeout(this.#o),this.#o=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#f();return}super.rebuild(),this.div!==null&&(this.#e&&this.#l===null&&this.#f(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#n||this.#t||this.#i||this.#r||this.#e)}get isResizable(){return!0}render(){if(this.div)return this.div;let t,e;if(this.width&&(t=this.x,e=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),this.#t?this.#a():this.#f(),this.width&&!this.annotationElementId){const[s,r]=this.parentDimensions;this.setAt(t*s,e*r,this.width*s,this.height*r)}return this._uiManager.addShouldRescale(this),this.div}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#o!==null&&clearTimeout(this.#o);const t=200;this.#o=setTimeout(()=>{this.#o=null,this.#m()},t)}#a(){const{div:t}=this;let{width:e,height:s}=this.#t;const[r,o]=this.pageDimensions,l=.75;if(this.width)e=this.width*r,s=this.height*o;else if(e>l*r||s>l*o){const g=Math.min(l*r/e,l*o/s);e*=g,s*=g}const[c,h]=this.parentDimensions;this.setDims(e*c/r,s*h/o),this._uiManager.enableWaiting(!1);const f=this.#l=document.createElement("canvas");f.setAttribute("role","img"),this.addContainer(f),this.width=e/r,this.height=s/o,this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),this.#m(),this.#c||(this.parent.addUndoableEditor(this),this.#c=!0),this._reportTelemetry({action:"inserted_image"}),this.#s&&f.setAttribute("aria-label",this.#s)}copyCanvas(t,e,s=!1){t||(t=224);const{width:r,height:o}=this.#t,l=new Ac;let c=this.#t,h=r,f=o,g=null;if(e){if(r>e||o>e){const W=Math.min(e/r,e/o);h=Math.floor(r*W),f=Math.floor(o*W)}g=document.createElement("canvas");const y=g.width=Math.ceil(h*l.sx),A=g.height=Math.ceil(f*l.sy);this.#u||(c=this.#p(y,A));const b=g.getContext("2d");b.filter=this._uiManager.hcmFilter;let S="white",T="#cfcfd8";this._uiManager.hcmFilter!=="none"?T="black":window.matchMedia?.("(prefers-color-scheme: dark)").matches&&(S="#8f8f9d",T="#42414d");const C=15,I=C*l.sx,O=C*l.sy,j=new OffscreenCanvas(I*2,O*2),H=j.getContext("2d");H.fillStyle=S,H.fillRect(0,0,I*2,O*2),H.fillStyle=T,H.fillRect(0,0,I,O),H.fillRect(I,O,I,O),b.fillStyle=b.createPattern(j,"repeat"),b.fillRect(0,0,y,A),b.drawImage(c,0,0,c.width,c.height,0,0,y,A)}let v=null;if(s){let y,A;if(l.symmetric&&c.width<t&&c.height<t)y=c.width,A=c.height;else if(c=this.#t,r>t||o>t){const T=Math.min(t/r,t/o);y=Math.floor(r*T),A=Math.floor(o*T),this.#u||(c=this.#p(y,A))}const S=new OffscreenCanvas(y,A).getContext("2d",{willReadFrequently:!0});S.drawImage(c,0,0,c.width,c.height,0,0,y,A),v={width:y,height:A,data:S.getImageData(0,0,y,A).data}}return{canvas:g,width:h,height:f,imageData:v}}#p(t,e){const{width:s,height:r}=this.#t;let o=s,l=r,c=this.#t;for(;o>2*t||l>2*e;){const h=o,f=l;o>2*t&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),l>2*e&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2));const g=new OffscreenCanvas(o,l);g.getContext("2d").drawImage(c,0,0,h,f,0,0,o,l),c=g.transferToImageBitmap()}return c}#m(){const[t,e]=this.parentDimensions,{width:s,height:r}=this,o=new Ac,l=Math.ceil(s*t*o.sx),c=Math.ceil(r*e*o.sy),h=this.#l;if(!h||h.width===l&&h.height===c)return;h.width=l,h.height=c;const f=this.#u?this.#t:this.#p(l,c),g=h.getContext("2d");g.filter=this._uiManager.hcmFilter,g.drawImage(f,0,0,f.width,f.height,0,0,l,c)}getImageForAltText(){return this.#l}#g(t){if(t){if(this.#u){const r=this._uiManager.imageManager.getSvgUrl(this.#e);if(r)return r}const e=document.createElement("canvas");return{width:e.width,height:e.height}=this.#t,e.getContext("2d").drawImage(this.#t,0,0),e.toDataURL()}if(this.#u){const[e,s]=this.pageDimensions,r=Math.round(this.width*e*zs.PDF_TO_CSS_UNITS),o=Math.round(this.height*s*zs.PDF_TO_CSS_UNITS),l=new OffscreenCanvas(r,o);return l.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,r,o),l.transferToImageBitmap()}return structuredClone(this.#t)}static async deserialize(t,e,s){let r=null;if(t instanceof vf){const{data:{rect:b,rotation:S,id:T,structParent:C,popupRef:I},container:O,parent:{page:{pageNumber:j}}}=t,H=O.querySelector("canvas"),W=s.imageManager.getFromCanvas(O.id,H);H.remove();const V=(await e._structTree.getAriaAttributes(`${Tc}${T}`))?.get("aria-label")||"";r=t={annotationType:Pt.STAMP,bitmapId:W.id,bitmap:W.bitmap,pageIndex:j-1,rect:b.slice(0),rotation:S,id:T,deleted:!1,accessibilityData:{decorative:!1,altText:V},isSvg:!1,structParent:C,popupRef:I}}const o=await super.deserialize(t,e,s),{rect:l,bitmap:c,bitmapUrl:h,bitmapId:f,isSvg:g,accessibilityData:v}=t;f&&s.imageManager.isValidId(f)?(o.#e=f,c&&(o.#t=c)):o.#i=h,o.#u=g;const[y,A]=o.pageDimensions;return o.width=(l[2]-l[0])/y,o.height=(l[3]-l[1])/A,o.annotationElementId=t.id||null,v&&(o.altTextData=v),o._initialData=r,o.#c=!!r,o}serialize(t=!1,e=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s={annotationType:Pt.STAMP,bitmapId:this.#e,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#u,structTreeParentId:this._structTreeParentId};if(t)return s.bitmapUrl=this.#g(!0),s.accessibilityData=this.serializeAltText(!0),s;const{decorative:r,altText:o}=this.serializeAltText(!1);if(!r&&o&&(s.accessibilityData={type:"Figure",alt:o}),this.annotationElementId){const c=this.#v(s);if(c.isSame)return null;c.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1}if(s.id=this.annotationElementId,e===null)return s;e.stamps||=new Map;const l=this.#u?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!e.stamps.has(this.#e))e.stamps.set(this.#e,{area:l,serialized:s}),s.bitmap=this.#g(!1);else if(this.#u){const c=e.stamps.get(this.#e);l>c.area&&(c.area=l,c.serialized.bitmap.close(),c.serialized.bitmap=this.#g(!1))}return s}#v(t){const{pageIndex:e,accessibilityData:{altText:s}}=this._initialData,r=t.pageIndex===e,o=(t.accessibilityData?.alt||"")===s;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&r&&o,isSameAltText:o}}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}}class qn{#t;#e=!1;#n=null;#i=null;#r=null;#s=new Map;#l=!1;#o=!1;#u=!1;#c=null;#d=null;#h=null;#f=null;#a;static _initialized=!1;static#p=new Map([Ae,Bc,Uc,he].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:e,div:s,structTreeLayer:r,accessibilityManager:o,annotationLayer:l,drawLayer:c,textLayer:h,viewport:f,l10n:g}){const v=[...qn.#p.values()];if(!qn._initialized){qn._initialized=!0;for(const y of v)y.initialize(g,t)}t.registerEditorTypes(v),this.#a=t,this.pageIndex=e,this.div=s,this.#t=o,this.#n=l,this.viewport=f,this.#h=h,this.drawLayer=c,this._structTree=r,this.#a.addLayer(this)}get isEmpty(){return this.#s.size===0}get isInvisible(){return this.isEmpty&&this.#a.getMode()===Pt.NONE}updateToolbar(t){this.#a.updateToolbar(t)}updateMode(t=this.#a.getMode()){switch(this.#y(),t){case Pt.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Pt.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Pt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;for(const s of qn.#p.values())e.toggle(`${s._type}Editing`,t===s._editorType);this.div.hidden=!1}hasTextLayer(t){return t===this.#h?.div}setEditingState(t){this.#a.setEditingState(t)}addCommands(t){this.#a.addCommands(t)}cleanUndoStack(t){this.#a.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#n?.div.classList.toggle("disabled",!t)}async enable(){this.#u=!0,this.div.tabIndex=0,this.togglePointerEvents(!0);const t=new Set;for(const s of this.#s.values())s.enableEditing(),s.show(!0),s.annotationElementId&&(this.#a.removeChangedExistingAnnotation(s),t.add(s.annotationElementId));if(!this.#n){this.#u=!1;return}const e=this.#n.getEditableAnnotations();for(const s of e){if(s.hide(),this.#a.isDeletedAnnotationElement(s.data.id)||t.has(s.data.id))continue;const r=await this.deserialize(s);r&&(this.addOrRebuild(r),r.enableEditing())}this.#u=!1}disable(){this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1);const t=new Map,e=new Map;for(const r of this.#s.values())if(r.disableEditing(),!!r.annotationElementId){if(r.serialize()!==null){t.set(r.annotationElementId,r);continue}else e.set(r.annotationElementId,r);this.getEditableAnnotation(r.annotationElementId)?.show(),r.remove()}if(this.#n){const r=this.#n.getEditableAnnotations();for(const o of r){const{id:l}=o.data;if(this.#a.isDeletedAnnotationElement(l))continue;let c=e.get(l);if(c){c.resetAnnotationElement(o),c.show(!1),o.show();continue}c=t.get(l),c&&(this.#a.addChangedExistingAnnotation(c),c.renderAnnotationElement(o)&&c.show(!1)),o.show()}}this.#y(),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const r of qn.#p.values())s.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#o=!1}getEditableAnnotation(t){return this.#n?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#a.getActive()!==t&&this.#a.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#h?.div&&!this.#f){this.#f=new AbortController;const t=this.#a.combinedSignal(this.#f);this.#h.div.addEventListener("pointerdown",this.#m.bind(this),{signal:t}),this.#h.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#h?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#h.div.classList.remove("highlighting"))}#m(t){this.#a.unselectAll();const{target:e}=t;if(e===this.#h.div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&this.#h.div.contains(e)){const{isMac:s}=Be.platform;if(t.button!==0||t.ctrlKey&&s)return;this.#a.showAllEditors("highlight",!0,!0),this.#h.div.classList.add("free"),this.toggleDrawing(),he.startHighlighting(this,this.#a.direction==="ltr",{target:this.#h.div,x:t.x,y:t.y}),this.#h.div.addEventListener("pointerup",()=>{this.#h.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#a._signal}),t.preventDefault()}}enableClick(){if(this.#i)return;this.#i=new AbortController;const t=this.#a.combinedSignal(this.#i);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){this.#i?.abort(),this.#i=null}attach(t){this.#s.set(t.id,t);const{annotationElementId:e}=t;e&&this.#a.isDeletedAnnotationElement(e)&&this.#a.removeDeletedAnnotationElement(t)}detach(t){this.#s.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#o&&t.annotationElementId&&this.#a.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#a.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#a.addDeletedAnnotationElement(t.annotationElementId),At.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#a.addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#u),this.#a.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!this.#r&&(t._focusEventsAllowed=!1,this.#r=setTimeout(()=>{this.#r=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#a._signal}),e.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),s=()=>{t.remove()};this.addCommands({cmd:e,undo:s,mustExec:!1})}getNextId(){return this.#a.getId()}get#g(){return qn.#p.get(this.#a.getMode())}combinedSignal(t){return this.#a.combinedSignal(t)}#v(t){const e=this.#g;return e?new e.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#g?.canCreateNewEmptyEditor()}pasteEditor(t,e){this.#a.updateToolbar(t),this.#a.updateMode(t);const{offsetX:s,offsetY:r}=this.#A(),o=this.getNextId(),l=this.#v({parent:this,id:o,x:s,y:r,uiManager:this.#a,isCentered:!0,...e});l&&this.add(l)}async deserialize(t){return await qn.#p.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#a)||null}createAndAddNewEditor(t,e,s={}){const r=this.getNextId(),o=this.#v({parent:this,id:r,x:t.offsetX,y:t.offsetY,uiManager:this.#a,isCentered:e,...s});return o&&this.add(o),o}#A(){const{x:t,y:e,width:s,height:r}=this.div.getBoundingClientRect(),o=Math.max(0,t),l=Math.max(0,e),c=Math.min(window.innerWidth,t+s),h=Math.min(window.innerHeight,e+r),f=(o+c)/2-t,g=(l+h)/2-e,[v,y]=this.viewport.rotation%180===0?[f,g]:[g,f];return{offsetX:v,offsetY:y}}addNewEditor(){this.createAndAddNewEditor(this.#A(),!0)}setSelected(t){this.#a.setSelected(t)}toggleSelected(t){this.#a.toggleSelected(t)}unselect(t){this.#a.unselect(t)}pointerup(t){const{isMac:e}=Be.platform;if(!(t.button!==0||t.ctrlKey&&e)&&t.target===this.div&&this.#l&&(this.#l=!1,!(this.#g?.isDrawer&&this.#g.supportMultipleDrawings))){if(!this.#e){this.#e=!0;return}if(this.#a.getMode()===Pt.STAMP){this.#a.unselectAll();return}this.createAndAddNewEditor(t,!1)}}pointerdown(t){if(this.#a.getMode()===Pt.HIGHLIGHT&&this.enableTextSelection(),this.#l){this.#l=!1;return}const{isMac:e}=Be.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(this.#l=!0,this.#g?.isDrawer){this.startDrawingSession(t);return}const s=this.#a.getActive();this.#e=!s||s.isEmpty()}startDrawingSession(t){if(this.div.focus(),this.#c){this.#g.startDrawing(this,this.#a,!1,t);return}this.#a.setCurrentDrawingSession(this),this.#c=new AbortController;const e=this.#a.combinedSignal(this.#c);this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(this.#d=null,this.commitOrRemove())},{signal:e}),this.#g.startDrawing(this,this.#a,!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&(this.#d=e);return}this.#d&&setTimeout(()=>{this.#d?.focus(),this.#d=null},0)}endDrawingSession(t=!1){return this.#c?(this.#a.setCurrentDrawingSession(null),this.#c.abort(),this.#c=null,this.#d=null,this.#g.endDrawing(t)):null}findNewParent(t,e,s){const r=this.#a.findParent(e,s);return r===null||r===this?!1:(r.changeParent(t),!0)}commitOrRemove(){return this.#c?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#c&&this.#g.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#a.getActive()?.parent===this&&(this.#a.commitOrRemove(),this.#a.setActiveEditor(null)),this.#r&&(clearTimeout(this.#r),this.#r=null);for(const t of this.#s.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#s.clear(),this.#a.removeLayer(this)}#y(){for(const t of this.#s.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,Qi(this.div,t);for(const e of this.#a.getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){this.#a.commitOrRemove(),this.#y();const e=this.viewport.rotation,s=t.rotation;if(this.viewport=t,Qi(this.div,{rotation:s}),e!==s)for(const r of this.#s.values())r.rotate(s)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return this.#a.viewParameters.realScale}}class ze{#t=null;#e=0;#n=new Map;#i=new Map;constructor({pageIndex:t}){this.pageIndex=t}setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#n.size>0)for(const e of this.#n.values())e.remove(),t.append(e);this.#t=t}}static get _svgFactory(){return Ot(this,"_svgFactory",new jc)}static#r(t,[e,s,r,o]){const{style:l}=t;l.top=`${100*s}%`,l.left=`${100*e}%`,l.width=`${100*r}%`,l.height=`${100*o}%`}#s(){const t=ze._svgFactory.create(1,1,!0);return this.#t.append(t),t.setAttribute("aria-hidden",!0),t}#l(t,e){const s=ze._svgFactory.createElement("clipPath");t.append(s);const r=`clip_${e}`;s.setAttribute("id",r),s.setAttribute("clipPathUnits","objectBoundingBox");const o=ze._svgFactory.createElement("use");return s.append(o),o.setAttribute("href",`#${e}`),o.classList.add("clip"),r}#o(t,e){for(const[s,r]of Object.entries(e))r===null?t.removeAttribute(s):t.setAttribute(s,r)}draw(t,e=!1,s=!1){const r=this.#e++,o=this.#s(),l=ze._svgFactory.createElement("defs");o.append(l);const c=ze._svgFactory.createElement("path");l.append(c);const h=`path_p${this.pageIndex}_${r}`;c.setAttribute("id",h),c.setAttribute("vector-effect","non-scaling-stroke"),e&&this.#i.set(r,c);const f=s?this.#l(l,h):null,g=ze._svgFactory.createElement("use");return o.append(g),g.setAttribute("href",`#${h}`),this.updateProperties(o,t),this.#n.set(r,o),{id:r,clipPathId:`url(#${f})`}}drawOutline(t,e){const s=this.#e++,r=this.#s(),o=ze._svgFactory.createElement("defs");r.append(o);const l=ze._svgFactory.createElement("path");o.append(l);const c=`path_p${this.pageIndex}_${s}`;l.setAttribute("id",c),l.setAttribute("vector-effect","non-scaling-stroke");let h;if(e){const v=ze._svgFactory.createElement("mask");o.append(v),h=`mask_p${this.pageIndex}_${s}`,v.setAttribute("id",h),v.setAttribute("maskUnits","objectBoundingBox");const y=ze._svgFactory.createElement("rect");v.append(y),y.setAttribute("width","1"),y.setAttribute("height","1"),y.setAttribute("fill","white");const A=ze._svgFactory.createElement("use");v.append(A),A.setAttribute("href",`#${c}`),A.setAttribute("stroke","none"),A.setAttribute("fill","black"),A.setAttribute("fill-rule","nonzero"),A.classList.add("mask")}const f=ze._svgFactory.createElement("use");r.append(f),f.setAttribute("href",`#${c}`),h&&f.setAttribute("mask",`url(#${h})`);const g=f.cloneNode();return r.append(g),f.classList.add("mainOutline"),g.classList.add("secondaryOutline"),this.updateProperties(r,t),this.#n.set(s,r),s}finalizeDraw(t,e){this.#i.delete(t),this.updateProperties(t,e)}updateProperties(t,e){if(!e)return;const{root:s,bbox:r,rootClass:o,path:l}=e,c=typeof t=="number"?this.#n.get(t):t;if(c){if(s&&this.#o(c,s),r&&ze.#r(c,r),o){const{classList:h}=c;for(const[f,g]of Object.entries(o))h.toggle(f,g)}if(l){const f=c.firstChild.firstChild;this.#o(f,l)}}}updateParent(t,e){if(e===this)return;const s=this.#n.get(t);s&&(e.#t.append(s),this.#n.delete(t),e.#n.set(t,s))}remove(t){this.#i.delete(t),this.#t!==null&&(this.#n.get(t).remove(),this.#n.delete(t))}destroy(){this.#t=null;for(const t of this.#n.values())t.remove();this.#n.clear(),this.#i.clear()}}globalThis.pdfjsTestingUtils={HighlightOutliner:xc};_t.AbortException;_t.AnnotationEditorLayer;_t.AnnotationEditorParamsType;_t.AnnotationEditorType;_t.AnnotationEditorUIManager;_t.AnnotationLayer;_t.AnnotationMode;_t.ColorPicker;_t.DOMSVGFactory;_t.DrawLayer;_t.FeatureTest;var ov=_t.GlobalWorkerOptions;_t.ImageKind;_t.InvalidPDFException;_t.MissingPDFException;_t.OPS;_t.OutputScale;_t.PDFDataRangeTransport;_t.PDFDateString;_t.PDFWorker;_t.PasswordResponses;_t.PermissionFlag;_t.PixelsPerInch;_t.RenderingCancelledException;_t.TextLayer;_t.TouchManager;_t.UnexpectedResponseException;_t.Util;_t.VerbosityLevel;_t.XfaLayer;_t.build;_t.createValidAbsoluteUrl;_t.fetchData;var lv=_t.getDocument;_t.getFilenameFromUrl;_t.getPdfFilenameFromUrl;_t.getXfaPageViewport;_t.isDataScheme;_t.isPdfFile;_t.noContextMenu;_t.normalizeUnicode;_t.setLayerDimensions;_t.shadow;_t.stopEvent;_t.version;const cv="/assets/pdf.worker.min-yatZIOMy.mjs";ov.workerSrc=cv;const pc={letter:{label:"Letter (612 x 792)",width:612,height:792},a4:{label:"A4 (595.28 x 841.89)",width:595.2756,height:841.8898},legal:{label:"Legal (612 x 1008)",width:612,height:1008},custom:{label:"Custom",width:612,height:792}};function uv(p){const[t,e,s]=Array.isArray(p)&&p.length===3?p:[0,0,0],r=l=>Math.max(0,Math.min(255,Math.round(l*255))),o=l=>l.toString(16).padStart(2,"0");return`#${o(r(t))}${o(r(e))}${o(r(s))}`}function hv(p){if(typeof p!="string"||!p.startsWith("#")||p.length!==7&&p.length!==4)return[0,0,0];let t,e,s;p.length===4?(t=parseInt(p[1]+p[1],16),e=parseInt(p[2]+p[2],16),s=parseInt(p[3]+p[3],16)):(t=parseInt(p.slice(1,3),16),e=parseInt(p.slice(3,5),16),s=parseInt(p.slice(5,7),16));const r=o=>Math.max(0,Math.min(1,o/255));return[r(t),r(e),r(s)]}function dv(p){const[t,e,s]=Array.isArray(p)&&p.length===3?p:[0,0,0],r=o=>Math.max(0,Math.min(255,Math.round(o*255)));return`rgb(${r(t)}, ${r(e)}, ${r(s)})`}function fv(p){return String(p).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function Xi(p){return fv(p).replace(/\n/g,"<br>")}function gc(p){const t=document.createElement("template");return t.innerHTML=String(p??""),t.content.querySelectorAll("script,style,iframe,object,embed,link,meta").forEach(e=>e.remove()),t.content.querySelectorAll("*").forEach(e=>{[...e.attributes].forEach(s=>{const r=s.name,o=s.value;if(/^on/i.test(r)){e.removeAttribute(r);return}(r==="href"||r==="src")&&typeof o=="string"&&o.trim().toLowerCase().startsWith("javascript:")&&e.removeAttribute(r)})}),t.innerHTML}function pv(p){return String(p).replace(/["\\]/g,"\\$&")}const mc=[{value:"Helvetica",label:"Helvetica (Sans-serif)"},{value:"Helvetica-Bold",label:"Helvetica Bold"},{value:"Helvetica-Oblique",label:"Helvetica Oblique"},{value:"Helvetica-BoldOblique",label:"Helvetica Bold Oblique"},{value:"Times-Roman",label:"Times Roman (Serif)"},{value:"Times-Bold",label:"Times Bold"},{value:"Times-Italic",label:"Times Italic"},{value:"Times-BoldItalic",label:"Times Bold Italic"},{value:"Courier",label:"Courier (Monospace)"},{value:"Courier-Bold",label:"Courier Bold"},{value:"Courier-Oblique",label:"Courier Oblique"},{value:"Courier-BoldOblique",label:"Courier Bold Oblique"},{value:"Symbol",label:"Symbol"},{value:"ZapfDingbats",label:"Zapf Dingbats"}];function Bd(){return Math.random().toString(36).slice(2,10)}function vc(p,t,e){const s=Math.max(0,Math.min(p.x,t-1)),r=Math.max(0,Math.min(p.y,e-1)),o=Math.max(8,Math.min(p.w,t-s)),l=Math.max(8,Math.min(p.h,e-r));return{...p,x:s,y:r,w:o,h:l}}function gv(p,t,e){if(!p||!t||!e)return e;const s=p.length*e*.56;return s<=t?e:Math.max(8,t/s*e)}function Ud(p,t,e=null){const s=String(p??"").trim()||"field",r=new Set(t.filter(l=>l.id!==e).map(l=>String(l.name??"").trim()));if(!r.has(s))return s;let o=2;for(;r.has(`${s}_${o}`);)o+=1;return`${s}_${o}`}function mv(p){if(!p)return"";if(typeof p=="string")return p;if(typeof p=="object"){const t=[];if(p.message&&t.push(p.message),p.stderr){const e=String(p.stderr).trim();e&&t.push(`stderr: ${e}`)}if(p.stdout){const e=String(p.stdout).trim();e&&t.push(`stdout: ${e}`)}if(t.length>0)return t.join(" | ");try{return JSON.stringify(p)}catch{return String(p)}}return String(p)}function vv(p,t){if(!p)return t;const e=p.match(/filename\*?=(?:UTF-8''|")?([^";\r\n]+)/i);if(!e?.[1])return t;const s=e[1].trim().replace(/"$/,"");try{return decodeURIComponent(s)}catch{return s}}async function yv(p,t){if(p.name.split(".").pop()?.toLowerCase()==="pdf"){const o=await p.arrayBuffer(),c=await(await lv({data:o}).promise).getPage(1),h=c.getViewport({scale:1}),g=c.getViewport({scale:1.5}),v=document.createElement("canvas"),y=v.getContext("2d");return v.width=Math.floor(g.width),v.height=Math.floor(g.height),await c.render({canvasContext:y,viewport:g}).promise,{src:v.toDataURL("image/png"),displayWidth:v.width,displayHeight:v.height,pageWidthPt:h.width,pageHeightPt:h.height,name:p.name}}const s=URL.createObjectURL(p),r=await new Promise((o,l)=>{const c=new Image;c.onload=()=>o(c),c.onerror=l,c.src=s});return{src:s,displayWidth:r.naturalWidth,displayHeight:r.naturalHeight,pageWidthPt:t.width,pageHeightPt:t.height,name:p.name}}function wv(){const p=St.useRef(null),[t,e]=St.useState("dark"),[s,r]=St.useState(1),[o,l]=St.useState(null),[c,h]=St.useState([]),[f,g]=St.useState(null),[v,y]=St.useState([]),[A,b]=St.useState({}),[S,T]=St.useState({}),[C,I]=St.useState(!1),[O,j]=St.useState([]),[H,W]=St.useState(""),[V,it]=St.useState("fields.json"),[X,Ct]=St.useState(null),[ft,Nt]=St.useState({fieldLayouts:!0,dataSource:!0,fontManager:!0,generate:!0,fields:!0,selectedField:!0,preview:!0}),[Mt,Lt]=St.useState("letter"),[Ut,Z]=St.useState({width:612,height:792}),[q,Y]=St.useState([]),[nt,Q]=St.useState(null),[M,z]=St.useState(!1),[J,vt]=St.useState(null),[xt,pt]=St.useState({}),[dt,Et]=St.useState({}),[Tt,fe]=St.useState(!1),Yt=St.useRef({name:null,html:"",text:""}),Ze=St.useRef(null),[Xt,xi]=St.useState(null),[Hr,Hs]=St.useState([]),[ts,jt]=St.useState(""),[Cn,Ei]=St.useState(null),[Ee,es]=St.useState(null),[Ci,ki]=St.useState(!1),[Ti,Pi]=St.useState(!1),[Yn,In]=St.useState(!1),[Ce,on]=St.useState({row:0,output_mode:"full_pdf",dx:0,dy:0,grid_step:0,page_size:"letter",generate_all:!1}),Ri=St.useMemo(()=>Mt==="custom"?{width:Number(Ut.width)||612,height:Number(Ut.height)||792}:{width:pc[Mt].width,height:pc[Mt].height},[Mt,Ut]),rt=q.find(_=>_.id===nt)??null,ns=St.useMemo(()=>new Set([...mc.map(_=>_.value),...c.map(_=>_.name)]),[c]);St.useEffect(()=>{if(!Tt||!rt?.name){Yt.current={name:null,html:"",text:""},Ze.current=null;return}const _=rt.name,k=xt[_]??`{${_}}`,D=dt[_]??Xi(k);Yt.current={name:_,html:D,text:k},Ze.current=null},[Tt,nt]),St.useEffect(()=>{if(!Tt||!rt?.id)return;const _=()=>{const k=window.getSelection();if(!k||k.rangeCount===0)return;const D=document.querySelector('.field-box.active .field-preview[contenteditable="true"]');if(!D)return;const B=k.getRangeAt(0);B&&!B.collapsed&&D.contains(B.startContainer)&&D.contains(B.endContainer)&&(Ze.current=B.cloneRange())};return document.addEventListener("selectionchange",_),()=>document.removeEventListener("selectionchange",_)},[Tt,nt]);const Br=async _=>{if(!_){y([]),b({});return}try{const D=(await _.text()).split(`
`);if(D.length===0){y([]),b({});return}const tt=D[0].trim().split(",").map(kt=>kt.trim().replace(/^"|"$/g,""));if(y(tt),D.length>1){const kt=D[1].trim();if(kt){const te=kt.split(",").map(ct=>ct.trim().replace(/^"|"$/g,"")),It={};tt.forEach((ct,yt)=>{It[ct]=te[yt]||""}),b(It)}}}catch(k){jt(`Failed to parse CSV: ${k.message}`),y([]),b({})}},bo=async _=>{const k=_.target.files?.[0]??null;g(k),k?await Br(k):(y([]),b({}),T({}))},Bs=(_,k)=>{T(D=>({...D,[_]:k})),k&&A[k]&&(pt(D=>({...D,[_]:A[k]})),Et(D=>{if(!Object.prototype.hasOwnProperty.call(D,_))return D;const B={...D};return delete B[_],B}))},ln=_=>{Nt(k=>({...k,[_]:!k[_]}))},Fn=_=>{_.stopPropagation()},Mi=async()=>{try{const _=await fetch("/api/fields/list");if(!_.ok){jt("Failed to load fields list.");return}const k=await _.json(),D=Array.isArray(k?.files)?k.files:[];j(D),H&&!D.includes(H)&&W(""),D.length>0&&(!V||!V.trim())&&it(D[0])}catch(_){jt(`Failed to load fields list: ${_}`)}};St.useEffect(()=>{Mi(),Li()},[]),St.useEffect(()=>{const _="custom-font-face-rules",k=document.getElementById(_);if(k&&k.remove(),!c.length)return;const D=c.map(tt=>{const kt=pv(tt.name),te=encodeURIComponent(tt.file),It=tt.type==="otf"?"opentype":"truetype";return`@font-face{font-family:"${kt}";src:url("/api/font-file/${te}") format("${It}");font-display:swap;}`}),B=document.createElement("style");return B.id=_,B.textContent=D.join(`
`),document.head.appendChild(B),()=>{const tt=document.getElementById(_);tt&&tt.remove()}},[c]);const Li=async()=>{try{const _=await fetch("/api/list-custom-fonts");if(!_.ok){console.error("Failed to fetch custom fonts");return}const k=await _.json();h(k.custom_fonts||[])}catch(_){console.error("Error fetching custom fonts:",_)}},Kn=async _=>{const k=new FormData;k.append("font_file",_);try{const D=await fetch("/api/upload-font",{method:"POST",body:k});if(!D.ok){const tt=await D.json();return jt(`Failed to upload font: ${tt.detail||"Unknown error"}`),!1}const B=await D.json();return jt(`Font "${B.font_name}" uploaded successfully!`),await Li(),!0}catch(D){return jt(`Error uploading font: ${D.message}`),!1}},Qn=async _=>{if(confirm(`Delete font "${_}"? This cannot be undone.`))try{const k=await fetch(`/api/delete-font/${encodeURIComponent(_)}`,{method:"DELETE"});if(!k.ok){const B=await k.json();return jt(`Failed to delete font: ${B.detail||"Unknown error"}`),!1}const D=await k.json();return jt(D.message),await Li(),!0}catch(k){return jt(`Error deleting font: ${k.message}`),!1}};St.useEffect(()=>{const _=k=>{const D=k.target.closest(".menu-button"),B=k.target.closest(".dropdown-menu");Ci&&!D?.textContent?.includes("Layouts")&&!B&&ki(!1),Ti&&!D?.textContent?.includes("Generate")&&!B&&Pi(!1),Yn&&!D?.textContent?.includes("Fonts")&&!B&&In(!1)};return document.addEventListener("mousedown",_),()=>document.removeEventListener("mousedown",_)},[Ci,Ti,Yn]),St.useEffect(()=>{const _=document.documentElement.classList;t==="dark"?_.add("theme-dark"):_.remove("theme-dark")},[t]);const le=St.useMemo(()=>X?{x:X.pageWidthPt/X.displayWidth,y:X.pageHeightPt/X.displayHeight}:null,[X]),is=()=>!X||!le?null:{page:0,default_font:"Helvetica",default_size:18,fields:q.map(_=>{const k=_.x*le.x,D=(_.x+_.w)*le.x,B=(X.displayHeight-_.y)*le.y,tt=_.w*le.x,kt=Number(_.size),te=B-kt;let It=_.font||"Helvetica";if(_.bold||_.italic){const yt=It.replace(/-Bold|-Italic|-Oblique|-BoldOblique|-BoldItalic/g,"");yt==="Helvetica"?It=_.bold&&_.italic?"Helvetica-BoldOblique":_.bold?"Helvetica-Bold":_.italic?"Helvetica-Oblique":"Helvetica":yt==="Times"||yt==="Times-Roman"?It=_.bold&&_.italic?"Times-BoldItalic":_.bold?"Times-Bold":_.italic?"Times-Italic":"Times-Roman":yt==="Courier"&&(It=_.bold&&_.italic?"Courier-BoldOblique":_.bold?"Courier-Bold":_.italic?"Courier-Oblique":"Courier")}const ct={name:_.name,x:_.align==="center"?(k+D)/2:_.align==="right"?D:k,y:te,font:It,size:kt,align:_.align,color:_.color};return _.maxWidth&&(ct.max_width=tt),ct.wrap_start_y=B,ct.box_width=tt,ct.box_height=_.h*le.y,_.wrapText&&(ct.wrap_text=!0,ct.wrap_width=tt),ct})},Us=_=>{if(Tt&&Yt.current.name===_){const B=Yt.current.text??"",tt=gc(Yt.current.html??Xi(B));return{text:B,html:tt}}const k=xt[_]??"",D=gc(dt[_]??Xi(k));return{text:k,html:D}},Ur=()=>{const _={};return q.forEach(k=>{k.name&&(_[k.name]=Us(k.name))}),_},$s=_=>!X||!le||!_||!Array.isArray(_.fields)?[]:_.fields.map((k,D)=>{const B=k.align??"left",kt=Number(k.box_width??k.max_width??150)/le.x,te=Number(k.size??_.default_size??18),It=Math.max(24,te*1.6/X.pageHeightPt*X.displayHeight*le.y),ct=Number(k.box_height??It),yt=Math.max(8,ct/le.y),Ht=Number(k.x)/le.x,Vt=Number(k.wrap_start_y),Ft=Number(k.y),Kt=Number.isFinite(Vt)?Vt:Number.isFinite(Ft)?Ft+te:X.pageHeightPt;let se=Ht;B==="center"?se=Ht-kt/2:B==="right"&&(se=Ht-kt);const Qt=X.displayHeight-Kt/le.y,be=k.font??_.default_font??"Helvetica";let Je=be,jn=!1,as=!1;be.includes("Bold")&&(jn=!0),(be.includes("Oblique")||be.includes("Italic"))&&(as=!0),be.startsWith("Helvetica")?Je="Helvetica":be.startsWith("Times")?Je="Times-Roman":be.startsWith("Courier")&&(Je="Courier");const De=ns.has(Je)?Je:ns.has(be)?be:"Helvetica";return vc({id:Bd(),name:k.name??`field_${D+1}`,x:se,y:Qt,w:kt,h:yt,align:B,font:De,size:te,color:Array.isArray(k.color)?k.color:[0,0,0],maxWidth:k.max_width!==void 0,wrapText:k.wrap_text!==!1,bold:jn,italic:as},X.displayWidth,X.displayHeight)}),Vs=async _=>{const[k]=_.target.files??[];if(!k)return;const D=await yv(k,Ri);if(Ct(D),l(k),Y([]),Q(null),pt({}),Et({}),jt(`Loaded template: ${D.name}`),k.name.toLowerCase().endsWith(".pdf"))try{const B=new FormData;B.append("template",k);const tt=await fetch("/api/extract-fonts",{method:"POST",body:B});if(tt.ok){const kt=await tt.json();jt(`Loaded template: ${D.name} (${kt.fonts?.length||0} fonts detected)`)}}catch(B){console.error("Failed to extract fonts:",B)}},Zn=_=>{const k=p.current.getBoundingClientRect();return{x:(_.clientX-k.left)/s,y:(_.clientY-k.top)/s}},Ni=_=>{if(!X||Xt)return;_.target.closest(".field-box")||Q(null);const D=Zn(_);z(!0),vt({startX:D.x,startY:D.y,x:D.x,y:D.y,w:1,h:1})},Gs=(_,k)=>{_.preventDefault(),_.stopPropagation();const D=Zn(_),B=q.find(tt=>tt.id===k);B&&(Q(k),fe(!1),xi({mode:"move",fieldId:k,startX:D.x,startY:D.y,initial:B}))},Ue=(_,k,D)=>{_.preventDefault(),_.stopPropagation();const B=Zn(_),tt=q.find(kt=>kt.id===k);tt&&(Q(k),xi({mode:"resize",fieldId:k,startX:B.x,startY:B.y,initial:tt,direction:D}))},ss=()=>document.querySelector(".field-box.active .field-preview"),Dn=(_,k)=>{if(!_||!k||k.rangeCount===0)return!1;const D=k.getRangeAt(0);return _.contains(D.startContainer)&&_.contains(D.endContainer)},Ii=(_,k=null)=>{const D=ss();if(!D||!rt?.name||!D.isContentEditable)return!1;const B=window.getSelection(),tt=!!B&&!B.isCollapsed&&Dn(D,B),kt=!!(Ze.current&&!Ze.current.collapsed);if(!tt&&!kt)return!1;if(!tt&&kt){D.focus();const It=window.getSelection();if(It){It.removeAllRanges();try{It.addRange(Ze.current)}catch{return!1}}}const te=window.getSelection();return!te||te.isCollapsed||!Dn(D,te)?!1:(document.execCommand(_,!1,k),Yt.current={name:rt.name,html:D.innerHTML,text:D.innerText},!0)},On=_=>{if(rt&&(ce(rt.id,_),Et(k=>{if(!Object.prototype.hasOwnProperty.call(k,rt.name))return k;const D={...k};return delete D[rt.name],D}),Yt.current.name===rt.name)){const k=Yt.current.text??"";Yt.current={name:rt.name,text:k,html:Xi(k)};const D=ss();D&&D.isContentEditable&&(D.innerHTML=Yt.current.html)}},rs=(_,k)=>{if(!rt)return;const D=ss();if(!!D&&(Tt||D.isContentEditable)){Ii(_)||On({[k]:!rt[k]});return}On({[k]:!rt[k]})},$r=({command:_,value:k=null,fieldPatch:D,requireSelection:B=!1,selectionMessage:tt=null})=>{if(!rt)return;const kt=ss();if(!!kt&&(Tt||kt.isContentEditable)){const It=window.getSelection(),ct=!!It&&!It.isCollapsed&&Dn(kt,It),yt=!!(Ze.current&&!Ze.current.collapsed);if((ct||yt||!B)&&Ii(_,k))return;On(D);return}On(D)},_o=_=>{if(!X)return;if(Xt){const te=Zn(_),It=te.x-Xt.startX,ct=te.y-Xt.startY;if(Xt.mode==="move"){const yt=Xt.initial.x+It,Ht=Xt.initial.y+ct;ce(Xt.fieldId,{x:yt,y:Ht});const Vt=[],Ft=5,Kt=q.find(se=>se.id===Xt.fieldId);if(Kt){const se=yt+Kt.w/2,Qt=Ht+Kt.h/2,be=yt,Je=yt+Kt.w,jn=Ht,as=Ht+Kt.h;q.forEach(De=>{if(De.id===Xt.fieldId)return;const os=De.x+De.w/2,Ws=De.y+De.h/2,ls=De.x,Jn=De.x+De.w,Qr=De.y,cs=De.y+De.h;Math.abs(be-ls)<Ft&&Vt.push({type:"vertical",x:ls}),Math.abs(Je-Jn)<Ft&&Vt.push({type:"vertical",x:Jn}),Math.abs(se-os)<Ft&&Vt.push({type:"vertical",x:os}),Math.abs(jn-Qr)<Ft&&Vt.push({type:"horizontal",y:Qr}),Math.abs(as-cs)<Ft&&Vt.push({type:"horizontal",y:cs}),Math.abs(Qt-Ws)<Ft&&Vt.push({type:"horizontal",y:Ws})})}Hs(Vt)}else if(Xt.mode==="resize"){const yt=Xt.direction,Ht={...Xt.initial};yt.includes("e")?Ht.w=Xt.initial.w+It:yt.includes("w")&&(Ht.x=Xt.initial.x+It,Ht.w=Xt.initial.w-It),yt.includes("s")?Ht.h=Xt.initial.h+ct:yt.includes("n")&&(Ht.y=Xt.initial.y+ct,Ht.h=Xt.initial.h-ct),Ht.w<0&&(Ht.x+=Ht.w,Ht.w=Math.abs(Ht.w)),Ht.h<0&&(Ht.y+=Ht.h,Ht.h=Math.abs(Ht.h)),ce(Xt.fieldId,Ht)}return}if(!M||!J)return;const k=Zn(_),D=Math.min(J.startX,k.x),B=Math.min(J.startY,k.y),tt=Math.abs(k.x-J.startX),kt=Math.abs(k.y-J.startY);vt({...J,x:D,y:B,w:tt,h:kt})},Vr=()=>{if(Xt){xi(null),Hs([]);return}if(!X||!J){z(!1);return}if(z(!1),J.w<8||J.h<8){vt(null);return}const _={id:Bd(),name:Ud(`field_${q.length+1}`,q),x:J.x,y:J.y,w:J.w,h:J.h,align:"left",font:"Helvetica",size:18,color:[0,0,0],maxWidth:!1,wrapText:!0,bold:!1,italic:!1};Y(k=>[...k,vc(_,X.displayWidth,X.displayHeight)]),Q(_.id),vt(null)},ce=(_,k)=>{if(X){if(k.name!==void 0){const D=q.find(B=>B.id===_);D&&(k={...k,name:Ud(k.name,q,_)}),D&&D.name!==k.name&&S[D.name]&&T(B=>{const tt={...B};return tt[k.name]=tt[D.name],delete tt[D.name],tt}),D&&D.name!==k.name&&(pt(B=>{if(!Object.prototype.hasOwnProperty.call(B,D.name))return B;const tt={...B};return Object.prototype.hasOwnProperty.call(tt,k.name)||(tt[k.name]=tt[D.name]),delete tt[D.name],tt}),Et(B=>{if(!Object.prototype.hasOwnProperty.call(B,D.name))return B;const tt={...B};return Object.prototype.hasOwnProperty.call(tt,k.name)||(tt[k.name]=tt[D.name]),delete tt[D.name],tt}))}Y(D=>D.map(B=>B.id!==_?B:vc({...B,...k},X.displayWidth,X.displayHeight)))}},Gr=_=>{const k=q.find(D=>D.id===_);Y(D=>D.filter(B=>B.id!==_)),nt===_&&Q(null),k&&S[k.name]&&T(D=>{const B={...D};return delete B[k.name],B})},Wr=()=>{const _=is();if(!_)return;const k=new Blob([JSON.stringify(_,null,2)],{type:"application/json"}),D=URL.createObjectURL(k),B=document.createElement("a");B.href=D,B.download="fields.json",B.click(),URL.revokeObjectURL(D)},So=async()=>{const _=is();if(!_){jt("Load a template and create fields first.");return}const k=V?.trim()||"fields.json";if(!(await fetch(`/api/fields?name=${encodeURIComponent(k)}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(_)})).ok){jt(`Failed to save ${k} to backend.`);return}jt(`Saved ${k} on backend.`),Mi()},Xr=async()=>{if(!X){jt("Load template first so coordinates can be mapped to canvas.");return}const _=H?.trim()||"fields.json";if(!H?.trim()){jt("Select a backend fields file first.");return}const k=await fetch(`/api/fields?name=${encodeURIComponent(_)}`);if(!k.ok){jt(`Failed to load backend ${_}.`);return}const D=await k.json(),B=$s(D);Y(B),Q(B[0]?.id??null),jt(`Loaded ${_} from backend.`)},qr=async _=>{if(!X){jt("Load template first so coordinates can be mapped to canvas.");return}const[k]=_.target.files??[];if(k)try{const D=await k.text(),B=JSON.parse(D),tt=$s(B);Y(tt),Q(tt[0]?.id??null),jt(`Loaded ${k.name} from disk.`)}catch(D){jt(`Failed to load fields file: ${D}`)}},Yr=_=>{let k=_.name;if(!k){const tt=window.prompt("Enter a field name:","");if(!tt||(k=tt.trim(),!k))return;ce(_.id,{name:k})}const D=xt[k]??"",B=window.prompt(`Enter value for ${k}:`,D);B!==null&&(pt(tt=>({...tt,[k]:B})),Et(tt=>{if(!Object.prototype.hasOwnProperty.call(tt,k))return tt;const kt={...tt};return delete kt[k],kt}))},Kr=async()=>{if(!o){jt("Upload a template first.");return}const _=is();if(!_){jt("Create fields before generating a PDF.");return}if(C&&!f){jt("Upload a CSV file or turn off CSV mode.");return}const k={...Ce,row:Number(Ce.row)||0,dx:Number(Ce.dx)||0,dy:Number(Ce.dy)||0,grid_step:Number(Ce.grid_step)||0,overlay_only:Ce.output_mode==="overlay_only"},D=new FormData;if(D.append("template",o),D.append("fields_json",JSON.stringify(_)),D.append("row",String(k.row)),D.append("page_size",k.page_size),D.append("dx",String(k.dx)),D.append("dy",String(k.dy)),D.append("grid_step",String(k.grid_step)),D.append("placeholder_mode",String(!1)),D.append("overlay_only",String(k.overlay_only)),C){D.append("csv_file",f);const Ft={};Object.entries(S).forEach(([se,Qt])=>{Qt&&(Ft[se]=Qt)}),D.append("field_mappings_json",JSON.stringify(Ft));const Kt={};q.forEach(se=>{if(!S[se.name]){const{text:Qt,html:be}=Us(se.name);Qt&&(Kt[se.name]={text:Qt,html:be})}}),D.append("fixed_values_json",JSON.stringify(Kt)),D.append("batch",String(Ce.generate_all))}else D.append("data_json",JSON.stringify(Ur()));let B;try{B=await fetch("/api/generate-file-upload",{method:"POST",body:D})}catch(Ft){jt(`Failed to reach server: ${Ft}`);return}if(!B.ok){let Ft="";const Kt=B.headers.get("content-type")||"";try{if(Kt.includes("application/json")){const Qt=await B.json();Ft=mv(Qt?.detail??Qt)}else Ft=await B.text()}catch{Ft=`HTTP ${B.status}`}const se=Ft?` ${Ft}`:"";jt(`Failed to generate PDF. HTTP ${B.status}.${se}`);return}const tt=B.clone(),kt=B.headers.get("content-type")||"n/a",te=B.headers.get("content-disposition")||"",It=await B.arrayBuffer();if(!It||It.byteLength===0){let Ft="";try{Ft=await tt.text()}catch{Ft=""}const Kt=B.headers.get("content-length")||"n/a",se=Ft?` ${Ft}`:"";jt(`Generated file is empty. HTTP ${B.status} content-length=${Kt} content-type=${kt}.${se}`);return}const ct=kt.includes("application/zip")||kt.includes("application/x-zip-compressed")||/\.zip/i.test(te);if(C&&Ce.generate_all&&ct){const Ft=new Blob([It],{type:"application/zip"}),Kt=URL.createObjectURL(Ft),se=vv(te,"certificates.zip");Ee?.url&&URL.revokeObjectURL(Ee.url),es({url:Kt,filename:se,kind:"zip"});const Qt=document.createElement("a");Qt.href=Kt,Qt.download=se,document.body.appendChild(Qt),Qt.click(),Qt.remove(),jt("Downloaded ZIP file containing all certificates.");return}if(!kt.includes("application/pdf")){let Ft="";try{Ft=await tt.text()}catch{Ft=""}const Kt=Ft?` ${Ft}`:"";jt(`Unexpected response type: ${kt}. ${Kt}`);return}const yt=new Blob([It],{type:"application/pdf"}),Ht=URL.createObjectURL(yt);Ee?.url&&URL.revokeObjectURL(Ee.url),es({url:Ht,filename:"certificate.pdf",kind:"pdf"}),Cn&&URL.revokeObjectURL(Cn);const Vt=URL.createObjectURL(yt);Ei(Vt),Nt(Ft=>({...Ft,preview:!0})),jt("Generated PDF preview. Use Download PDF to save it.")},xo=()=>{if(!Ee?.url){jt("Generate a file first, then download.");return}const _=document.createElement("a");_.href=Ee.url,_.download=Ee.filename,document.body.appendChild(_),_.click(),_.remove(),jt(Ee.kind==="zip"?"Downloaded ZIP file containing all certificates.":"Downloaded the latest generated certificate.")};return E.jsxs("div",{className:"app-shell",children:[E.jsxs("header",{className:"topbar",children:[E.jsxs("div",{className:"topbar-main",children:[E.jsxs("div",{className:"brand",children:[E.jsx("span",{className:"brand-mark",children:"CS"}),E.jsx("div",{className:"brand-text",children:E.jsx("h1",{children:"CertStudio"})}),E.jsx("span",{className:"brand-divider"}),E.jsx("button",{type:"button",className:"menu-button",onClick:()=>{ki(!Ci),Pi(!1),In(!1)},children:"Layouts"}),E.jsx("button",{type:"button",className:"menu-button",onClick:()=>{Pi(!Ti),ki(!1),In(!1)},children:"Generate"}),E.jsx("button",{type:"button",className:"menu-button",onClick:()=>{In(!Yn),ki(!1),Pi(!1)},children:"Fonts"}),Ti&&E.jsx("div",{className:"dropdown-menu",children:E.jsxs("div",{className:"dropdown-content",children:[E.jsxs("label",{children:[E.jsx("span",{className:"label-title",children:"Output mode"}),E.jsxs("select",{value:Ce.output_mode,onChange:_=>on(k=>({...k,output_mode:_.target.value})),children:[E.jsx("option",{value:"full_pdf",children:"Full PDF (with template)"}),E.jsx("option",{value:"overlay_only",children:"Overlay only (for pre-printed sheets)"})]})]}),E.jsxs("label",{children:[E.jsx("span",{className:"label-title",children:"Page size"}),E.jsxs("select",{value:Ce.page_size,onChange:_=>on(k=>({...k,page_size:_.target.value})),children:[E.jsx("option",{value:"letter",children:"letter"}),E.jsx("option",{value:"a4",children:"a4"}),E.jsx("option",{value:"legal",children:"legal"})]})]}),E.jsxs("div",{className:"grid-two",children:[E.jsxs("label",{children:[E.jsx("span",{className:"label-title",children:"Global X offset (pt)"}),E.jsx("input",{type:"number",value:Ce.dx,onChange:_=>on(k=>({...k,dx:Number(_.target.value)}))})]}),E.jsxs("label",{children:[E.jsx("span",{className:"label-title",children:"Global Y offset (pt)"}),E.jsx("input",{type:"number",value:Ce.dy,onChange:_=>on(k=>({...k,dy:Number(_.target.value)}))})]})]}),E.jsxs("label",{children:[E.jsx("span",{className:"label-title",children:"Grid step (pt, 0 to hide)"}),E.jsx("input",{type:"number",value:Ce.grid_step,onChange:_=>on(k=>({...k,grid_step:Number(_.target.value)}))})]}),C&&f&&E.jsxs("label",{className:"check-row",children:[E.jsx("input",{type:"checkbox",checked:Ce.generate_all,onChange:_=>on(k=>({...k,generate_all:_.target.checked}))}),E.jsx("span",{children:"Generate for all candidates in CSV"})]}),E.jsxs("div",{className:"button-row",children:[E.jsx("button",{type:"button",onClick:Kr,className:"primary-button",children:"Generate PDF"}),E.jsx("button",{type:"button",onClick:xo,disabled:!Ee?.url,children:Ee?.kind==="zip"?"Download ZIP":"Download PDF"})]})]})}),Ci&&E.jsx("div",{className:"dropdown-menu",children:E.jsxs("div",{className:"dropdown-content",children:[E.jsxs("label",{children:[E.jsx("span",{className:"label-title",children:"Saved layouts"}),E.jsxs("select",{value:H,onChange:_=>W(_.target.value),children:[E.jsx("option",{value:"",children:"Select layout..."}),O.map(_=>E.jsx("option",{value:_,children:_},_))]})]}),E.jsxs("div",{className:"button-row",children:[E.jsx("button",{type:"button",onClick:Xr,disabled:!H,className:"secondary-button",children:"Load"}),E.jsx("button",{type:"button",onClick:So,disabled:!X||q.length===0,className:"secondary-button",children:"Save"}),E.jsx("button",{type:"button",className:"ghost-button",onClick:()=>Mi(),children:"Refresh"})]}),E.jsx("div",{className:"section-divider"}),E.jsxs("label",{children:[E.jsx("span",{className:"label-title",children:"Import from file"}),E.jsx("input",{type:"file",accept:".json",onChange:qr})]}),E.jsxs("label",{children:[E.jsx("span",{className:"label-title",children:"Export name"}),E.jsx("input",{value:V,onChange:_=>it(_.target.value),placeholder:"fields.json"})]}),E.jsx("button",{type:"button",onClick:Wr,disabled:!X||q.length===0,className:"secondary-button",children:"Export to file"})]})}),Yn&&E.jsx("div",{className:"dropdown-menu",children:E.jsxs("div",{className:"dropdown-content",children:[E.jsxs("label",{children:[E.jsx("span",{className:"label-title",children:"Upload font file (.ttf or .otf)"}),E.jsx("input",{type:"file",accept:".ttf,.otf",onChange:async _=>{const k=_.target.files?.[0];k&&(await Kn(k),_.target.value="")}})]}),c.length>0?E.jsxs("div",{children:[E.jsxs("div",{className:"label-title",style:{marginTop:"12px",marginBottom:"8px"},children:["Installed fonts (",c.length,")"]}),E.jsx("div",{style:{display:"grid",gap:"6px",maxHeight:"300px",overflowY:"auto"},children:c.map(_=>E.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"6px 8px",background:"var(--panel-soft)",border:"1px solid var(--line)",borderRadius:"var(--radius)",fontSize:"0.75rem"},children:[E.jsxs("div",{style:{flex:1,minWidth:0},children:[E.jsx("div",{style:{fontWeight:500,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:_.name}),E.jsxs("div",{style:{fontSize:"0.688rem",color:"var(--ink-muted)",marginTop:"2px"},children:[_.file,"  ",_.size_kb," KB"]})]}),E.jsx("button",{type:"button",onClick:()=>Qn(_.file),style:{marginLeft:"8px",padding:"4px 8px",fontSize:"0.688rem",background:"var(--danger)",color:"white",border:"none",borderRadius:"var(--radius)",cursor:"pointer"},children:"Delete"})]},_.file))})]}):E.jsx("p",{className:"hint",style:{marginTop:"12px"},children:"No custom fonts uploaded yet. Upload .ttf or .otf files to use them in your certificates."}),E.jsxs("div",{style:{marginTop:"12px",padding:"8px",background:"var(--panel-soft)",border:"1px solid var(--line)",borderRadius:"var(--radius)",fontSize:"0.688rem",color:"var(--ink-soft)"},children:[E.jsx("strong",{children:"Tip:"})," Download free fonts from"," ",E.jsx("a",{href:"https://fonts.google.com/",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--accent)"},children:"Google Fonts"})]})]})})]}),E.jsxs("div",{className:"topbar-right",children:[E.jsxs("div",{className:"theme-toggle","aria-label":"Theme",children:[E.jsx("button",{type:"button",className:`theme-pill ${t==="light"?"active":""}`,onClick:()=>e("light"),children:"Light"}),E.jsx("button",{type:"button",className:`theme-pill ${t==="dark"?"active":""}`,onClick:()=>e("dark"),children:"Dark"})]}),E.jsxs("div",{className:"topbar-meta",children:[E.jsx("span",{className:"meta-label",children:"Template"}),E.jsx("span",{className:"meta-value",children:X?.name??"No file loaded"})]})]})]}),E.jsxs("div",{className:"topbar-secondary",children:[E.jsxs("div",{className:"topbar-left-controls",children:[E.jsx("div",{className:"topbar-group compact",children:E.jsxs("label",{children:[E.jsx("span",{className:"label-title",children:"Template file"}),E.jsx("span",{className:"label-hint",children:"PDF, JPG, or PNG"}),E.jsx("input",{type:"file",accept:".pdf,.png,.jpg,.jpeg",onChange:Vs})]})}),E.jsxs("div",{className:"topbar-group compact",children:[E.jsxs("label",{children:[E.jsx("span",{className:"label-title",children:"Page size for images"}),E.jsx("select",{value:Mt,onChange:_=>Lt(_.target.value),children:Object.entries(pc).map(([_,k])=>E.jsx("option",{value:_,children:k.label},_))})]}),Mt==="custom"&&E.jsxs("div",{className:"custom-size",children:[E.jsxs("label",{children:["Width (pt)",E.jsx("input",{type:"number",value:Ut.width,onChange:_=>Z(k=>({...k,width:Number(_.target.value)}))})]}),E.jsxs("label",{children:["Height (pt)",E.jsx("input",{type:"number",value:Ut.height,onChange:_=>Z(k=>({...k,height:Number(_.target.value)}))})]})]})]}),E.jsx("div",{className:"topbar-group compact",children:E.jsxs("label",{className:"slider-label",children:[E.jsx("span",{className:"label-title",children:"Zoom"}),E.jsxs("div",{className:"slider-row",children:[E.jsx("input",{type:"range",min:"0.25",max:"2",step:"0.05",value:s,onChange:_=>r(Number(_.target.value))}),E.jsxs("span",{className:"slider-value",children:[Math.round(s*100),"%"]})]})]})})]}),E.jsxs("div",{className:`topbar-editing-controls ${rt?"":"disabled"}`,children:[E.jsxs("div",{className:"text-control-item medium",children:[E.jsx("span",{className:"label-title",children:"Field name"}),E.jsx("input",{value:rt?.name||"",onChange:_=>rt&&ce(rt.id,{name:_.target.value}),placeholder:"Select field"})]}),E.jsx("span",{className:"control-divider"}),E.jsxs("div",{className:"text-control-item wide",children:[E.jsx("span",{className:"label-title",children:"Font family"}),E.jsxs("select",{value:ns.has(rt?.font)?rt.font:"Helvetica",onChange:_=>$r({command:"fontName",value:_.target.value,fieldPatch:{font:_.target.value},requireSelection:!0,selectionMessage:"Select text in the field to apply font family."}),children:[E.jsx("optgroup",{label:"ReportLab Built-in Fonts",children:mc.map(_=>E.jsx("option",{value:_.value,children:_.label},_.value))}),c.length>0&&E.jsx("optgroup",{label:"Uploaded Custom Fonts",children:c.filter(_=>!mc.some(k=>k.value===_.name)).map(_=>E.jsx("option",{value:_.name,children:_.name},_.name))})]})]}),E.jsxs("div",{className:"text-control-item small",children:[E.jsx("span",{className:"label-title",children:"Size (pt)"}),E.jsx("input",{type:"number",value:rt?.size??"",onChange:_=>rt&&ce(rt.id,{size:Number(_.target.value)}),placeholder:"12"})]}),E.jsxs("div",{className:"text-control-item mini",children:[E.jsx("span",{className:"label-title",children:"Color"}),E.jsx("input",{type:"color",value:rt?uv(rt.color):"#000000",onChange:_=>$r({command:"foreColor",value:_.target.value,fieldPatch:{color:hv(_.target.value)},requireSelection:!0,selectionMessage:"Select text in the field to apply color."}),style:{width:"100%",padding:"2px"}})]}),E.jsx("span",{className:"control-divider"}),E.jsxs("div",{className:"icon-buttons-group",children:[E.jsx("button",{type:"button",className:`icon-button ${rt?.bold?"active":""}`,onMouseDown:_=>{document.querySelector('.field-box.active .field-preview[contenteditable="true"]')&&_.preventDefault()},onClick:()=>rs("bold","bold"),title:Tt?"Bold (select text first)":"Bold",children:"B"}),E.jsx("button",{type:"button",className:`icon-button ${rt?.italic?"active":""}`,onMouseDown:_=>{document.querySelector('.field-box.active .field-preview[contenteditable="true"]')&&_.preventDefault()},onClick:()=>rs("italic","italic"),title:Tt?"Italic (select text first)":"Italic",style:{fontStyle:"italic"},children:"I"})]}),E.jsx("span",{className:"control-divider"}),E.jsxs("div",{className:"text-control-item small",children:[E.jsx("span",{className:"label-title",children:"Align"}),E.jsxs("select",{value:rt?.align||"left",onChange:_=>rt&&ce(rt.id,{align:_.target.value}),children:[E.jsx("option",{value:"left",children:"Left"}),E.jsx("option",{value:"center",children:"Center"}),E.jsx("option",{value:"right",children:"Right"})]})]}),E.jsxs("div",{className:"text-control-item",style:{marginLeft:"4px"},children:[E.jsx("span",{className:"label-title",children:"Fit to box"}),E.jsx("label",{className:"check-row",style:{margin:0},children:E.jsx("input",{type:"checkbox",checked:rt?.maxWidth||!1,onChange:_=>rt&&ce(rt.id,{maxWidth:_.target.checked})})})]}),E.jsxs("div",{className:"text-control-item",style:{marginLeft:"4px"},children:[E.jsx("span",{className:"label-title",children:"Wrap text"}),E.jsx("label",{className:"check-row",style:{margin:0},children:E.jsx("input",{type:"checkbox",checked:rt?.wrapText||!1,onChange:_=>rt&&ce(rt.id,{wrapText:_.target.checked})})})]})]})]})]}),ts&&E.jsx("div",{className:"status-bar",children:ts}),E.jsxs("main",{className:"workspace",children:[E.jsx("section",{className:"sidebar sidebar-left",children:E.jsxs("div",{className:`panel ${ft.fields?"":"collapsed"}`,children:[E.jsxs("div",{className:"panel-header",onClick:()=>ln("fields"),children:[E.jsx("h2",{children:"Fields"}),E.jsx("div",{className:"panel-actions",children:E.jsx("button",{type:"button",className:"panel-toggle","data-state":ft.fields?"open":"closed","aria-label":"Toggle fields list",onClick:_=>{Fn(_),ln("fields")}})})]}),E.jsx("div",{className:"panel-body",children:E.jsxs("div",{className:"field-list",children:[q.map(_=>E.jsxs("button",{type:"button",className:`field-row ${nt===_.id?"selected":""}`,onClick:()=>Q(_.id),children:[E.jsx("span",{className:"field-row-name",children:_.name}),E.jsx("span",{className:"field-row-meta",children:_.align})]},_.id)),q.length===0&&E.jsx("p",{className:"hint",children:"Drag on the template to create your first field."})]})})]})}),E.jsxs("section",{className:"canvas-panel",children:[!X&&E.jsxs("div",{className:"empty-state",children:[E.jsx("h2",{children:"Start by loading a template"}),E.jsx("p",{children:"Pick a certificate PDF or image above, then drag boxes on this canvas to define each field."})]}),X&&E.jsxs("div",{className:"template-layer",ref:p,style:{width:X.displayWidth,height:X.displayHeight,transform:`scale(${s})`,transformOrigin:"top left"},onMouseDown:Ni,onMouseMove:_o,onMouseUp:Vr,onMouseLeave:Vr,children:[E.jsx("img",{src:X.src,alt:"Template",draggable:!1,className:"template-image"}),q.map(_=>{const k=xt[_.name]??`{${_.name}}`,D=dt[_.name],B=Xi(k),tt=D??B,kt=Number(_.size)/X.pageHeightPt*X.displayHeight,te=_.maxWidth?gv(k,_.w,kt):kt,It=nt===_.id;return E.jsxs("div",{className:`field-box ${It?"active":""}`,style:{left:_.x,top:_.y,width:_.w,height:_.h},onMouseDown:ct=>{const yt=ct.target;if(!(yt instanceof HTMLElement)||!!yt.closest(".resize-handle"))return;const Vt=yt.closest(".field-preview");if(Vt){ct.stopPropagation(),Q(_.id),Tt&&Yt.current.name===_.name||(Yt.current={name:_.name,html:tt,text:k},Ze.current=null),fe(!0),setTimeout(()=>{Vt instanceof HTMLElement&&Vt.focus()},0);return}Gs(ct,_.id)},onClick:ct=>{ct.stopPropagation();const yt=ct.target;yt instanceof HTMLElement&&!yt.closest(".field-preview")&&!yt.closest(".resize-handle")&&(Q(_.id),fe(!1))},onDoubleClick:ct=>{const yt=ct.target;yt instanceof HTMLElement&&!yt.closest(".field-preview")&&!yt.closest(".resize-handle")&&Yr(_)},children:[E.jsx("div",{className:`field-preview align-${_.align}`,contentEditable:It&&Tt,suppressContentEditableWarning:!0,spellCheck:!1,style:{fontSize:te,fontFamily:_.font,color:dv(_.color),fontWeight:_.bold?"bold":"normal",fontStyle:_.italic?"italic":"normal",whiteSpace:_.wrapText?"pre-wrap":"pre",overflowWrap:_.wrapText?"break-word":"normal",wordWrap:_.wrapText?"break-word":"normal"},onInput:ct=>{It&&Tt&&(Yt.current={name:_.name,html:ct.currentTarget.innerHTML,text:ct.currentTarget.innerText})},onMouseDown:ct=>{It&&Tt&&ct.stopPropagation()},onBlur:ct=>{const yt=ct.relatedTarget;if(!(yt instanceof HTMLElement&&yt.closest(".topbar-editing-controls"))){if(Yt.current.name===_.name){const Vt=Yt.current.text??"",Ft=gc(Yt.current.html??Xi(Vt));pt(Kt=>({...Kt,[_.name]:Vt})),Et(Kt=>({...Kt,[_.name]:Ft}))}Ze.current=null,fe(!1)}},dangerouslySetInnerHTML:{__html:It&&Tt&&Yt.current.name===_.name?Yt.current.html:tt},children:null}),E.jsx("span",{className:"resize-handle resize-handle-nw",onMouseDown:ct=>Ue(ct,_.id,"nw")}),E.jsx("span",{className:"resize-handle resize-handle-n",onMouseDown:ct=>Ue(ct,_.id,"n")}),E.jsx("span",{className:"resize-handle resize-handle-ne",onMouseDown:ct=>Ue(ct,_.id,"ne")}),E.jsx("span",{className:"resize-handle resize-handle-e",onMouseDown:ct=>Ue(ct,_.id,"e")}),E.jsx("span",{className:"resize-handle resize-handle-se",onMouseDown:ct=>Ue(ct,_.id,"se")}),E.jsx("span",{className:"resize-handle resize-handle-s",onMouseDown:ct=>Ue(ct,_.id,"s")}),E.jsx("span",{className:"resize-handle resize-handle-sw",onMouseDown:ct=>Ue(ct,_.id,"sw")}),E.jsx("span",{className:"resize-handle resize-handle-w",onMouseDown:ct=>Ue(ct,_.id,"w")})]},_.id)}),J&&E.jsx("div",{className:"draft-box",style:{left:J.x,top:J.y,width:J.w,height:J.h}}),Hr.map((_,k)=>_.type==="vertical"?E.jsx("div",{className:"alignment-guide-vertical",style:{position:"absolute",left:_.x,top:0,width:1,height:"100%",backgroundColor:"#00ff00",pointerEvents:"none",zIndex:1e3}},`guide-v-${k}`):E.jsx("div",{className:"alignment-guide-horizontal",style:{position:"absolute",left:0,top:_.y,width:"100%",height:1,backgroundColor:"#00ff00",pointerEvents:"none",zIndex:1e3}},`guide-h-${k}`))]})]}),E.jsxs("aside",{className:"sidebar sidebar-right",children:[E.jsxs("div",{className:`panel ${ft.dataSource?"":"collapsed"}`,children:[E.jsxs("div",{className:"panel-header",onClick:()=>ln("dataSource"),children:[E.jsx("h2",{children:"Data source"}),E.jsx("div",{className:"panel-actions",children:E.jsx("button",{type:"button",className:"panel-toggle","data-state":ft.dataSource?"open":"closed","aria-label":"Toggle data source",onClick:_=>{Fn(_),ln("dataSource")}})})]}),E.jsxs("div",{className:"panel-body",children:[E.jsxs("label",{className:"check-row",children:[E.jsx("input",{type:"checkbox",checked:C,onChange:_=>I(_.target.checked)}),E.jsx("span",{children:"Use CSV data"})]}),C&&E.jsxs(E.Fragment,{children:[E.jsxs("label",{children:[E.jsx("span",{className:"label-title",children:"Upload CSV file"}),E.jsx("input",{type:"file",accept:".csv",onChange:bo})]}),f&&v.length>0&&E.jsxs("div",{className:"csv-headers-section",children:[E.jsx("span",{className:"label-title",children:"CSV Headers Found:"}),E.jsx("div",{className:"csv-headers-list",children:v.map((_,k)=>E.jsx("span",{className:"csv-header-chip",children:_},k))}),E.jsx("div",{className:"section-divider"}),E.jsx("span",{className:"label-title",children:"Field Mappings"}),q.length>0?E.jsx("div",{className:"field-mappings",children:q.map(_=>E.jsxs("label",{className:"mapping-row",children:[E.jsx("span",{className:"mapping-field-name",children:_.name}),E.jsxs("select",{value:S[_.name]||"",onChange:k=>Bs(_.name,k.target.value),children:[E.jsx("option",{value:"",children:"-- Use preview value --"}),v.map(k=>E.jsx("option",{value:k,children:k},k))]})]},_.id))}):E.jsx("p",{className:"hint",children:"Create fields first to set up mappings"})]}),f&&v.length===0&&E.jsx("p",{className:"hint",children:"No headers found in CSV file"})]}),!C&&E.jsx("p",{className:"hint",children:"Enable to generate PDFs from CSV rows"})]})]}),rt&&X&&le&&E.jsxs("div",{className:`panel ${ft.selectedField?"":"collapsed"}`,children:[E.jsxs("div",{className:"panel-header",onClick:()=>ln("selectedField"),children:[E.jsx("h2",{children:"Selected field"}),E.jsx("div",{className:"panel-actions",children:E.jsx("button",{type:"button",className:"panel-toggle","data-state":ft.selectedField?"open":"closed","aria-label":"Toggle selected field",onClick:_=>{Fn(_),ln("selectedField")}})})]}),E.jsxs("div",{className:"panel-body editor",children:[E.jsxs("label",{children:[E.jsx("span",{className:"label-title",children:"Preview value"}),E.jsx("textarea",{value:xt[rt.name]??"",onChange:_=>{const k=_.target.value;pt(D=>({...D,[rt.name]:k})),Et(D=>{if(!Object.prototype.hasOwnProperty.call(D,rt.name))return D;const B={...D};return delete B[rt.name],B}),Yt.current.name===rt.name&&(Yt.current={name:rt.name,text:k,html:Xi(k)})},rows:3,placeholder:"Enter preview text (press Enter for new line)"})]}),E.jsxs("div",{className:"grid-two",children:[E.jsxs("label",{children:[E.jsx("span",{className:"label-title",children:"X (px)"}),E.jsx("input",{type:"number",value:Math.round(rt.x),onChange:_=>ce(rt.id,{x:Number(_.target.value)})})]}),E.jsxs("label",{children:[E.jsx("span",{className:"label-title",children:"Y (px)"}),E.jsx("input",{type:"number",value:Math.round(rt.y),onChange:_=>ce(rt.id,{y:Number(_.target.value)})})]}),E.jsxs("label",{children:[E.jsx("span",{className:"label-title",children:"W (px)"}),E.jsx("input",{type:"number",value:Math.round(rt.w),onChange:_=>ce(rt.id,{w:Number(_.target.value)})})]}),E.jsxs("label",{children:[E.jsx("span",{className:"label-title",children:"H (px)"}),E.jsx("input",{type:"number",value:Math.round(rt.h),onChange:_=>ce(rt.id,{h:Number(_.target.value)})})]})]}),E.jsxs("div",{className:"metrics",children:[E.jsxs("div",{children:["Anchor X (pt):"," ",E.jsx("strong",{children:(rt.align==="left"?rt.x*le.x:rt.align==="center"?(rt.x+rt.w/2)*le.x:(rt.x+rt.w)*le.x).toFixed(2)})]}),E.jsxs("div",{children:["Anchor Y (pt):"," ",E.jsx("strong",{children:((X.displayHeight-rt.y)*le.y-Number(rt.size)).toFixed(2)})]}),E.jsxs("div",{children:["max_width (pt): ",E.jsx("strong",{children:(rt.w*le.x).toFixed(2)})]})]}),E.jsx("button",{type:"button",className:"danger",onClick:()=>Gr(rt.id),children:"Delete field"})]})]}),Cn&&E.jsxs("div",{className:`panel ${ft.preview?"":"collapsed"}`,children:[E.jsxs("div",{className:"panel-header",onClick:()=>ln("preview"),children:[E.jsx("h2",{children:"Latest preview"}),E.jsxs("div",{className:"panel-actions",children:[E.jsx("button",{type:"button",className:"ghost-button",onClick:_=>{Fn(_),Cn&&window.open(Cn,"_blank","noopener,noreferrer")},children:"Open in tab"}),E.jsx("button",{type:"button",className:"panel-toggle","data-state":ft.preview?"open":"closed","aria-label":"Toggle preview",onClick:_=>{Fn(_),ln("preview")}})]})]}),E.jsx("div",{className:"panel-body preview-body",children:E.jsx("iframe",{title:"Certificate preview",src:Cn,className:"preview-frame"})})]})]})]})]})}og.createRoot(document.getElementById("root")).render(E.jsx(tg.StrictMode,{children:E.jsx(wv,{})}));
